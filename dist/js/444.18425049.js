(self["webpackChunkagent"]=self["webpackChunkagent"]||[]).push([[444],{6444:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return v}});var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._v(" Solid Soukai person : "+t._s(t.person)+" "),n("hr"),t._v(" persons : "+t._s(t.persons)+" "),n("hr")])},i=[];function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n(2262),n(4506);var a=n(3161),s=n.n(a),u=n(7696),l=n(3754),c=n(1519);class f extends a.SolidModel{}o(f,"rdfContexts",{foaf:"http://xmlns.com/foaf/0.1/",vcard:"http://www.w3.org/2006/vcard/ns#"}),o(f,"rdfsClasses",["foaf:Person"]),o(f,"fields",{name:{type:u.FieldType.String,rdfProperty:"foaf:name"}});var h=n(476);class d extends a.SolidModel{}o(d,"rdfsClasses",["http://xmlns.com/foaf/0.1/Person"]),o(d,"fields",{name:{type:u.FieldType.String,rdfProperty:"http://xmlns.com/foaf/0.1/name"}}),s().loadSolidModels(),u.Soukai.loadModels({Person:d,UserSolid:f}),u.Soukai.useEngine(new a.SolidEngine(l.fetch.bind(window)));var p={name:"SoukaiSolidTest",data(){return{person:null,persons:null}},mounted(){this.test1()},methods:{async test1(){if(null!=this.pod){let t="https://pod.inrupt.com/andriesvh/profile/card#me";h.log(t);const e=await f.from(t).all();let n=await e.map((t=>t.getAttributes()));h.log(n),h.log("user pod",n);const r="https://spoggy-test2.solidcommunity.net/public/soukai-test/";let i=await d.from(r).all();this.persons=await i.map((t=>t.getAttributes()));let o={name:"John Doe",url:r+(0,c.Z)()+"#it"},a=await d.at("https://spoggy-test2.solidcommunity.net/public/soukai-test/").create(o);h.log("person",await a)}}},watch:{pod(){this.test1()}},computed:{pod(){return this.$store.state.solid.pod}}},y=p,b=n(1001),g=(0,b.Z)(y,r,i,!1,null,null,null),v=g.exports},4384:function(t){"use strict";t.exports=function t(e){return null===e||"object"!==typeof e||null!=e.toJSON?JSON.stringify(e):Array.isArray(e)?"["+e.reduce(((e,n,r)=>{const i=0===r?"":",",o=void 0===n||"symbol"===typeof n?null:n;return e+i+t(o)}),"")+"]":"{"+Object.keys(e).sort().reduce(((n,r,i)=>{if(void 0===e[r]||"symbol"===typeof e[r])return n;const o=0===n.length?"":",";return n+o+t(r)+":"+t(e[r])}),"")+"}"}},1418:function(t,e,n){n(1703),n(8675),n(3462),n(2801),function(t){(function(e){var n={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};function r(t){return t&&DataView.prototype.isPrototypeOf(t)}if(n.arrayBuffer)var i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],o=ArrayBuffer.isView||function(t){return t&&i.indexOf(Object.prototype.toString.call(t))>-1};function a(t){if("string"!==typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function s(t){return"string"!==typeof t&&(t=String(t)),t}function u(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return n.iterable&&(e[Symbol.iterator]=function(){return e}),e}function l(t){this.map={},t instanceof l?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function c(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function f(t){return new Promise((function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function h(t){var e=new FileReader,n=f(e);return e.readAsArrayBuffer(t),n}function d(t){var e=new FileReader,n=f(e);return e.readAsText(t),n}function p(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}function y(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(t){this._bodyInit=t,t?"string"===typeof t?this._bodyText=t:n.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:n.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:n.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():n.arrayBuffer&&n.blob&&r(t)?(this._bodyArrayBuffer=y(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):n.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||o(t))?this._bodyArrayBuffer=y(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"===typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n.blob&&(this.blob=function(){var t=c(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?c(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(h)}),this.text=function(){var t=c(this);if(t)return t;if(this._bodyBlob)return d(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(p(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n.formData&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}l.prototype.append=function(t,e){t=a(t),e=s(e);var n=this.map[t];this.map[t]=n?n+", "+e:e},l.prototype["delete"]=function(t){delete this.map[a(t)]},l.prototype.get=function(t){return t=a(t),this.has(t)?this.map[t]:null},l.prototype.has=function(t){return this.map.hasOwnProperty(a(t))},l.prototype.set=function(t,e){this.map[a(t)]=s(e)},l.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},l.prototype.keys=function(){var t=[];return this.forEach((function(e,n){t.push(n)})),u(t)},l.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),u(t)},l.prototype.entries=function(){var t=[];return this.forEach((function(e,n){t.push([n,e])})),u(t)},n.iterable&&(l.prototype[Symbol.iterator]=l.prototype.entries);var g=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function v(t){var e=t.toUpperCase();return g.indexOf(e)>-1?e:t}function m(t,e){e=e||{};var n=e.body;if(t instanceof m){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new l(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new l(e.headers)),this.method=v(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function w(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(i))}})),e}function _(t){var e=new l,n=t.replace(/\r?\n[\t ]+/g," ");return n.split(/\r?\n/).forEach((function(t){var n=t.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();e.append(r,i)}})),e}function E(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new l(e.headers),this.url=e.url||"",this._initBody(t)}m.prototype.clone=function(){return new m(this,{body:this._bodyInit})},b.call(m.prototype),b.call(E.prototype),E.prototype.clone=function(){return new E(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})},E.error=function(){var t=new E(null,{status:0,statusText:""});return t.type="error",t};var S=[301,302,303,307,308];E.redirect=function(t,e){if(-1===S.indexOf(e))throw new RangeError("Invalid status code");return new E(null,{status:e,headers:{location:t}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(O){e.DOMException=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function x(t,r){return new Promise((function(i,o){var a=new m(t,r);if(a.signal&&a.signal.aborted)return o(new e.DOMException("Aborted","AbortError"));var s=new XMLHttpRequest;function u(){s.abort()}s.onload=function(){var t={status:s.status,statusText:s.statusText,headers:_(s.getAllResponseHeaders()||"")};t.url="responseURL"in s?s.responseURL:t.headers.get("X-Request-URL");var e="response"in s?s.response:s.responseText;i(new E(e,t))},s.onerror=function(){o(new TypeError("Network request failed"))},s.ontimeout=function(){o(new TypeError("Network request failed"))},s.onabort=function(){o(new e.DOMException("Aborted","AbortError"))},s.open(a.method,a.url,!0),"include"===a.credentials?s.withCredentials=!0:"omit"===a.credentials&&(s.withCredentials=!1),"responseType"in s&&n.blob&&(s.responseType="blob"),a.headers.forEach((function(t,e){s.setRequestHeader(e,t)})),a.signal&&(a.signal.addEventListener("abort",u),s.onreadystatechange=function(){4===s.readyState&&a.signal.removeEventListener("abort",u)}),s.send("undefined"===typeof a._bodyInit?null:a._bodyInit)}))}x.polyfill=!0,t.fetch||(t.fetch=x,t.Headers=l,t.Request=m,t.Response=E),e.Headers=l,e.Request=m,e.Response=E,e.fetch=x,Object.defineProperty(e,"__esModule",{value:!0})})({})}("undefined"!==typeof self?self:this)},157:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),i(n(7394),e),i(n(5707),e),i(n(2802),e),i(n(2240),e),i(n(8786),e),i(n(7331),e),i(n(443),e)},7394:function(t,e,n){"use strict";n(1703),Object.defineProperty(e,"__esModule",{value:!0}),e.defaultExpandOptions=e.ContextParser=void 0,n(1418);const r=n(5600),i=n(5707),o=n(2802),a=n(7331),s=n(443),u=n(4384);class l{constructor(t){t=t||{},this.documentLoader=t.documentLoader||new o.FetchDocumentLoader,this.documentCache={},this.validateContext=!t.skipValidation,this.expandContentTypeToBase=!!t.expandContentTypeToBase,this.remoteContextsDepthLimit=t.remoteContextsDepthLimit||32,this.redirectSchemaOrgHttps=!("redirectSchemaOrgHttps"in t)||!!t.redirectSchemaOrgHttps}static validateLanguage(t,e,n){if("string"!==typeof t)throw new i.ErrorCoded(`The value of an '@language' must be a string, got '${JSON.stringify(t)}'`,n);if(!s.Util.REGEX_LANGUAGE_TAG.test(t)){if(e)throw new i.ErrorCoded(`The value of an '@language' must be a valid language tag, got '${JSON.stringify(t)}'`,n);return!1}return!0}static validateDirection(t,e){if("string"!==typeof t)throw new i.ErrorCoded(`The value of an '@direction' must be a string, got '${JSON.stringify(t)}'`,i.ERROR_CODES.INVALID_BASE_DIRECTION);if(!s.Util.REGEX_DIRECTION_TAG.test(t)){if(e)throw new i.ErrorCoded(`The value of an '@direction' must be 'ltr' or 'rtl', got '${JSON.stringify(t)}'`,i.ERROR_CODES.INVALID_BASE_DIRECTION);return!1}return!0}idifyReverseTerms(t){for(const e of Object.keys(t)){const n=t[e];if(n&&"object"===typeof n&&n["@reverse"]&&!n["@id"]){if("string"!==typeof n["@reverse"]||s.Util.isValidKeyword(n["@reverse"]))throw new i.ErrorCoded(`Invalid @reverse value, must be absolute IRI or blank node: '${n["@reverse"]}'`,i.ERROR_CODES.INVALID_IRI_MAPPING);n["@id"]=n["@reverse"],s.Util.isPotentialKeyword(n["@reverse"])?delete n["@reverse"]:n["@reverse"]=!0}}return t}expandPrefixedTerms(t,e){const n=t.getContextRaw();for(const r of Object.keys(n))if(s.Util.EXPAND_KEYS_BLACKLIST.indexOf(r)<0&&!s.Util.isReservedInternalKeyword(r)){const o=n[r];if(s.Util.isPotentialKeyword(r)&&s.Util.ALIAS_DOMAIN_BLACKLIST.indexOf(r)>=0&&("@type"!==r||"object"===typeof n[r]&&!n[r]["@protected"]&&"@set"!==n[r]["@container"]))throw new i.ErrorCoded(`Keywords can not be aliased to something else.\nTried mapping ${r} to ${JSON.stringify(o)}`,i.ERROR_CODES.KEYWORD_REDEFINITION);if(s.Util.ALIAS_RANGE_BLACKLIST.indexOf(s.Util.getContextValueId(o))>=0)throw new i.ErrorCoded(`Aliasing to certain keywords is not allowed.\nTried mapping ${r} to ${JSON.stringify(o)}`,i.ERROR_CODES.INVALID_KEYWORD_ALIAS);if(o&&s.Util.isPotentialKeyword(s.Util.getContextValueId(o))&&!0===o["@prefix"])throw new i.ErrorCoded(`Tried to use keyword aliases as prefix: '${r}': '${JSON.stringify(o)}'`,i.ERROR_CODES.INVALID_TERM_DEFINITION);while(s.Util.isPrefixValue(n[r])){const i=n[r];let o=!1;if("string"===typeof i)n[r]=t.expandTerm(i,!0),o=o||i!==n[r];else{const a=i["@id"],u=i["@type"],l=!("@prefix"in i)||s.Util.isValidIri(r);if("@id"in i)void 0!==a&&null!==a&&"string"===typeof a&&(n[r]["@id"]=t.expandTerm(a,!0),o=o||a!==n[r]["@id"]);else if(!s.Util.isPotentialKeyword(r)&&l){const e=t.expandTerm(r,!0);e!==r&&(n[r]["@id"]=e,o=!0)}!u||"string"!==typeof u||"@vocab"===u||i["@container"]&&i["@container"]["@type"]||!l||(n[r]["@type"]=t.expandTerm(u,!0),e&&u===n[r]["@type"]&&(n[r]["@type"]=t.expandTerm(u,!1)),o=o||u!==n[r]["@type"])}if(!o)break}}}normalize(t,{processingMode:e,normalizeLanguageTags:n}){if(n||1===e)for(const r of Object.keys(t))if("@language"===r&&"string"===typeof t[r])t[r]=t[r].toLowerCase();else{const e=t[r];e&&"object"===typeof e&&"string"===typeof e["@language"]&&(e["@language"]=e["@language"].toLowerCase())}}containersToHash(t){for(const e of Object.keys(t)){const n=t[e];if(n&&"object"===typeof n)if("string"===typeof n["@container"])n["@container"]={[n["@container"]]:!0};else if(Array.isArray(n["@container"])){const t={};for(const e of n["@container"])t[e]=!0;n["@container"]=t}}}applyScopedProtected(t,{processingMode:e}){if(e&&e>=1.1&&t["@protected"]){for(const e of Object.keys(t))if(!s.Util.isReservedInternalKeyword(e)&&!s.Util.isPotentialKeyword(e)&&!s.Util.isTermProtected(t,e)){const n=t[e];n&&"object"===typeof n?"@protected"in t[e]||(t[e]["@protected"]=!0):t[e]={"@id":n,"@protected":!0}}delete t["@protected"]}}validateKeywordRedefinitions(t,e,n){for(const r of Object.keys(e))if(s.Util.isTermProtected(t,r)){if("string"===typeof e[r]){const i=s.Util.isSimpleTermDefinitionPrefix(e[r],n);e[r]={"@id":e[r]},i&&(e[r]["@prefix"]=!0,t[r]["@prefix"]=!0)}const o=u(t[r]);e[r]["@protected"]=!0;const a=u(e[r]);if(o!==a)throw new i.ErrorCoded(`Attempted to override the protected keyword ${r} from ${JSON.stringify(s.Util.getContextValueId(t[r]))} to ${JSON.stringify(s.Util.getContextValueId(e[r]))}`,i.ERROR_CODES.PROTECTED_TERM_REDEFINITION)}}validate(t,{processingMode:e}){for(const n of Object.keys(t)){if(s.Util.isReservedInternalKeyword(n))continue;if(""===n)throw new i.ErrorCoded(`The empty term is not allowed, got: '${n}': '${JSON.stringify(t[n])}'`,i.ERROR_CODES.INVALID_TERM_DEFINITION);const r=t[n],o=typeof r;if(s.Util.isPotentialKeyword(n)){switch(n.substr(1)){case"vocab":if(null!==r&&"string"!==o)throw new i.ErrorCoded(`Found an invalid @vocab IRI: ${r}`,i.ERROR_CODES.INVALID_VOCAB_MAPPING);break;case"base":if(null!==r&&"string"!==o)throw new i.ErrorCoded(`Found an invalid @base IRI: ${t[n]}`,i.ERROR_CODES.INVALID_BASE_IRI);break;case"language":null!==r&&l.validateLanguage(r,!0,i.ERROR_CODES.INVALID_DEFAULT_LANGUAGE);break;case"version":if(null!==r&&"number"!==o)throw new i.ErrorCoded(`Found an invalid @version number: ${r}`,i.ERROR_CODES.INVALID_VERSION_VALUE);break;case"direction":null!==r&&l.validateDirection(r,!0);break;case"propagate":if(1===e)throw new i.ErrorCoded(`Found an illegal @propagate keyword: ${r}`,i.ERROR_CODES.INVALID_CONTEXT_ENTRY);if(null!==r&&"boolean"!==o)throw new i.ErrorCoded(`Found an invalid @propagate value: ${r}`,i.ERROR_CODES.INVALID_PROPAGATE_VALUE);break}if(s.Util.isValidKeyword(n)&&s.Util.isValidKeyword(s.Util.getContextValueId(r)))throw new i.ErrorCoded(`Illegal keyword alias in term value, found: '${n}': '${s.Util.getContextValueId(r)}'`,i.ERROR_CODES.KEYWORD_REDEFINITION)}else if(null!==r)switch(o){case"string":if(s.Util.getPrefix(r,t)===n)throw new i.ErrorCoded(`Detected cyclical IRI mapping in context entry: '${n}': '${JSON.stringify(r)}'`,i.ERROR_CODES.CYCLIC_IRI_MAPPING);if(s.Util.isValidIriWeak(n)){if("@type"===r)throw new i.ErrorCoded(`IRIs can not be mapped to @type, found: '${n}': '${r}'`,i.ERROR_CODES.INVALID_IRI_MAPPING);if(s.Util.isValidIri(r)&&r!==new a.JsonLdContextNormalized(t).expandTerm(n))throw new i.ErrorCoded(`IRIs can not be mapped to other IRIs, found: '${n}': '${r}'`,i.ERROR_CODES.INVALID_IRI_MAPPING)}break;case"object":if(!s.Util.isCompactIri(n)&&!("@id"in r)&&("@id"===r["@type"]?!t["@base"]:!t["@vocab"]))throw new i.ErrorCoded(`Missing @id in context entry: '${n}': '${JSON.stringify(r)}'`,i.ERROR_CODES.INVALID_IRI_MAPPING);for(const u of Object.keys(r)){const c=r[u];if(c)switch(u){case"@id":if(s.Util.isValidKeyword(c)&&"@type"!==c&&"@id"!==c&&"@graph"!==c)throw new i.ErrorCoded(`Illegal keyword alias in term value, found: '${n}': '${JSON.stringify(r)}'`,i.ERROR_CODES.INVALID_IRI_MAPPING);if(s.Util.isValidIriWeak(n)){if("@type"===c)throw new i.ErrorCoded(`IRIs can not be mapped to @type, found: '${n}': '${JSON.stringify(r)}'`,i.ERROR_CODES.INVALID_IRI_MAPPING);if(s.Util.isValidIri(c)&&c!==new a.JsonLdContextNormalized(t).expandTerm(n))throw new i.ErrorCoded(`IRIs can not be mapped to other IRIs, found: '${n}': '${JSON.stringify(r)}'`,i.ERROR_CODES.INVALID_IRI_MAPPING)}if("string"!==typeof c)throw new i.ErrorCoded(`Detected non-string @id in context entry: '${n}': '${JSON.stringify(r)}'`,i.ERROR_CODES.INVALID_IRI_MAPPING);if(s.Util.getPrefix(c,t)===n)throw new i.ErrorCoded(`Detected cyclical IRI mapping in context entry: '${n}': '${JSON.stringify(r)}'`,i.ERROR_CODES.CYCLIC_IRI_MAPPING);break;case"@type":if("@type"===r["@container"]&&"@id"!==c&&"@vocab"!==c)throw new i.ErrorCoded(`@container: @type only allows @type: @id or @vocab, but got: '${n}': '${c}'`,i.ERROR_CODES.INVALID_TYPE_MAPPING);if("string"!==typeof c)throw new i.ErrorCoded(`The value of an '@type' must be a string, got '${JSON.stringify(o)}'`,i.ERROR_CODES.INVALID_TYPE_MAPPING);if("@id"!==c&&"@vocab"!==c&&(1===e||"@json"!==c)&&(1===e||"@none"!==c)&&("_"===c[0]||!s.Util.isValidIri(c)))throw new i.ErrorCoded(`A context @type must be an absolute IRI, found: '${n}': '${c}'`,i.ERROR_CODES.INVALID_TYPE_MAPPING);break;case"@reverse":if("string"===typeof c&&r["@id"]&&r["@id"]!==c)throw new i.ErrorCoded(`Found non-matching @id and @reverse term values in '${n}':'${c}' and '${r["@id"]}'`,i.ERROR_CODES.INVALID_REVERSE_PROPERTY);if("@nest"in r)throw new i.ErrorCoded(`@nest is not allowed in the reverse property '${n}'`,i.ERROR_CODES.INVALID_REVERSE_PROPERTY);break;case"@container":if(1===e&&(Object.keys(c).length>1||s.Util.CONTAINERS_1_0.indexOf(Object.keys(c)[0])<0))throw new i.ErrorCoded(`Invalid term @container for '${n}' ('${Object.keys(c)}') in 1.0, must be only one of ${s.Util.CONTAINERS_1_0.join(", ")}`,i.ERROR_CODES.INVALID_CONTAINER_MAPPING);for(const t of Object.keys(c)){if("@list"===t&&r["@reverse"])throw new i.ErrorCoded(`Term value can not be @container: @list and @reverse at the same time on '${n}'`,i.ERROR_CODES.INVALID_REVERSE_PROPERTY);if(s.Util.CONTAINERS.indexOf(t)<0)throw new i.ErrorCoded(`Invalid term @container for '${n}' ('${t}'), must be one of ${s.Util.CONTAINERS.join(", ")}`,i.ERROR_CODES.INVALID_CONTAINER_MAPPING)}break;case"@language":l.validateLanguage(c,!0,i.ERROR_CODES.INVALID_LANGUAGE_MAPPING);break;case"@direction":l.validateDirection(c,!0);break;case"@prefix":if(null!==c&&"boolean"!==typeof c)throw new i.ErrorCoded(`Found an invalid term @prefix boolean in: '${n}': '${JSON.stringify(r)}'`,i.ERROR_CODES.INVALID_PREFIX_VALUE);if(!("@id"in r)&&!s.Util.isValidIri(n))throw new i.ErrorCoded(`Invalid @prefix definition for '${n}' ('${JSON.stringify(r)}'`,i.ERROR_CODES.INVALID_TERM_DEFINITION);break;case"@index":if(1===e||!r["@container"]||!r["@container"]["@index"])throw new i.ErrorCoded(`Attempt to add illegal key to value object: '${n}': '${JSON.stringify(r)}'`,i.ERROR_CODES.INVALID_TERM_DEFINITION);break;case"@nest":if(s.Util.isPotentialKeyword(c)&&"@nest"!==c)throw new i.ErrorCoded(`Found an invalid term @nest value in: '${n}': '${JSON.stringify(r)}'`,i.ERROR_CODES.INVALID_NEST_VALUE)}}break;default:throw new i.ErrorCoded(`Found an invalid term value: '${n}': '${r}'`,i.ERROR_CODES.INVALID_TERM_DEFINITION)}}}applyBaseEntry(t,e,n){return"string"===typeof t||(n&&!("@base"in t)&&e.parentContext&&"object"===typeof e.parentContext&&"@base"in e.parentContext&&(t["@base"]=e.parentContext["@base"],e.parentContext["@__baseDocument"]&&(t["@__baseDocument"]=!0)),e.baseIRI&&!e.external&&("@base"in t?null===t["@base"]||"string"!==typeof t["@base"]||s.Util.isValidIri(t["@base"])||(t["@base"]=r.resolve(t["@base"],e.parentContext&&e.parentContext["@base"]||e.baseIRI)):(t["@base"]=e.baseIRI,t["@__baseDocument"]=!0))),t}normalizeContextIri(t,e){if(!s.Util.isValidIri(t))try{t=r.resolve(t,e)}catch(n){throw new Error(`Invalid context IRI: ${t}`)}return this.redirectSchemaOrgHttps&&t.startsWith("http://schema.org")&&(t="https://schema.org/"),t}async parseInnerContexts(t,e){for(const r of Object.keys(t)){const o=t[r];if(o&&"object"===typeof o&&"@context"in o&&null!==o["@context"]&&!e.ignoreScopedContexts){if(this.validateContext)try{const n=Object.assign({},t);n[r]=Object.assign({},n[r]),delete n[r]["@context"],await this.parse(o["@context"],Object.assign(Object.assign({},e),{parentContext:n,ignoreProtection:!0,ignoreRemoteScopedContexts:!0,ignoreScopedContexts:!0}))}catch(n){throw new i.ErrorCoded(n.message,i.ERROR_CODES.INVALID_SCOPED_CONTEXT)}o["@context"]=(await this.parse(o["@context"],Object.assign(Object.assign({},e),{minimalProcessing:!0,ignoreRemoteScopedContexts:!0,parentContext:t}))).getContextRaw()}}return t}async parse(t,n={}){const{baseIRI:r,parentContext:o,external:u,processingMode:c=l.DEFAULT_PROCESSING_MODE,normalizeLanguageTags:f,ignoreProtection:h,minimalProcessing:d}=n;let p=o;const y=n.remoteContexts||{};if(Object.keys(y).length>=this.remoteContextsDepthLimit)throw new i.ErrorCoded("Detected an overflow in remote context inclusions: "+Object.keys(y),i.ERROR_CODES.CONTEXT_OVERFLOW);if(null===t||void 0===t){if(!h&&p&&s.Util.hasProtectedTerms(p))throw new i.ErrorCoded("Illegal context nullification when terms are protected",i.ERROR_CODES.INVALID_CONTEXT_NULLIFICATION);return new a.JsonLdContextNormalized(this.applyBaseEntry({},n,!1))}if("string"===typeof t){const e=this.normalizeContextIri(t,r),i=this.getOverriddenLoad(e,n);if(i)return new a.JsonLdContextNormalized(i);const o=await this.parse(await this.load(e),Object.assign(Object.assign({},n),{baseIRI:e,external:!0,remoteContexts:Object.assign(Object.assign({},y),{[e]:!0})}));return this.applyBaseEntry(o.getContextRaw(),n,!0),o}if(Array.isArray(t)){const e=[],i=await Promise.all(t.map(((t,i)=>{if("string"===typeof t){const o=this.normalizeContextIri(t,r);e[i]=o;const a=this.getOverriddenLoad(o,n);return a||this.load(o)}return t})));if(d)return new a.JsonLdContextNormalized(i);const o=await i.reduce(((t,r,i)=>t.then((t=>this.parse(r,Object.assign(Object.assign({},n),{baseIRI:e[i]||n.baseIRI,external:!!e[i]||n.external,parentContext:t.getContextRaw(),remoteContexts:e[i]?Object.assign(Object.assign({},y),{[e[i]]:!0}):y}))))),Promise.resolve(new a.JsonLdContextNormalized(p||{})));return this.applyBaseEntry(o.getContextRaw(),n,!0),o}if("object"===typeof t){if("@context"in t)return await this.parse(t["@context"],n);t=JSON.parse(JSON.stringify(t)),p&&!d&&(p=JSON.parse(JSON.stringify(p)));let o={};if(u&&delete t["@base"],this.applyBaseEntry(t,n,!0),this.containersToHash(t),d)return new a.JsonLdContextNormalized(t);let s={};if("@import"in t){if(!(c>=1.1))throw new i.ErrorCoded("Context importing is not supported in JSON-LD 1.0",i.ERROR_CODES.INVALID_CONTEXT_ENTRY);if("string"!==typeof t["@import"])throw new i.ErrorCoded("An @import value must be a string, but got "+typeof t["@import"],i.ERROR_CODES.INVALID_IMPORT_VALUE);s=await this.loadImportContext(this.normalizeContextIri(t["@import"],r)),delete t["@import"]}o=Object.assign(Object.assign(Object.assign(Object.assign({},o),"object"===typeof p?p:{}),s),t);const y=new a.JsonLdContextNormalized(o);return await this.parseInnerContexts(o,n),(o&&o["@version"]||l.DEFAULT_PROCESSING_MODE)>=1.1&&(t["@vocab"]&&"string"===typeof t["@vocab"]||""===t["@vocab"])&&t["@vocab"].indexOf(":")<0&&p&&"@vocab"in p&&(o["@vocab"]=p["@vocab"]+t["@vocab"]),this.idifyReverseTerms(o),this.expandPrefixedTerms(y,this.expandContentTypeToBase),!h&&p&&c>=1.1&&this.validateKeywordRedefinitions(p,o,e.defaultExpandOptions),this.normalize(o,{processingMode:c,normalizeLanguageTags:f}),this.applyScopedProtected(o,{processingMode:c}),this.validateContext&&this.validate(o,{processingMode:c}),y}throw new i.ErrorCoded(`Tried parsing a context that is not a string, array or object, but got ${t}`,i.ERROR_CODES.INVALID_LOCAL_CONTEXT)}async load(t){const e=this.documentCache[t];if(e)return"string"===typeof e?e:Array.isArray(e)?e.slice():Object.assign({},e);let n;try{n=await this.documentLoader.load(t)}catch(r){throw new i.ErrorCoded(`Failed to load remote context ${t}: ${r.message}`,i.ERROR_CODES.LOADING_REMOTE_CONTEXT_FAILED)}if(!("@context"in n))throw new i.ErrorCoded(`Missing @context in remote context at ${t}`,i.ERROR_CODES.INVALID_REMOTE_CONTEXT);return this.documentCache[t]=n["@context"]}getOverriddenLoad(t,e){if(t in(e.remoteContexts||{})){if(e.ignoreRemoteScopedContexts)return t;throw new i.ErrorCoded("Detected a cyclic context inclusion of "+t,i.ERROR_CODES.RECURSIVE_CONTEXT_INCLUSION)}return null}async loadImportContext(t){const e=await this.load(t);if("object"!==typeof e||Array.isArray(e))throw new i.ErrorCoded("An imported context must be a single object: "+t,i.ERROR_CODES.INVALID_REMOTE_CONTEXT);if("@import"in e)throw new i.ErrorCoded("An imported context can not import another context: "+t,i.ERROR_CODES.INVALID_CONTEXT_ENTRY);return this.containersToHash(e),e}}e.ContextParser=l,l.DEFAULT_PROCESSING_MODE=1.1,e.defaultExpandOptions={allowPrefixForcing:!0,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!0}},5707:function(t,e,n){"use strict";n(1703),Object.defineProperty(e,"__esModule",{value:!0}),e.ERROR_CODES=e.ErrorCoded=void 0;class r extends Error{constructor(t,e){super(t),this.code=e}}e.ErrorCoded=r,function(t){t["COLLIDING_KEYWORDS"]="colliding keywords",t["CONFLICTING_INDEXES"]="conflicting indexes",t["CYCLIC_IRI_MAPPING"]="cyclic IRI mapping",t["INVALID_ID_VALUE"]="invalid @id value",t["INVALID_INDEX_VALUE"]="invalid @index value",t["INVALID_NEST_VALUE"]="invalid @nest value",t["INVALID_PREFIX_VALUE"]="invalid @prefix value",t["INVALID_PROPAGATE_VALUE"]="invalid @propagate value",t["INVALID_REVERSE_VALUE"]="invalid @reverse value",t["INVALID_IMPORT_VALUE"]="invalid @import value",t["INVALID_VERSION_VALUE"]="invalid @version value",t["INVALID_BASE_IRI"]="invalid base IRI",t["INVALID_CONTAINER_MAPPING"]="invalid container mapping",t["INVALID_CONTEXT_ENTRY"]="invalid context entry",t["INVALID_CONTEXT_NULLIFICATION"]="invalid context nullification",t["INVALID_DEFAULT_LANGUAGE"]="invalid default language",t["INVALID_INCLUDED_VALUE"]="invalid @included value",t["INVALID_IRI_MAPPING"]="invalid IRI mapping",t["INVALID_JSON_LITERAL"]="invalid JSON literal",t["INVALID_KEYWORD_ALIAS"]="invalid keyword alias",t["INVALID_LANGUAGE_MAP_VALUE"]="invalid language map value",t["INVALID_LANGUAGE_MAPPING"]="invalid language mapping",t["INVALID_LANGUAGE_TAGGED_STRING"]="invalid language-tagged string",t["INVALID_LANGUAGE_TAGGED_VALUE"]="invalid language-tagged value",t["INVALID_LOCAL_CONTEXT"]="invalid local context",t["INVALID_REMOTE_CONTEXT"]="invalid remote context",t["INVALID_REVERSE_PROPERTY"]="invalid reverse property",t["INVALID_REVERSE_PROPERTY_MAP"]="invalid reverse property map",t["INVALID_REVERSE_PROPERTY_VALUE"]="invalid reverse property value",t["INVALID_SCOPED_CONTEXT"]="invalid scoped context",t["INVALID_SCRIPT_ELEMENT"]="invalid script element",t["INVALID_SET_OR_LIST_OBJECT"]="invalid set or list object",t["INVALID_TERM_DEFINITION"]="invalid term definition",t["INVALID_TYPE_MAPPING"]="invalid type mapping",t["INVALID_TYPE_VALUE"]="invalid type value",t["INVALID_TYPED_VALUE"]="invalid typed value",t["INVALID_VALUE_OBJECT"]="invalid value object",t["INVALID_VALUE_OBJECT_VALUE"]="invalid value object value",t["INVALID_VOCAB_MAPPING"]="invalid vocab mapping",t["IRI_CONFUSED_WITH_PREFIX"]="IRI confused with prefix",t["KEYWORD_REDEFINITION"]="keyword redefinition",t["LOADING_DOCUMENT_FAILED"]="loading document failed",t["LOADING_REMOTE_CONTEXT_FAILED"]="loading remote context failed",t["MULTIPLE_CONTEXT_LINK_HEADERS"]="multiple context link headers",t["PROCESSING_MODE_CONFLICT"]="processing mode conflict",t["PROTECTED_TERM_REDEFINITION"]="protected term redefinition",t["CONTEXT_OVERFLOW"]="context overflow",t["INVALID_BASE_DIRECTION"]="invalid base direction",t["RECURSIVE_CONTEXT_INCLUSION"]="recursive context inclusion",t["INVALID_STREAMING_KEY_ORDER"]="invalid streaming key order"}(e.ERROR_CODES||(e.ERROR_CODES={}))},2802:function(t,e,n){"use strict";n(1703),Object.defineProperty(e,"__esModule",{value:!0}),e.FetchDocumentLoader=void 0,n(1418);const r=n(5707),i=n(2121),o=n(5600);class a{constructor(t){this.fetcher=t}async load(t){const e=await(this.fetcher||fetch)(t,{headers:new Headers({accept:"application/ld+json"})});if(e.ok&&e.headers){let n=e.headers.get("Content-Type");if(n){const t=n.indexOf(";");t>0&&(n=n.substr(0,t))}if("application/ld+json"===n)return await e.json();if(e.headers.has("Link")){let n;if(e.headers.forEach(((e,r)=>{if("link"===r){const r=i.parse(e);for(const e of r.get("type","application/ld+json"))if("alternate"===e.rel){if(n)throw new Error("Multiple JSON-LD alternate links were found on "+t);n=o.resolve(e.uri,t)}}})),n)return this.load(n)}throw new r.ErrorCoded(`Unsupported JSON-LD media type ${n}`,r.ERROR_CODES.LOADING_DOCUMENT_FAILED)}throw new Error(e.statusText||`Status code: ${e.status}`)}}e.FetchDocumentLoader=a},2240:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},8786:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},7331:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.JsonLdContextNormalized=void 0;const r=n(5600),i=n(7394),o=n(5707),a=n(443);class s{constructor(t){this.contextRaw=t}getContextRaw(){return this.contextRaw}expandTerm(t,e,n=i.defaultExpandOptions){const s=this.contextRaw[t];if(null===s||s&&null===s["@id"])return null;let u=!0;if(s&&e){const e=a.Util.getContextValueId(s);if(e&&e!==t){if("string"===typeof e&&(a.Util.isValidIri(e)||a.Util.isValidKeyword(e)))return e;a.Util.isPotentialKeyword(e)||(u=!1)}}const l=a.Util.getPrefix(t,this.contextRaw),c=this.contextRaw["@vocab"],f=(!!c||""===c)&&c.indexOf(":")<0,h=this.contextRaw["@base"],d=a.Util.isPotentialKeyword(t);if(l){const e=this.contextRaw[l],r=a.Util.getContextValueId(e);if(r){if("string"!==typeof e&&n.allowPrefixForcing){if("_"!==r[0]&&!d&&!e["@prefix"]&&!(t in this.contextRaw))return t}else if(!a.Util.isSimpleTermDefinitionPrefix(r,n))return t;return r+t.substr(l.length+1)}}else{if(e&&(c||""===c||n.allowVocabRelativeToBase&&h&&f)&&!d&&!a.Util.isCompactIri(t)){if(f){if(n.allowVocabRelativeToBase)return(c||h?r.resolve(c,h):"")+t;throw new o.ErrorCoded(`Relative vocab expansion for term '${t}' with vocab '${c}' is not allowed.`,o.ERROR_CODES.INVALID_VOCAB_MAPPING)}return c+t}if(!e&&h&&!d&&!a.Util.isCompactIri(t))return r.resolve(t,h)}if(u)return t;throw new o.ErrorCoded(`Invalid IRI mapping found for context entry '${t}': '${JSON.stringify(s)}'`,o.ERROR_CODES.INVALID_IRI_MAPPING)}compactIri(t,e){if(e&&this.contextRaw["@vocab"]&&t.startsWith(this.contextRaw["@vocab"]))return t.substr(this.contextRaw["@vocab"].length);if(!e&&this.contextRaw["@base"]&&t.startsWith(this.contextRaw["@base"]))return t.substr(this.contextRaw["@base"].length);const n={prefix:"",suffix:t};for(const r in this.contextRaw){const i=this.contextRaw[r];if(i&&!a.Util.isPotentialKeyword(r)){const o=a.Util.getContextValueId(i);if(t.startsWith(o)){const i=t.substr(o.length);if(i)i.length<n.suffix.length&&(n.prefix=r,n.suffix=i);else if(e)return r}}}return n.prefix?n.prefix+":"+n.suffix:t}}e.JsonLdContextNormalized=s},443:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Util=void 0;class n{static isCompactIri(t){return t.indexOf(":")>0&&!(t&&"#"===t[0])}static getPrefix(t,e){if(t&&"#"===t[0])return null;const n=t.indexOf(":");if(n>=0){if(t.length>n+1&&"/"===t.charAt(n+1)&&"/"===t.charAt(n+2))return null;const r=t.substr(0,n);if("_"===r)return null;if(e[r])return r}return null}static getContextValueId(t){if(null===t||"string"===typeof t)return t;const e=t["@id"];return e||null}static isSimpleTermDefinitionPrefix(t,e){return!n.isPotentialKeyword(t)&&("_"===t[0]||e.allowPrefixNonGenDelims||n.isPrefixIriEndingWithGenDelim(t))}static isPotentialKeyword(t){return"string"===typeof t&&n.KEYWORD_REGEX.test(t)}static isPrefixIriEndingWithGenDelim(t){return n.ENDS_WITH_GEN_DELIM.test(t)}static isPrefixValue(t){return t&&("string"===typeof t||t&&"object"===typeof t)}static isValidIri(t){return Boolean(t&&n.IRI_REGEX.test(t))}static isValidIriWeak(t){return!!t&&":"!==t[0]&&n.IRI_REGEX_WEAK.test(t)}static isValidKeyword(t){return n.VALID_KEYWORDS[t]}static isTermProtected(t,e){const n=t[e];return!("string"===typeof n)&&n&&n["@protected"]}static hasProtectedTerms(t){for(const e of Object.keys(t))if(n.isTermProtected(t,e))return!0;return!1}static isReservedInternalKeyword(t){return t.startsWith("@__")}}e.Util=n,n.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^ "<>{}|\\\[\]`#]*(#[^#]*)?$/,n.IRI_REGEX_WEAK=/(?::[^:])|\//,n.KEYWORD_REGEX=/^@[a-z]+$/i,n.ENDS_WITH_GEN_DELIM=/[:/?#\[\]@]$/,n.REGEX_LANGUAGE_TAG=/^[a-zA-Z]+(-[a-zA-Z0-9]+)*$/,n.REGEX_DIRECTION_TAG=/^(ltr)|(rtl)$/,n.VALID_KEYWORDS={"@base":!0,"@container":!0,"@context":!0,"@direction":!0,"@graph":!0,"@id":!0,"@import":!0,"@included":!0,"@index":!0,"@json":!0,"@language":!0,"@list":!0,"@nest":!0,"@none":!0,"@prefix":!0,"@propagate":!0,"@protected":!0,"@reverse":!0,"@set":!0,"@type":!0,"@value":!0,"@version":!0,"@vocab":!0},n.EXPAND_KEYS_BLACKLIST=["@base","@vocab","@language","@version","@direction"],n.ALIAS_DOMAIN_BLACKLIST=["@container","@graph","@id","@index","@list","@nest","@none","@prefix","@reverse","@set","@type","@value","@version"],n.ALIAS_RANGE_BLACKLIST=["@context","@preserve"],n.CONTAINERS=["@list","@set","@index","@language","@graph","@id","@type"],n.CONTAINERS_1_0=["@list","@set","@index"]},7077:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),i(n(4884),e)},5072:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContextTree=void 0;class n{constructor(){this.subTrees={}}getContext(t){if(t.length>0){const[e,...n]=t,r=this.subTrees[e];if(r){const t=r.getContext(n);if(t)return t.then((({context:t,depth:e})=>({context:t,depth:e+1})))}}return this.context?this.context.then((t=>({context:t,depth:0}))):null}setContext(t,e){if(0===t.length)this.context=e;else{const[r,...i]=t;let o=this.subTrees[r];o||(o=this.subTrees[r]=new n),o.setContext(i,e)}}removeContext(t){this.setContext(t,null)}}e.ContextTree=n},4884:function(t,e,n){"use strict";n(1703),Object.defineProperty(e,"__esModule",{value:!0}),e.JsonLdParser=void 0;const r=n(8296),i=n(157),o=n(6639),a=n(4917),s=n(5288),u=n(9369),l=n(6016),c=n(4422),f=n(5323),h=n(640),d=n(2822),p=n(5116),y=n(1867),b=n(4133),g=n(6453),v=n(989),m=n(1106),w=n(2121);class _ extends o.Transform{constructor(t){super({readableObjectMode:!0}),t=t||{},this.options=t,this.parsingContext=new v.ParsingContext(Object.assign({parser:this},t)),this.util=new m.Util({dataFactory:t.dataFactory,parsingContext:this.parsingContext}),this.jsonParser=new r,this.contextJobs=[],this.typeJobs=[],this.contextAwaitingJobs=[],this.lastDepth=0,this.lastKeys=[],this.lastOnValueJob=Promise.resolve(),this.attachJsonParserListeners(),this.on("end",(()=>{"undefined"!==typeof this.jsonParser.mode&&this.emit("error",new Error("Unclosed document"))}))}static fromHttpResponse(t,e,n,r){let o,a;if("application/ld+json"!==e){if("application/json"!==e&&!e.endsWith("+json"))throw new i.ErrorCoded(`Unsupported JSON-LD media type ${e}`,i.ERROR_CODES.LOADING_DOCUMENT_FAILED);if(n&&n.has("Link")&&n.forEach(((e,n)=>{if("link"===n){const n=w.parse(e);for(const e of n.get("rel","http://www.w3.org/ns/json-ld#context")){if(o)throw new i.ErrorCoded("Multiple JSON-LD context link headers were found on "+t,i.ERROR_CODES.MULTIPLE_CONTEXT_LINK_HEADERS);o=e.uri}}})),!o&&!(null===r||void 0===r?void 0:r.ignoreMissingContextLinkHeader))throw new i.ErrorCoded(`Missing context link header for media type ${e} on ${t}`,i.ERROR_CODES.LOADING_DOCUMENT_FAILED)}if(n&&n.has("Content-Type")){const t=n.get("Content-Type"),e=/; *profile=([^"]*)/.exec(t);e&&"http://www.w3.org/ns/json-ld#streaming"===e[1]&&(a=!0)}return new _(Object.assign({baseIRI:t,context:o,streamingProfile:a},r||{}))}import(t){const e=new o.PassThrough({readableObjectMode:!0});t.on("error",(t=>n.emit("error",t))),t.on("data",(t=>e.push(t))),t.on("end",(()=>e.push(null)));const n=e.pipe(new _(this.options));return n}_transform(t,e,n){this.jsonParser.write(t),this.lastOnValueJob.then((()=>n()),(t=>n(t)))}async newOnValueJob(t,e,n,r){let o=!0;if(r&&n<this.lastDepth){const t=this.parsingContext.listPointerStack[this.lastDepth];t&&(t.value&&this.emit("data",this.util.dataFactory.quad(t.value,this.util.rdfRest,this.util.rdfNil,this.util.getDefaultGraph())),t.listId.listHead=!0,this.parsingContext.idStack[t.listRootDepth+1]=[t.listId],this.parsingContext.listPointerStack.splice(this.lastDepth,1)),await s.EntryHandlerContainer.isBufferableContainerHandler(this.parsingContext,this.lastKeys,this.lastDepth)?(this.parsingContext.pendingContainerFlushBuffers.push({depth:this.lastDepth,keys:this.lastKeys.slice(0,this.lastKeys.length)}),o=!1):await this.flushBuffer(this.lastDepth,this.lastKeys)}const a=await this.util.unaliasKeyword(t[n],t,n),u=await this.util.unaliasKeywordParent(t,n);this.parsingContext.emittedStack[n]=!0;let l=!0;i.Util.isValidKeyword(a)&&"@reverse"===u&&"@context"!==a&&this.emit("error",new i.ErrorCoded(`Found the @id '${e}' inside an @reverse property`,i.ERROR_CODES.INVALID_REVERSE_PROPERTY_MAP));let c=!1;this.parsingContext.validationStack.length>1&&(c=this.parsingContext.validationStack[this.parsingContext.validationStack.length-1].property);for(let i=Math.max(1,this.parsingContext.validationStack.length-1);i<t.length-1;i++){const e=this.parsingContext.validationStack[i]||(this.parsingContext.validationStack[i]=await this.validateKey(t.slice(0,i+1),i,c));if(!e.valid){this.parsingContext.emittedStack[n]=!1,l=!1;break}!c&&e.property&&(c=!0)}if(this.util.isLiteral(n)&&(l=!1),l)for(const i of _.ENTRY_HANDLERS){const r=await i.test(this.parsingContext,this.util,a,t,n);if(r){await i.handle(this.parsingContext,this.util,a,t,e,n,r),i.isStackProcessor()&&(this.parsingContext.processingStack[n]=!0);break}}0===n&&Array.isArray(e)&&await this.util.validateValueIndexes(e),o&&n<this.lastDepth&&this.flushStacks(this.lastDepth),this.lastDepth=n,this.lastKeys=t,this.parsingContext.unaliasedKeywordCacheStack.splice(n-1)}flushStacks(t){this.parsingContext.processingStack.splice(t,1),this.parsingContext.processingType.splice(t,1),this.parsingContext.emittedStack.splice(t,1),this.parsingContext.idStack.splice(t,1),this.parsingContext.graphStack.splice(t+1,1),this.parsingContext.graphContainerTermStack.splice(t,1),this.parsingContext.jsonLiteralStack.splice(t,1),this.parsingContext.validationStack.splice(t-1,2),this.parsingContext.literalStack.splice(t,this.parsingContext.literalStack.length-t)}async flushBuffer(t,e){let n=this.parsingContext.idStack[t];n||(n=this.parsingContext.idStack[t]=[this.util.dataFactory.blankNode()]);const r=this.parsingContext.unidentifiedValuesBuffer[t];if(r){for(const i of n){const n=await this.util.getDepthOffsetGraph(t,e),o=this.parsingContext.graphStack[t]||n>=0?this.parsingContext.idStack[t-n-1]:[await this.util.getGraphContainerValue(e,t)];if(o)for(const e of o){this.parsingContext.emittedStack[t]=!0;for(const n of r)n.reverse?this.parsingContext.emitQuad(t,this.util.dataFactory.quad(n.object,n.predicate,i,e)):this.parsingContext.emitQuad(t,this.util.dataFactory.quad(i,n.predicate,n.object,e))}else{const n=this.parsingContext.getUnidentifiedGraphBufferSafe(t-await this.util.getDepthOffsetGraph(t,e)-1);for(const t of r)t.reverse?n.push({object:i,predicate:t.predicate,subject:t.object}):n.push({object:t.object,predicate:t.predicate,subject:i})}}this.parsingContext.unidentifiedValuesBuffer.splice(t,1),this.parsingContext.literalStack.splice(t,1),this.parsingContext.jsonLiteralStack.splice(t,1)}const i=this.parsingContext.unidentifiedGraphsBuffer[t];if(i){for(const e of n){const n=1!==t||"BlankNode"!==e.termType||this.parsingContext.topLevelProperties?e:this.util.getDefaultGraph();this.parsingContext.emittedStack[t]=!0;for(const e of i)this.parsingContext.emitQuad(t,this.util.dataFactory.quad(e.subject,e.predicate,e.object,n))}this.parsingContext.unidentifiedGraphsBuffer.splice(t,1)}}async validateKey(t,e,n){for(const r of _.ENTRY_HANDLERS)if(await r.validate(this.parsingContext,this.util,t,e,n))return{valid:!0,property:n||r.isPropertyHandler()};return{valid:!1,property:!1}}attachJsonParserListeners(){this.jsonParser.onValue=t=>{const e=this.jsonParser.stack.length,n=new Array(e+1).fill(0).map(((t,n)=>n===e?this.jsonParser.key:this.jsonParser.stack[n].key));if(!this.isParsingContextInner(e)){const r=()=>this.newOnValueJob(n,t,e,!0);if(this.parsingContext.streamingProfile||this.parsingContext.contextTree.getContext(n.slice(0,-1)))this.lastOnValueJob=this.lastOnValueJob.then(r);else if("@context"===n[e]){let t=this.contextJobs[e];t||(t=this.contextJobs[e]=[]),t.push(r)}else"@type"===n[e]||"number"===typeof n[e]&&"@type"===n[e-1]?this.typeJobs.push({job:r,keys:n.slice(0,n.length-1)}):this.contextAwaitingJobs.push({job:r,keys:n});this.parsingContext.streamingProfile||0!==e||(this.lastOnValueJob=this.lastOnValueJob.then((()=>this.executeBufferedJobs())))}},this.jsonParser.onError=t=>{this.emit("error",t)}}isParsingContextInner(t){for(let e=t;e>0;e--)if("@context"===this.jsonParser.stack[e-1].key)return!0;return!1}async executeBufferedJobs(){for(const t of this.contextJobs)if(t)for(const e of t)await e();this.parsingContext.unaliasedKeywordCacheStack.splice(0);for(const t of this.contextAwaitingJobs){if(this.typeJobs.length>0){const e=[],n=[];for(let o=0;o<this.typeJobs.length;o++){const r=this.typeJobs[o];m.Util.isPrefixArray(r.keys,t.keys)&&(e.push(r),n.push(o))}const r=e.sort(((t,e)=>t.keys.length-e.keys.length));for(const t of r)await t.job();const i=n.sort().reverse();for(const t of i)this.typeJobs.splice(t,1)}await t.job()}}}e.JsonLdParser=_,_.DEFAULT_PROCESSING_MODE="1.1",_.ENTRY_HANDLERS=[new a.EntryHandlerArrayValue,new c.EntryHandlerKeywordContext,new h.EntryHandlerKeywordId,new d.EntryHandlerKeywordIncluded,new f.EntryHandlerKeywordGraph,new p.EntryHandlerKeywordNest,new y.EntryHandlerKeywordType,new g.EntryHandlerKeywordValue,new s.EntryHandlerContainer,new b.EntryHandlerKeywordUnknownFallback,new l.EntryHandlerPredicate,new u.EntryHandlerInvalidFallback]},989:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ParsingContext=void 0;const r=n(157),i=n(5707),o=n(5072),a=n(4884);class s{constructor(t){this.contextParser=new r.ContextParser({documentLoader:t.documentLoader,skipValidation:t.skipContextValidation}),this.streamingProfile=!!t.streamingProfile,this.baseIRI=t.baseIRI,this.produceGeneralizedRdf=!!t.produceGeneralizedRdf,this.allowSubjectList=!!t.allowSubjectList,this.processingMode=t.processingMode||a.JsonLdParser.DEFAULT_PROCESSING_MODE,this.strictValues=!!t.strictValues,this.validateValueIndexes=!!t.validateValueIndexes,this.defaultGraph=t.defaultGraph,this.rdfDirection=t.rdfDirection,this.normalizeLanguageTags=t.normalizeLanguageTags,this.streamingProfileAllowOutOfOrderPlainType=t.streamingProfileAllowOutOfOrderPlainType,this.topLevelProperties=!1,this.activeProcessingMode=parseFloat(this.processingMode),this.processingStack=[],this.processingType=[],this.emittedStack=[],this.idStack=[],this.graphStack=[],this.graphContainerTermStack=[],this.listPointerStack=[],this.contextTree=new o.ContextTree,this.literalStack=[],this.validationStack=[],this.unaliasedKeywordCacheStack=[],this.jsonLiteralStack=[],this.unidentifiedValuesBuffer=[],this.unidentifiedGraphsBuffer=[],this.pendingContainerFlushBuffers=[],this.parser=t.parser,t.context?(this.rootContext=this.parseContext(t.context),this.rootContext.then((t=>this.validateContext(t)))):this.rootContext=Promise.resolve(new r.JsonLdContextNormalized(this.baseIRI?{"@base":this.baseIRI,"@__baseDocument":!0}:{}))}async parseContext(t,e,n){return this.contextParser.parse(t,{baseIRI:this.baseIRI,ignoreProtection:n,normalizeLanguageTags:this.normalizeLanguageTags,parentContext:e,processingMode:this.activeProcessingMode})}validateContext(t){const e=t.getContextRaw()["@version"];if(e){if(this.activeProcessingMode&&e>this.activeProcessingMode)throw new i.ErrorCoded(`Unsupported JSON-LD version '${e}' under active processing mode ${this.activeProcessingMode}.`,i.ERROR_CODES.PROCESSING_MODE_CONFLICT);if(this.activeProcessingMode&&e<this.activeProcessingMode)throw new i.ErrorCoded(`Invalid JSON-LD version ${e} under active processing mode ${this.activeProcessingMode}.`,i.ERROR_CODES.INVALID_VERSION_VALUE);this.activeProcessingMode=e}}async getContext(t,e=1){const n=t;while("number"===typeof t[t.length-1])t=t.slice(0,t.length-1);e&&(t=t.slice(0,-e));const i=await this.getContextPropagationAware(t),o=i.context;let a=o.getContextRaw();for(let s=i.depth;s<n.length-e;s++){const t=n[s],i=a[t];if(i&&"object"===typeof i&&"@context"in i){const o=(await this.parseContext(i,a,!0)).getContextRaw(),u=!(t in o)||o[t]["@context"]["@propagate"];!1===u&&s!==n.length-1-e||(a=o,delete a["@propagate"],a[t]=Object.assign({},a[t]),"@id"in i&&(a[t]["@id"]=i["@id"]),delete a[t]["@context"],!1!==u&&this.contextTree.setContext(n.slice(0,s+e),Promise.resolve(new r.JsonLdContextNormalized(a))))}}return new r.JsonLdContextNormalized(a)}async getContextPropagationAware(t){const e=t.length;let n,i=null;do{n=!1,i&&"@__propagateFallback"in i.context.getContextRaw()?i.context=new r.JsonLdContextNormalized(i.context.getContextRaw()["@__propagateFallback"]):(i&&(t=t.slice(0,i.depth-1)),i=await this.contextTree.getContext(t)||{context:await this.rootContext,depth:0});const e=t[t.length-1];if(e in i.context.getContextRaw()){const t=i.context.getContextRaw()[e];t&&"object"===typeof t&&"@context"in t&&(n=!0)}}while(i.depth>0&&!1===i.context.getContextRaw()["@propagate"]&&i.depth!==e&&!n);return 0===i.depth&&!1===i.context.getContextRaw()["@propagate"]&&i.depth!==e&&(i.context=new r.JsonLdContextNormalized({})),i}async newOnValueJob(t,e,n,r){await this.parser.newOnValueJob(t,e,n,r)}async handlePendingContainerFlushBuffers(){if(this.pendingContainerFlushBuffers.length>0){for(const t of this.pendingContainerFlushBuffers)await this.parser.flushBuffer(t.depth,t.keys),this.parser.flushStacks(t.depth);return this.pendingContainerFlushBuffers.splice(0,this.pendingContainerFlushBuffers.length),!0}return!1}emitQuad(t,e){1===t&&(this.topLevelProperties=!0),this.parser.push(e)}emitError(t){this.parser.emit("error",t)}emitContext(t){this.parser.emit("context",t)}getUnidentifiedValueBufferSafe(t){let e=this.unidentifiedValuesBuffer[t];return e||(e=[],this.unidentifiedValuesBuffer[t]=e),e}getUnidentifiedGraphBufferSafe(t){let e=this.unidentifiedGraphsBuffer[t];return e||(e=[],this.unidentifiedGraphsBuffer[t]=e),e}getExpandOptions(){return s.EXPAND_OPTIONS[this.activeProcessingMode]}shiftStack(t,e){const n=this.idStack[t+e];if(n&&(this.idStack[t]=n,this.emittedStack[t]=!0,delete this.idStack[t+e]),this.pendingContainerFlushBuffers.length)for(const r of this.pendingContainerFlushBuffers)r.depth>=t+e&&(r.depth-=e,r.keys.splice(t,e));this.unidentifiedValuesBuffer[t+e]&&(this.unidentifiedValuesBuffer[t]=this.unidentifiedValuesBuffer[t+e],delete this.unidentifiedValuesBuffer[t+e])}}e.ParsingContext=s,s.EXPAND_OPTIONS={1:{allowPrefixForcing:!1,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!1},1.1:{allowPrefixForcing:!0,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!0}}},1106:function(t,e,n){"use strict";n(1703),Object.defineProperty(e,"__esModule",{value:!0}),e.Util=void 0;const r=n(157),i=n(5561),o=n(5288),a=n(4384);class s{constructor(t){this.parsingContext=t.parsingContext,this.dataFactory=t.dataFactory||new i.DataFactory,this.rdfFirst=this.dataFactory.namedNode(s.RDF+"first"),this.rdfRest=this.dataFactory.namedNode(s.RDF+"rest"),this.rdfNil=this.dataFactory.namedNode(s.RDF+"nil"),this.rdfType=this.dataFactory.namedNode(s.RDF+"type"),this.rdfJson=this.dataFactory.namedNode(s.RDF+"JSON")}static getContextValue(t,e,n,r){const i=t.getContextRaw()[n];if(!i)return r;const o=i[e];return void 0===o?r:o}static getContextValueContainer(t,e){return s.getContextValue(t,"@container",e,{"@set":!0})}static getContextValueType(t,e){const n=s.getContextValue(t,"@type",e,null);return"@none"===n?null:n}static getContextValueLanguage(t,e){return s.getContextValue(t,"@language",e,t.getContextRaw()["@language"]||null)}static getContextValueDirection(t,e){return s.getContextValue(t,"@direction",e,t.getContextRaw()["@direction"]||null)}static isContextValueReverse(t,e){return!!s.getContextValue(t,"@reverse",e,null)}static getContextValueIndex(t,e){return s.getContextValue(t,"@index",e,t.getContextRaw()["@index"]||null)}static isPropertyReverse(t,e,n){return"@reverse"===n!==s.isContextValueReverse(t,e)}static isValidIri(t){return null!==t&&r.Util.isValidIri(t)}static isPrefixArray(t,e){if(t.length>e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}async validateValueIndexes(t){if(this.parsingContext.validateValueIndexes){const e={};for(const n of t)if(n&&"object"===typeof n){const t=n["@id"],i=n["@index"];if(t&&i){const n=e[t];if(n&&n!==i)throw new r.ErrorCoded(`Conflicting @index value for ${t}`,r.ERROR_CODES.CONFLICTING_INDEXES);e[t]=i}}}}async valueToTerm(t,e,n,i,o){if("@json"===s.getContextValueType(t,e))return[this.dataFactory.literal(this.valueToJsonString(n),this.rdfJson)];const a=typeof n;switch(a){case"object":if(null===n||void 0===n)return[];if(Array.isArray(n))return"@list"in s.getContextValueContainer(t,e)?0===n.length?[this.rdfNil]:this.parsingContext.idStack[i+1]||[]:(await this.validateValueIndexes(n),[]);if(t=await this.getContextSelfOrPropertyScoped(t,e),"@context"in n&&(t=await this.parsingContext.parseContext(n["@context"],(await this.parsingContext.getContext(o,0)).getContextRaw())),n=await this.unaliasKeywords(n,o,i,t),"@value"in n){let a,s,u,l,c;for(e in n){const t=n[e];switch(e){case"@value":a=t;break;case"@language":s=t;break;case"@direction":u=t;break;case"@type":l=t;break;case"@index":c=t;break;default:throw new r.ErrorCoded(`Unknown value entry '${e}' in @value: ${JSON.stringify(n)}`,r.ERROR_CODES.INVALID_VALUE_OBJECT)}}if("@json"===await this.unaliasKeyword(l,o,i,!0,t))return[this.dataFactory.literal(this.valueToJsonString(a),this.rdfJson)];if(null===a)return[];if("object"===typeof a)throw new r.ErrorCoded(`The value of an '@value' can not be an object, got '${JSON.stringify(a)}'`,r.ERROR_CODES.INVALID_VALUE_OBJECT_VALUE);if(this.parsingContext.validateValueIndexes&&c&&"string"!==typeof c)throw new r.ErrorCoded(`The value of an '@index' must be a string, got '${JSON.stringify(c)}'`,r.ERROR_CODES.INVALID_INDEX_VALUE);if(s){if("string"!==typeof a)throw new r.ErrorCoded(`When an '@language' is set, the value of '@value' must be a string, got '${JSON.stringify(a)}'`,r.ERROR_CODES.INVALID_LANGUAGE_TAGGED_VALUE);if(!r.ContextParser.validateLanguage(s,this.parsingContext.strictValues,r.ERROR_CODES.INVALID_LANGUAGE_TAGGED_STRING))return[];(this.parsingContext.normalizeLanguageTags||1===this.parsingContext.activeProcessingMode)&&(s=s.toLowerCase())}if(u){if("string"!==typeof a)throw new Error(`When an '@direction' is set, the value of '@value' must be a string, got '${JSON.stringify(a)}'`);if(!r.ContextParser.validateDirection(u,this.parsingContext.strictValues))return[]}if(s&&u&&this.parsingContext.rdfDirection){if(l)throw new r.ErrorCoded(`Can not have '@language', '@direction' and '@type' in a value: '${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_VALUE_OBJECT);return this.nullableTermToArray(this.createLanguageDirectionLiteral(i,a,s,u))}if(s){if(l)throw new r.ErrorCoded(`Can not have both '@language' and '@type' in a value: '${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_VALUE_OBJECT);return[this.dataFactory.literal(a,s)]}if(u&&this.parsingContext.rdfDirection){if(l)throw new r.ErrorCoded(`Can not have both '@direction' and '@type' in a value: '${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_VALUE_OBJECT);return this.nullableTermToArray(this.createLanguageDirectionLiteral(i,a,s,u))}if(l){if("string"!==typeof l)throw new r.ErrorCoded(`The value of an '@type' must be a string, got '${JSON.stringify(l)}'`,r.ERROR_CODES.INVALID_TYPED_VALUE);const e=this.createVocabOrBaseTerm(t,l);if(!e)throw new r.ErrorCoded(`Invalid '@type' value, got '${JSON.stringify(l)}'`,r.ERROR_CODES.INVALID_TYPED_VALUE);if("NamedNode"!==e.termType)throw new r.ErrorCoded(`Illegal value type (${e.termType}): ${l}`,r.ERROR_CODES.INVALID_TYPED_VALUE);return[this.dataFactory.literal(a,e)]}return await this.valueToTerm(new r.JsonLdContextNormalized({}),e,a,i,o)}if("@set"in n){if(Object.keys(n).length>1)throw new r.ErrorCoded(`Found illegal neighbouring entries next to @set for key: '${e}'`,r.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT);return[]}if("@list"in n){if(Object.keys(n).length>1)throw new r.ErrorCoded(`Found illegal neighbouring entries next to @list for key: '${e}'`,r.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT);const t=n["@list"];return Array.isArray(t)?0===t.length?[this.rdfNil]:this.parsingContext.idStack[i+1]||[]:await this.valueToTerm(await this.parsingContext.getContext(o),e,t,i-1,o.slice(0,-1))}if("@reverse"in n&&"boolean"===typeof n["@reverse"])return[];if("@graph"in s.getContextValueContainer(await this.parsingContext.getContext(o),e)){const t=this.parsingContext.graphContainerTermStack[i+1];return t?Object.values(t):[this.dataFactory.blankNode()]}return"@id"in n?(Object.keys(n).length>1&&(t=await this.parsingContext.getContext(o,0)),"@context"in n&&(t=await this.parsingContext.parseContext(n["@context"],t.getContextRaw())),"@vocab"===n["@type"]?this.nullableTermToArray(this.createVocabOrBaseTerm(t,n["@id"])):this.nullableTermToArray(this.resourceToTerm(t,n["@id"]))):this.parsingContext.emittedStack[i+1]||n&&"object"===typeof n&&0===Object.keys(n).length?this.parsingContext.idStack[i+1]||(this.parsingContext.idStack[i+1]=[this.dataFactory.blankNode()]):[];case"string":return this.nullableTermToArray(this.stringValueToTerm(i,await this.getContextSelfOrPropertyScoped(t,e),e,n,null));case"boolean":return this.nullableTermToArray(this.stringValueToTerm(i,await this.getContextSelfOrPropertyScoped(t,e),e,Boolean(n).toString(),this.dataFactory.namedNode(s.XSD_BOOLEAN)));case"number":return this.nullableTermToArray(this.stringValueToTerm(i,await this.getContextSelfOrPropertyScoped(t,e),e,n,this.dataFactory.namedNode(n%1===0&&n<1e21?s.XSD_INTEGER:s.XSD_DOUBLE)));default:return this.parsingContext.emitError(new Error(`Could not determine the RDF type of a ${a}`)),[]}}async getContextSelfOrPropertyScoped(t,e){const n=t.getContextRaw()[e];return n&&"object"===typeof n&&"@context"in n&&(t=await this.parsingContext.parseContext(n,t.getContextRaw(),!0)),t}nullableTermToArray(t){return t?[t]:[]}predicateToTerm(t,e){const n=t.expandTerm(e,!0,this.parsingContext.getExpandOptions());return n?"_"===n[0]&&":"===n[1]?this.parsingContext.produceGeneralizedRdf?this.dataFactory.blankNode(n.substr(2)):null:s.isValidIri(n)?this.dataFactory.namedNode(n):n&&this.parsingContext.strictValues?(this.parsingContext.emitError(new r.ErrorCoded(`Invalid predicate IRI: ${n}`,r.ERROR_CODES.INVALID_IRI_MAPPING)),null):null:null}resourceToTerm(t,e){if(e.startsWith("_:"))return this.dataFactory.blankNode(e.substr(2));const n=t.expandTerm(e,!1,this.parsingContext.getExpandOptions());if(!s.isValidIri(n)){if(!n||!this.parsingContext.strictValues)return null;this.parsingContext.emitError(new Error(`Invalid resource IRI: ${n}`))}return this.dataFactory.namedNode(n)}createVocabOrBaseTerm(t,e){if(e.startsWith("_:"))return this.dataFactory.blankNode(e.substr(2));const n=this.parsingContext.getExpandOptions();let r=t.expandTerm(e,!0,n);if(r===e&&(r=t.expandTerm(e,!1,n)),!s.isValidIri(r)){if(!r||!this.parsingContext.strictValues||r.startsWith("@"))return null;this.parsingContext.emitError(new Error(`Invalid term IRI: ${r}`))}return this.dataFactory.namedNode(r)}intToString(t,e){if("number"===typeof t){if(Number.isFinite(t)){const n=t%1===0;return!n||e&&e.value===s.XSD_DOUBLE?t.toExponential(15).replace(/(\d)0*e\+?/,"$1E"):Number(t).toString()}return t>0?"INF":"-INF"}return t}stringValueToTerm(t,e,n,r,i){const o=s.getContextValueType(e,n);if(o)if("@id"===o){if(!i)return this.resourceToTerm(e,this.intToString(r,i))}else if("@vocab"===o){if(!i)return this.createVocabOrBaseTerm(e,this.intToString(r,i))}else i=this.dataFactory.namedNode(o);if(!i){const o=s.getContextValueLanguage(e,n),a=s.getContextValueDirection(e,n);return a&&this.parsingContext.rdfDirection?this.createLanguageDirectionLiteral(t,this.intToString(r,i),o,a):this.dataFactory.literal(this.intToString(r,i),o)}return this.dataFactory.literal(this.intToString(r,i),i)}createLanguageDirectionLiteral(t,e,n,r){if("i18n-datatype"===this.parsingContext.rdfDirection)return n||(n=""),this.dataFactory.literal(e,this.dataFactory.namedNode(`https://www.w3.org/ns/i18n#${n}_${r}`));{const i=this.dataFactory.blankNode(),o=this.getDefaultGraph();return this.parsingContext.emitQuad(t,this.dataFactory.quad(i,this.dataFactory.namedNode(s.RDF+"value"),this.dataFactory.literal(e),o)),n&&this.parsingContext.emitQuad(t,this.dataFactory.quad(i,this.dataFactory.namedNode(s.RDF+"language"),this.dataFactory.literal(n),o)),this.parsingContext.emitQuad(t,this.dataFactory.quad(i,this.dataFactory.namedNode(s.RDF+"direction"),this.dataFactory.literal(r),o)),i}}valueToJsonString(t){return a(t)}async unaliasKeyword(t,e,n,i,o){if(Number.isInteger(t))return t;if(!i){const t=this.parsingContext.unaliasedKeywordCacheStack[n];if(t)return t}if(!r.Util.isPotentialKeyword(t)){o=o||await this.parsingContext.getContext(e);let n=o.getContextRaw()[t];n&&"object"===typeof n&&(n=n["@id"]),r.Util.isValidKeyword(n)&&(t=n)}return i?t:this.parsingContext.unaliasedKeywordCacheStack[n]=t}async unaliasKeywordParent(t,e){return await this.unaliasKeyword(e>0&&t[e-1],t,e-1)}async unaliasKeywords(t,e,n,r){const i={};for(const o in t)i[await this.unaliasKeyword(o,e,n+1,!0,r)]=t[o];return i}isLiteral(t){for(let e=t;e>=0;e--)if(this.parsingContext.literalStack[e]||this.parsingContext.jsonLiteralStack[e])return!0;return!1}async getDepthOffsetGraph(t,e){for(let n=t-1;n>0;n--)if("@graph"===await this.unaliasKeyword(e[n],e,n)){const r=(await o.EntryHandlerContainer.getContainerHandler(this.parsingContext,e,n)).containers;return o.EntryHandlerContainer.isComplexGraphContainer(r)?-1:t-n-1}return-1}validateReverseSubject(t){if("Literal"===t.termType)throw new r.ErrorCoded(`Found illegal literal in subject position: ${t.value}`,r.ERROR_CODES.INVALID_REVERSE_PROPERTY_VALUE)}getDefaultGraph(){return this.parsingContext.defaultGraph||this.dataFactory.defaultGraph()}async getGraphContainerValue(t,e){let n=this.getDefaultGraph();const{containers:r,depth:i}=await o.EntryHandlerContainer.getContainerHandler(this.parsingContext,t,e);if("@graph"in r){const e=o.EntryHandlerContainer.getContainerGraphIndex(r,i,t),a=this.parsingContext.graphContainerTermStack[i];if(n=a?a[e]:null,!n){let o=null;if("@id"in r){const e=await this.getContainerKey(t[i],t,i);null!==e&&(o=await this.resourceToTerm(await this.parsingContext.getContext(t),e))}o||(o=this.dataFactory.blankNode()),this.parsingContext.graphContainerTermStack[i]||(this.parsingContext.graphContainerTermStack[i]={}),n=this.parsingContext.graphContainerTermStack[i][e]=o}}return n}async getPropertiesDepth(t,e){let n=e;for(let r=e-1;r>0;r--)if("number"!==typeof t[r]){const e=await this.unaliasKeyword(t[r],t,r);if("@reverse"===e)return r;if("@nest"!==e)return n;n=r}return n}async getContainerKey(t,e,n){const r=await this.unaliasKeyword(t,e,n);return"@none"===r?null:r}}e.Util=s,s.XSD="http://www.w3.org/2001/XMLSchema#",s.XSD_BOOLEAN=s.XSD+"boolean",s.XSD_INTEGER=s.XSD+"integer",s.XSD_DOUBLE=s.XSD+"double",s.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#"},7277:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerIdentifier=void 0;class n{canCombineWithGraph(){return!0}async handle(t,e,n,r,i,o){let a;if(e.emittedStack[o+1]&&e.idStack[o+1])a=e.idStack[o+1][0];else{const t=await n.getContainerKey(r[o],r,o),i=null!==t?await n.resourceToTerm(await e.getContext(r),r[o]):n.dataFactory.blankNode();if(!i)return void(e.emittedStack[o]=!1);a=i,e.idStack[o+1]=[a]}let s=e.idStack[o];s||(s=e.idStack[o]=[]),s.some((t=>t.equals(a)))||s.push(a),await e.handlePendingContainerFlushBuffers()||(e.emittedStack[o]=!1)}}e.ContainerHandlerIdentifier=n},4405:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerIndex=void 0;const r=n(157),i=n(6016),o=n(1106);class a{canCombineWithGraph(){return!0}async handle(t,e,n,a,s,u){if(!Array.isArray(s)){const l="@graph"in t,c=await e.getContext(a),f=a[u-1],h=o.Util.getContextValueIndex(c,f);if(h){if(r.Util.isPotentialKeyword(h))throw new r.ErrorCoded(`Keywords can not be used as @index value, got: ${h}`,r.ERROR_CODES.INVALID_TERM_DEFINITION);if("string"!==typeof h)throw new r.ErrorCoded(`@index values must be strings, got: ${h}`,r.ERROR_CODES.INVALID_TERM_DEFINITION);if("object"!==typeof s){if("@id"!==o.Util.getContextValueType(c,f))throw new r.ErrorCoded(`Property-based index containers require nodes as values or strings with @type: @id, but got: ${s}`,r.ERROR_CODES.INVALID_VALUE_OBJECT);const t=n.resourceToTerm(c,s);t&&(e.idStack[u+1]=[t])}const t=n.createVocabOrBaseTerm(c,h);if(t){const r=await n.valueToTerm(c,h,await n.getContainerKey(a[u],a,u),u,a);if(l){const i=await n.getGraphContainerValue(a,u+1);for(const o of r)e.emitQuad(u,n.dataFactory.quad(i,t,o,n.getDefaultGraph()))}else for(const o of r)await i.EntryHandlerPredicate.handlePredicateObject(e,n,a,u+1,t,o,!1)}}const d=l?2:1;await e.newOnValueJob(a.slice(0,a.length-d),s,u-d,!0),await e.handlePendingContainerFlushBuffers()}e.emittedStack[u]=!1}}e.ContainerHandlerIndex=a},190:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerLanguage=void 0;const r=n(157);class i{canCombineWithGraph(){return!1}async handle(t,e,n,i,o,a){const s=await n.getContainerKey(i[a],i,a);if(Array.isArray(o))o=o.map((t=>({"@value":t,"@language":s})));else{if("string"!==typeof o)throw new r.ErrorCoded(`Got invalid language map value, got '${JSON.stringify(o)}', but expected string`,r.ERROR_CODES.INVALID_LANGUAGE_MAP_VALUE);o={"@value":o,"@language":s}}await e.newOnValueJob(i.slice(0,i.length-1),o,a-1,!0),e.emittedStack[a]=!1}}e.ContainerHandlerLanguage=i},8864:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerType=void 0;const r=n(6016),i=n(1106);class o{canCombineWithGraph(){return!1}async handle(t,e,n,o,a,s){if(!Array.isArray(a)){if("string"===typeof a){const t=await e.getContext(o),r=i.Util.getContextValueType(t,o[s-1]),u="@vocab"===r?await n.createVocabOrBaseTerm(t,a):await n.resourceToTerm(t,a);if(u){const t={"@id":"NamedNode"===u.termType?u.value:a};await e.newOnValueJob(o.slice(0,o.length-1),t,s-1,!0),e.idStack[s+1]=[u]}}else{const t=!!e.idStack[s+1];t||delete e.idStack[s],await e.newOnValueJob(o.slice(0,o.length-1),a,s-1,!0),t||(e.idStack[s+1]=e.idStack[s])}const t=await n.getContainerKey(o[s],o,s),u=null!==t?n.createVocabOrBaseTerm(await e.getContext(o),t):null;u&&await r.EntryHandlerPredicate.handlePredicateObject(e,n,o,s+1,n.rdfType,u,!1),await e.handlePendingContainerFlushBuffers()}e.emittedStack[s]=!1}}e.ContainerHandlerType=o},4917:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerArrayValue=void 0;const r=n(1106);class i{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,n,r,i){return this.test(t,e,null,n,r)}async test(t,e,n,r,i){return"number"===typeof r[i]}async handle(t,e,n,i,o,a){let s=await e.unaliasKeywordParent(i,a);if("@list"===s){let n=null,r=0;for(let t=a-2;t>0;t--){const e=i[t];if("string"===typeof e||"number"===typeof e){r=t,n=e;break}}if(null!==n){const s=await e.valueToTerm(await t.getContext(i),n,o,a,i);for(const n of s)await this.handleListElement(t,e,n,o,a,i.slice(0,r),r);0===s.length&&await this.handleListElement(t,e,null,o,a,i.slice(0,r),r)}}else if("@set"===s)await t.newOnValueJob(i.slice(0,-2),o,a-2,!1);else if(void 0!==s&&"@type"!==s){for(let t=a-1;t>0;t--)if("number"!==typeof i[t]){s=await e.unaliasKeyword(i[t],i,t);break}const n=await t.getContext(i.slice(0,-1));if("@list"in r.Util.getContextValueContainer(n,s)){t.emittedStack[a+1]=!0;const n=await e.valueToTerm(await t.getContext(i),s,o,a,i);for(const r of n)await this.handleListElement(t,e,r,o,a,i.slice(0,-1),a-1);0===n.length&&await this.handleListElement(t,e,null,o,a,i.slice(0,-1),a-1)}else t.shiftStack(a,1),await t.newOnValueJob(i.slice(0,-1),o,a-1,!1),t.contextTree.removeContext(i.slice(0,-1))}}async handleListElement(t,e,n,r,i,o,a){let s=t.listPointerStack[i];if(null!==r&&null!==(await e.unaliasKeywords(r,o,i))["@value"]){if(s&&s.value){const n=e.dataFactory.blankNode();t.emitQuad(i,e.dataFactory.quad(s.value,e.rdfRest,n,e.getDefaultGraph())),s.value=n}else{const t=e.dataFactory.blankNode();s={value:t,listRootDepth:a,listId:t}}n&&t.emitQuad(i,e.dataFactory.quad(s.value,e.rdfFirst,n,e.getDefaultGraph()))}else s||(s={listRootDepth:a,listId:e.rdfNil});t.listPointerStack[i]=s}}e.EntryHandlerArrayValue=i},5288:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerContainer=void 0;const r=n(7277),i=n(4405),o=n(190),a=n(8864),s=n(1106);class u{static isSimpleGraphContainer(t){return"@graph"in t&&("@set"in t&&2===Object.keys(t).length||1===Object.keys(t).length)}static isComplexGraphContainer(t){return"@graph"in t&&("@set"in t&&Object.keys(t).length>2||!("@set"in t)&&Object.keys(t).length>1)}static getContainerGraphIndex(t,e,n){let r=u.isSimpleGraphContainer(t),i="";for(let o=e;o<n.length;o++)r&&"number"!==typeof n[o]||(i+=":"+n[o]),r||"number"===typeof n[o]||(r=!0);return i}static async getContainerHandler(t,e,n){const r={containers:{"@set":!0},depth:n,fallback:!0};let i=!1;const o=await t.getContext(e,2);for(let a=n-1;a>=0;a--)if("number"!==typeof e[a]){const t=s.Util.getContextValue(o,"@container",e[a],!1);if(t&&u.isSimpleGraphContainer(t))return{containers:t,depth:a+1,fallback:!1};const n=s.Util.getContextValue(o,"@container",e[a-1],!1);if(n){const t="@graph"in n;for(const e in u.CONTAINER_HANDLERS)if(n[e])return t?u.CONTAINER_HANDLERS[e].canCombineWithGraph()?{containers:n,depth:a,fallback:!1}:r:i?r:{containers:n,depth:a,fallback:!1};return r}if(i)return r;i=!0}return r}static async isBufferableContainerHandler(t,e,n){const r=await u.getContainerHandler(t,e,n);return!r.fallback&&!("@graph"in r.containers)}isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,n,r,i){return!!await this.test(t,e,null,n,r)}async test(t,e,n,r,i){const o=s.Util.getContextValueContainer(await t.getContext(r,2),r[i-1]);for(const a in u.CONTAINER_HANDLERS)if(o[a])return{containers:o,handler:u.CONTAINER_HANDLERS[a]};return null}async handle(t,e,n,r,i,o,a){return a.handler.handle(a.containers,t,e,r,i,o)}}e.EntryHandlerContainer=u,u.CONTAINER_HANDLERS={"@id":new r.ContainerHandlerIdentifier,"@index":new i.ContainerHandlerIndex,"@language":new o.ContainerHandlerLanguage,"@type":new a.ContainerHandlerType}},9369:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerInvalidFallback=void 0;class n{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,n,r,i){return!1}async test(t,e,n,r,i){return!0}async handle(t,e,n,r,i,o){t.emittedStack[o]=!1}}e.EntryHandlerInvalidFallback=n},6016:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerPredicate=void 0;const r=n(157),i=n(1106);class o{static async handlePredicateObject(t,e,n,r,i,o,a){const s=await e.getPropertiesDepth(n,r),u=await e.getDepthOffsetGraph(r,n),l=r-u,c=t.idStack[s];if(c)for(const f of c){const c=u>=0;if(c){const n=t.idStack[l-1];if(n)for(const s of n)a?(e.validateReverseSubject(o),t.emitQuad(r,e.dataFactory.quad(o,i,f,s))):t.emitQuad(r,e.dataFactory.quad(f,i,o,s));else a?(e.validateReverseSubject(o),t.getUnidentifiedGraphBufferSafe(l-1).push({subject:o,predicate:i,object:f})):t.getUnidentifiedGraphBufferSafe(l-1).push({subject:f,predicate:i,object:o})}else{const u=await e.getGraphContainerValue(n,s);a?(e.validateReverseSubject(o),t.emitQuad(r,e.dataFactory.quad(o,i,f,u))):t.emitQuad(r,e.dataFactory.quad(f,i,o,u))}}else a&&e.validateReverseSubject(o),t.getUnidentifiedValueBufferSafe(s).push({predicate:i,object:o,reverse:a})}isPropertyHandler(){return!0}isStackProcessor(){return!0}async validate(t,e,n,r,o){const a=n[r];if(a){const o=await t.getContext(n);if(!t.jsonLiteralStack[r]&&await e.predicateToTerm(o,n[r]))return"@json"===i.Util.getContextValueType(o,a)&&(t.jsonLiteralStack[r+1]=!0),!0}return!1}async test(t,e,n,r,i){return r[i]}async handle(t,e,n,a,s,u,l){const c=a[u],f=await t.getContext(a),h=await e.predicateToTerm(f,n);if(h){const l=await e.valueToTerm(f,n,s,u,a);if(l.length)for(let d of l){const l=i.Util.isPropertyReverse(f,c,await e.unaliasKeywordParent(a,u));if(s){const o="@list"in i.Util.getContextValueContainer(f,n);if(o||s["@list"]){if((o&&!Array.isArray(s)&&!s["@list"]||s["@list"]&&!Array.isArray(s["@list"]))&&d!==e.rdfNil){const n=e.dataFactory.blankNode();t.emitQuad(u,e.dataFactory.quad(n,e.rdfRest,e.rdfNil,e.getDefaultGraph())),t.emitQuad(u,e.dataFactory.quad(n,e.rdfFirst,d,e.getDefaultGraph())),d=n}if(l&&!t.allowSubjectList)throw new r.ErrorCoded(`Found illegal list value in subject position at ${n}`,r.ERROR_CODES.INVALID_REVERSE_PROPERTY_VALUE)}}await o.handlePredicateObject(t,e,a,u,h,d,l)}}}}e.EntryHandlerPredicate=o},522:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeyword=void 0;class n{constructor(t){this.keyword=t}isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,n,r,i){return!1}async test(t,e,n,r,i){return n===this.keyword}}e.EntryHandlerKeyword=n},4422:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordContext=void 0;const r=n(157),i=n(522);class o extends i.EntryHandlerKeyword{constructor(){super("@context")}isStackProcessor(){return!1}async handle(t,e,n,i,o,a){t.streamingProfile&&(t.processingStack[a]||t.processingType[a]||void 0!==t.idStack[a])&&t.emitError(new r.ErrorCoded("Found an out-of-order context, while streaming is enabled.(disable `streamingProfile`)",r.ERROR_CODES.INVALID_STREAMING_KEY_ORDER));const s=t.getContext(i),u=t.parseContext(o,(await s).getContextRaw());t.contextTree.setContext(i.slice(0,-1),u),t.emitContext(o),await t.validateContext(await u)}}e.EntryHandlerKeywordContext=o},5323:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordGraph=void 0;const r=n(522);class i extends r.EntryHandlerKeyword{constructor(){super("@graph")}async handle(t,e,n,r,i,o){t.graphStack[o+1]=!0}}e.EntryHandlerKeywordGraph=i},640:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordId=void 0;const r=n(157),i=n(522);class o extends i.EntryHandlerKeyword{constructor(){super("@id")}isStackProcessor(){return!1}async handle(t,e,n,i,o,a){"string"!==typeof o&&t.emitError(new r.ErrorCoded(`Found illegal @id '${o}'`,r.ERROR_CODES.INVALID_ID_VALUE));const s=await e.getPropertiesDepth(i,a);void 0!==t.idStack[s]&&(t.idStack[s][0].listHead?t.emitError(new r.ErrorCoded(`Found illegal neighbouring entries next to @list for key: '${i[a-1]}'`,r.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT)):t.emitError(new r.ErrorCoded(`Found duplicate @ids '${t.idStack[s][0].value}' and '${o}'`,r.ERROR_CODES.COLLIDING_KEYWORDS))),t.idStack[s]=e.nullableTermToArray(await e.resourceToTerm(await t.getContext(i),o))}}e.EntryHandlerKeywordId=o},2822:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordIncluded=void 0;const r=n(157),i=n(522);class o extends i.EntryHandlerKeyword{constructor(){super("@included")}async handle(t,e,n,i,o,a){"object"!==typeof o&&t.emitError(new r.ErrorCoded(`Found illegal @included '${o}'`,r.ERROR_CODES.INVALID_INCLUDED_VALUE));const s=await e.unaliasKeywords(o,i,a,await t.getContext(i));"@value"in s&&t.emitError(new r.ErrorCoded(`Found an illegal @included @value node '${JSON.stringify(o)}'`,r.ERROR_CODES.INVALID_INCLUDED_VALUE)),"@list"in s&&t.emitError(new r.ErrorCoded(`Found an illegal @included @list node '${JSON.stringify(o)}'`,r.ERROR_CODES.INVALID_INCLUDED_VALUE)),t.emittedStack[a]=!1}}e.EntryHandlerKeywordIncluded=o},5116:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordNest=void 0;const r=n(157),i=n(522);class o extends i.EntryHandlerKeyword{constructor(){super("@nest")}async handle(t,e,n,i,o,a){"object"!==typeof o&&t.emitError(new r.ErrorCoded(`Found invalid @nest entry for '${n}': '${o}'`,r.ERROR_CODES.INVALID_NEST_VALUE)),"@value"in await e.unaliasKeywords(o,i,a,await t.getContext(i))&&t.emitError(new r.ErrorCoded(`Found an invalid @value node for '${n}'`,r.ERROR_CODES.INVALID_NEST_VALUE)),t.emittedStack[a]=!1}}e.EntryHandlerKeywordNest=o},1867:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordType=void 0;const r=n(157),i=n(1106),o=n(6016),a=n(522);class s extends a.EntryHandlerKeyword{constructor(){super("@type")}isStackProcessor(){return!1}async handle(t,e,n,a,s,u){const l=a[u],c=await t.getContext(a),f=e.rdfType,h=i.Util.isPropertyReverse(c,l,await e.unaliasKeywordParent(a,u)),d=Array.isArray(s)?s:[s];for(const i of d){"string"!==typeof i&&t.emitError(new r.ErrorCoded(`Found illegal @type '${i}'`,r.ERROR_CODES.INVALID_TYPE_VALUE));const n=e.createVocabOrBaseTerm(c,i);n&&await o.EntryHandlerPredicate.handlePredicateObject(t,e,a,u,f,n,h)}let p=Promise.resolve(c),y=!1;for(const r of d.sort()){const e=i.Util.getContextValue(c,"@context",r,null);e&&(y=!0,p=p.then((n=>t.parseContext(e,n.getContextRaw()))))}!t.streamingProfile||!y&&t.streamingProfileAllowOutOfOrderPlainType||!t.processingStack[u]&&!t.idStack[u]||t.emitError(new r.ErrorCoded("Found an out-of-order type-scoped context, while streaming is enabled.(disable `streamingProfile`)",r.ERROR_CODES.INVALID_STREAMING_KEY_ORDER)),y&&(p=p.then((t=>("@propagate"in t.getContextRaw()||(t.getContextRaw()["@propagate"]=!1),!1===t.getContextRaw()["@propagate"]&&(t.getContextRaw()["@__propagateFallback"]=c.getContextRaw()),t))),t.contextTree.setContext(a.slice(0,a.length-1),p)),t.processingType[u]=!0}}e.EntryHandlerKeywordType=s},4133:function(t,e,n){"use strict";n(1703),Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordUnknownFallback=void 0;const r=n(157);class i{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,n,i,o){const a=await e.unaliasKeyword(n[i],n,i);return!!r.Util.isPotentialKeyword(a)&&!(!o&&"@list"===a)}async test(t,e,n,i,o){return r.Util.isPotentialKeyword(n)}async handle(t,e,n,o,a,s){const u=i.VALID_KEYWORDS_TYPES[n];void 0!==u?u&&typeof a!==u.type&&t.emitError(new r.ErrorCoded(`Invalid value type for '${n}' with value '${a}'`,u.errorCode)):t.strictValues&&t.emitError(new Error(`Unknown keyword '${n}' with value '${a}'`)),t.emittedStack[s]=!1}}e.EntryHandlerKeywordUnknownFallback=i,i.VALID_KEYWORDS_TYPES={"@index":{type:"string",errorCode:r.ERROR_CODES.INVALID_INDEX_VALUE},"@list":null,"@reverse":{type:"object",errorCode:r.ERROR_CODES.INVALID_REVERSE_VALUE},"@set":null,"@value":null}},6453:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordValue=void 0;const r=n(522);class i extends r.EntryHandlerKeyword{constructor(){super("@value")}async validate(t,e,n,r,i){const o=n[r];return o&&!t.literalStack[r]&&await this.test(t,e,o,n,r)&&(t.literalStack[r]=!0),super.validate(t,e,n,r,i)}async test(t,e,n,r,i){return"@value"===await e.unaliasKeyword(r[i],r.slice(0,r.length-1),i-1,!0)}async handle(t,e,n,r,i,o){t.literalStack[o]=!0,delete t.unidentifiedValuesBuffer[o],delete t.unidentifiedGraphsBuffer[o],t.emittedStack[o]=!1}}e.EntryHandlerKeywordValue=i},4229:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),i(n(6631),e),i(n(1721),e)},6631:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.JsonLdSerializer=void 0;const r=n(157),i=n(6639),o=n(2687),a=n(1721);class s extends i.Transform{constructor(t={}){super({objectMode:!0}),this.indentation=0,this.options=t,this.options.baseIRI&&!this.options.context&&(this.options.context={"@base":this.options.baseIRI}),this.options.context?(this.originalContext=this.options.context,this.context=(new r.ContextParser).parse(this.options.context,{baseIRI:this.options.baseIRI})):this.context=Promise.resolve(new r.JsonLdContextNormalized({}))}import(t){const e=new i.PassThrough({objectMode:!0});t.on("error",(t=>n.emit("error",t))),t.on("data",(t=>e.push(t))),t.on("end",(()=>e.push(null)));const n=e.pipe(new s(this.options));return n}_transform(t,e,n){this.context.then((e=>{this.transformQuad(t,e),n()})).catch(n)}async list(t){const e=await this.context;return{"@list":t.map((t=>a.Util.termToValue(t,e,this.options)))}}_flush(t){return this.opened||this.pushDocumentStart(),this.lastPredicate&&this.endPredicate(),this.lastSubject&&this.endSubject(),this.lastGraph&&"DefaultGraph"!==this.lastGraph.termType&&this.endGraph(),this.endDocument(),t(null,null)}transformQuad(t,e){this.opened||this.pushDocumentStart();const n=this.lastGraph&&"DefaultGraph"!==this.lastGraph.termType&&this.lastGraph.equals(t.subject);if(!n&&(!this.lastGraph||!t.graph.equals(this.lastGraph))){let n="DefaultGraph"!==t.graph.termType&&this.lastSubject&&this.lastSubject.equals(t.graph);this.lastGraph&&("DefaultGraph"!==this.lastGraph.termType?(this.endPredicate(),this.endSubject(),this.endGraph(!0),n=!1):n?(this.endPredicate(!0),this.lastSubject=null):(this.endPredicate(),this.endSubject(!0))),"DefaultGraph"!==t.graph.termType&&(n||this.pushId(t.graph,e),this.pushSeparator(this.options.space?o.SeparatorType.GRAPH_FIELD_NONCOMPACT:o.SeparatorType.GRAPH_FIELD_COMPACT),this.indentation++),this.lastGraph=t.graph}this.lastSubject&&t.subject.equals(this.lastSubject)||(n?(this.endPredicate(),this.endSubject(),this.indentation--,this.pushSeparator(o.SeparatorType.ARRAY_END_COMMA),this.lastGraph=t.graph):(this.lastSubject&&(this.endPredicate(),this.endSubject(!0)),this.pushId(t.subject,e)),this.lastSubject=t.subject),this.lastPredicate&&t.predicate.equals(this.lastPredicate)||(this.lastPredicate&&this.endPredicate(!0),this.pushPredicate(t.predicate,e)),this.pushObject(t.object,e)}pushDocumentStart(){this.opened=!0,this.originalContext&&!this.options.excludeContext?(this.pushSeparator(o.SeparatorType.OBJECT_START),this.indentation++,this.pushSeparator(o.SeparatorType.CONTEXT_FIELD),this.pushIndented(JSON.stringify(this.originalContext,null,this.options.space)+","),this.pushSeparator(this.options.space?o.SeparatorType.GRAPH_FIELD_NONCOMPACT:o.SeparatorType.GRAPH_FIELD_COMPACT),this.indentation++):(this.pushSeparator(o.SeparatorType.ARRAY_START),this.indentation++)}pushId(t,e){const n="BlankNode"===t.termType?"_:"+t.value:e.compactIri(t.value,!1);this.pushSeparator(o.SeparatorType.OBJECT_START),this.indentation++,this.pushIndented(this.options.space?`"@id": "${n}",`:`"@id":"${n}",`)}pushPredicate(t,e){let n=t.value;this.options.useRdfType||n!==a.Util.RDF_TYPE||(n="@type",this.objectOptions=Object.assign(Object.assign({},this.options),{compactIds:!0,vocab:!0}));const r=e.compactIri(n,!0);this.pushIndented(this.options.space?`"${r}": [`:`"${r}":[`),this.indentation++,this.lastPredicate=t}pushObject(t,e){let n;this.hadObjectForPredicate?this.pushSeparator(o.SeparatorType.COMMA):this.hadObjectForPredicate=!0;try{n=t["@list"]?t:a.Util.termToValue(t,e,this.objectOptions||this.options)}catch(r){return this.emit("error",r)}this.pushIndented(JSON.stringify(n,null,this.options.space))}endDocument(){this.opened=!1,this.originalContext&&!this.options.excludeContext?(this.indentation--,this.pushSeparator(o.SeparatorType.ARRAY_END),this.indentation--,this.pushSeparator(o.SeparatorType.OBJECT_END)):(this.indentation--,this.pushSeparator(o.SeparatorType.ARRAY_END))}endPredicate(t){this.indentation--,this.pushSeparator(t?o.SeparatorType.ARRAY_END_COMMA:o.SeparatorType.ARRAY_END),this.hadObjectForPredicate=!1,this.objectOptions=null,this.lastPredicate=null}endSubject(t){this.indentation--,this.pushSeparator(t?o.SeparatorType.OBJECT_END_COMMA:o.SeparatorType.OBJECT_END),this.lastSubject=null}endGraph(t){this.indentation--,this.pushSeparator(o.SeparatorType.ARRAY_END),this.indentation--,this.pushSeparator(t?o.SeparatorType.OBJECT_END_COMMA:o.SeparatorType.OBJECT_END),this.lastGraph=null}pushSeparator(t){this.pushIndented(t.label)}pushIndented(t){const e=this.getIndentPrefix(),n=t.split("\n").map((t=>e+t)).join("\n");this.push(n),this.options.space&&this.push("\n")}getIndentPrefix(){return this.options.space?this.options.space.repeat(this.indentation):""}}e.JsonLdSerializer=s},2687:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SeparatorType=void 0;class n{constructor(t){this.label=t}}e.SeparatorType=n,n.COMMA=new n(","),n.OBJECT_START=new n("{"),n.OBJECT_END=new n("}"),n.OBJECT_END_COMMA=new n("},"),n.ARRAY_START=new n("["),n.ARRAY_END=new n("]"),n.ARRAY_END_COMMA=new n("],"),n.GRAPH_FIELD_NONCOMPACT=new n('"@graph": ['),n.GRAPH_FIELD_COMPACT=new n('"@graph":['),n.CONTEXT_FIELD=new n('"@context":')},1721:function(t,e,n){"use strict";n(1703),Object.defineProperty(e,"__esModule",{value:!0}),e.Util=void 0;const r=n(157);class i{static termToValue(t,e,n={compactIds:!1,useNativeTypes:!1}){switch(t.termType){case"NamedNode":const a=e.compactIri(t.value,n.vocab);return n.compactIds?a:{"@id":a};case"DefaultGraph":return n.compactIds?t.value:{"@id":t.value};case"BlankNode":const s=`_:${t.value}`;return n.compactIds?s:{"@id":s};case"Literal":if(t.datatype.value===i.RDF_JSON){let e;try{e=JSON.parse(t.value)}catch(o){throw new r.ErrorCoded("Invalid JSON literal: "+o.message,r.ERROR_CODES.INVALID_JSON_LITERAL)}return{"@value":e,"@type":"@json"}}if("i18n-datatype"===n.rdfDirection&&t.datatype.value.startsWith(i.I18N)){const[e,n]=t.datatype.value.substr(i.I18N.length,t.datatype.value.length).split("_");return Object.assign(Object.assign({"@value":t.value},e?{"@language":e}:{}),n?{"@direction":n}:{})}const u=t.datatype.value===i.XSD_STRING,l={"@value":!u&&n.useNativeTypes?i.stringToNativeType(t.value,t.datatype.value):t.value};return t.language?Object.assign(Object.assign({},l),{"@language":t.language}):u||"string"!==typeof l["@value"]?l:Object.assign(Object.assign({},l),{"@type":t.datatype.value})}}static stringToNativeType(t,e){if(e.startsWith(i.XSD)){const n=e.substr(i.XSD.length);switch(n){case"boolean":if("true"===t)return!0;if("false"===t)return!1;throw new Error(`Invalid xsd:boolean value '${t}'`);case"integer":case"number":case"int":case"byte":case"long":const e=parseInt(t,10);if(isNaN(e))throw new Error(`Invalid xsd:integer value '${t}'`);return e;case"float":case"double":const n=parseFloat(t);if(isNaN(n))throw new Error(`Invalid xsd:float value '${t}'`);return n}}return t}}e.Util=i,i.XSD="http://www.w3.org/2001/XMLSchema#",i.XSD_STRING=i.XSD+"string",i.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",i.RDF_TYPE=i.RDF+"type",i.RDF_JSON=i.RDF+"JSON",i.I18N="https://www.w3.org/ns/i18n#"},8296:function(t,e,n){var r=n(9914)["Buffer"];n(1703);var i={},o=i.LEFT_BRACE=1,a=i.RIGHT_BRACE=2,s=i.LEFT_BRACKET=3,u=i.RIGHT_BRACKET=4,l=i.COLON=5,c=i.COMMA=6,f=i.TRUE=7,h=i.FALSE=8,d=i.NULL=9,p=i.STRING=10,y=i.NUMBER=11,b=i.START=17,g=i.STOP=18,v=i.TRUE1=33,m=i.TRUE2=34,w=i.TRUE3=35,_=i.FALSE1=49,E=i.FALSE2=50,S=i.FALSE3=51,x=i.FALSE4=52,O=i.NULL1=65,C=i.NULL2=66,R=i.NULL3=67,I=i.NUMBER1=81,D=i.NUMBER3=83,T=i.STRING1=97,A=i.STRING2=98,N=i.STRING3=99,P=i.STRING4=100,j=i.STRING5=101,L=i.STRING6=102,k=i.VALUE=113,M=i.KEY=114,U=i.OBJECT=129,V=i.ARRAY=130,F="\\".charCodeAt(0),B="/".charCodeAt(0),$="\b".charCodeAt(0),G="\f".charCodeAt(0),J="\n".charCodeAt(0),K="\r".charCodeAt(0),q="\t".charCodeAt(0),H=65536;function W(){this.tState=b,this.value=void 0,this.string=void 0,this.stringBuffer=r.alloc?r.alloc(H):new r(H),this.stringBufferOffset=0,this.unicode=void 0,this.highSurrogate=void 0,this.key=void 0,this.mode=void 0,this.stack=[],this.state=k,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new r(2),3:new r(3),4:new r(4)},this.offset=-1}W.toknam=function(t){for(var e=Object.keys(i),n=0,r=e.length;n<r;n++){var o=e[n];if(i[o]===t)return o}return t&&"0x"+t.toString(16)};var z=W.prototype;z.onError=function(t){throw t},z.charError=function(t,e){this.tState=g,this.onError(new Error("Unexpected "+JSON.stringify(String.fromCharCode(t[e]))+" at position "+e+" in state "+W.toknam(this.tState)))},z.appendStringChar=function(t){this.stringBufferOffset>=H&&(this.string+=this.stringBuffer.toString("utf8"),this.stringBufferOffset=0),this.stringBuffer[this.stringBufferOffset++]=t},z.appendStringBuf=function(t,e,n){var r=t.length;"number"===typeof e&&(r="number"===typeof n?n<0?t.length-e+n:n-e:t.length-e),r<0&&(r=0),this.stringBufferOffset+r>H&&(this.string+=this.stringBuffer.toString("utf8",0,this.stringBufferOffset),this.stringBufferOffset=0),t.copy(this.stringBuffer,this.stringBufferOffset,e,n),this.stringBufferOffset+=r},z.write=function(t){var e;"string"===typeof t&&(t=new r(t));for(var n=0,i=t.length;n<i;n++)if(this.tState===b){if(e=t[n],this.offset++,123===e)this.onToken(o,"{");else if(125===e)this.onToken(a,"}");else if(91===e)this.onToken(s,"[");else if(93===e)this.onToken(u,"]");else if(58===e)this.onToken(l,":");else if(44===e)this.onToken(c,",");else if(116===e)this.tState=v;else if(102===e)this.tState=_;else if(110===e)this.tState=O;else if(34===e)this.string="",this.stringBufferOffset=0,this.tState=T;else if(45===e)this.string="-",this.tState=I;else if(e>=48&&e<64)this.string=String.fromCharCode(e),this.tState=D;else if(32!==e&&9!==e&&10!==e&&13!==e)return this.charError(t,n)}else if(this.tState===T)if(e=t[n],this.bytes_remaining>0){for(var g=0;g<this.bytes_remaining;g++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+g]=t[g];this.appendStringBuf(this.temp_buffs[this.bytes_in_sequence]),this.bytes_in_sequence=this.bytes_remaining=0,n=n+g-1}else if(0===this.bytes_remaining&&e>=128){if(e<=193||e>244)return this.onError(new Error("Invalid UTF-8 character at position "+n+" in state "+W.toknam(this.tState)));if(e>=194&&e<=223&&(this.bytes_in_sequence=2),e>=224&&e<=239&&(this.bytes_in_sequence=3),e>=240&&e<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+n>t.length){for(var k=0;k<=t.length-1-n;k++)this.temp_buffs[this.bytes_in_sequence][k]=t[n+k];this.bytes_remaining=n+this.bytes_in_sequence-t.length,n=t.length-1}else this.appendStringBuf(t,n,n+this.bytes_in_sequence),n=n+this.bytes_in_sequence-1}else if(34===e)this.tState=b,this.string+=this.stringBuffer.toString("utf8",0,this.stringBufferOffset),this.stringBufferOffset=0,this.onToken(p,this.string),this.offset+=r.byteLength(this.string,"utf8")+1,this.string=void 0;else if(92===e)this.tState=A;else{if(!(e>=32))return this.charError(t,n);this.appendStringChar(e)}else if(this.tState===A)if(e=t[n],34===e)this.appendStringChar(e),this.tState=T;else if(92===e)this.appendStringChar(F),this.tState=T;else if(47===e)this.appendStringChar(B),this.tState=T;else if(98===e)this.appendStringChar($),this.tState=T;else if(102===e)this.appendStringChar(G),this.tState=T;else if(110===e)this.appendStringChar(J),this.tState=T;else if(114===e)this.appendStringChar(K),this.tState=T;else if(116===e)this.appendStringChar(q),this.tState=T;else{if(117!==e)return this.charError(t,n);this.unicode="",this.tState=N}else if(this.tState===N||this.tState===P||this.tState===j||this.tState===L){if(e=t[n],!(e>=48&&e<64||e>64&&e<=70||e>96&&e<=102))return this.charError(t,n);if(this.unicode+=String.fromCharCode(e),this.tState++===L){var M=parseInt(this.unicode,16);this.unicode=void 0,void 0!==this.highSurrogate&&M>=56320&&M<57344?(this.appendStringBuf(new r(String.fromCharCode(this.highSurrogate,M))),this.highSurrogate=void 0):void 0===this.highSurrogate&&M>=55296&&M<56320?this.highSurrogate=M:(void 0!==this.highSurrogate&&(this.appendStringBuf(new r(String.fromCharCode(this.highSurrogate))),this.highSurrogate=void 0),this.appendStringBuf(new r(String.fromCharCode(M)))),this.tState=T}}else if(this.tState===I||this.tState===D)switch(e=t[n],e){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 46:case 101:case 69:case 43:case 45:this.string+=String.fromCharCode(e),this.tState=D;break;default:this.tState=b;var U=Number(this.string);if(isNaN(U))return this.charError(t,n);this.string.match(/[0-9]+/)==this.string&&U.toString()!=this.string?this.onToken(p,this.string):this.onToken(y,U),this.offset+=this.string.length-1,this.string=void 0,n--;break}else if(this.tState===v){if(114!==t[n])return this.charError(t,n);this.tState=m}else if(this.tState===m){if(117!==t[n])return this.charError(t,n);this.tState=w}else if(this.tState===w){if(101!==t[n])return this.charError(t,n);this.tState=b,this.onToken(f,!0),this.offset+=3}else if(this.tState===_){if(97!==t[n])return this.charError(t,n);this.tState=E}else if(this.tState===E){if(108!==t[n])return this.charError(t,n);this.tState=S}else if(this.tState===S){if(115!==t[n])return this.charError(t,n);this.tState=x}else if(this.tState===x){if(101!==t[n])return this.charError(t,n);this.tState=b,this.onToken(h,!1),this.offset+=4}else if(this.tState===O){if(117!==t[n])return this.charError(t,n);this.tState=C}else if(this.tState===C){if(108!==t[n])return this.charError(t,n);this.tState=R}else if(this.tState===R){if(108!==t[n])return this.charError(t,n);this.tState=b,this.onToken(d,null),this.offset+=3}},z.onToken=function(t,e){},z.parseError=function(t,e){this.tState=g,this.onError(new Error("Unexpected "+W.toknam(t)+(e?"("+JSON.stringify(e)+")":"")+" in state "+W.toknam(this.state)))},z.push=function(){this.stack.push({value:this.value,key:this.key,mode:this.mode})},z.pop=function(){var t=this.value,e=this.stack.pop();this.value=e.value,this.key=e.key,this.mode=e.mode,this.emit(t),this.mode||(this.state=k)},z.emit=function(t){this.mode&&(this.state=c),this.onValue(t)},z.onValue=function(t){},z.onToken=function(t,e){if(this.state===k)if(t===p||t===y||t===f||t===h||t===d)this.value&&(this.value[this.key]=e),this.emit(e);else if(t===o)this.push(),this.value?this.value=this.value[this.key]={}:this.value={},this.key=void 0,this.state=M,this.mode=U;else if(t===s)this.push(),this.value?this.value=this.value[this.key]=[]:this.value=[],this.key=0,this.mode=V,this.state=k;else if(t===a){if(this.mode!==U)return this.parseError(t,e);this.pop()}else{if(t!==u)return this.parseError(t,e);if(this.mode!==V)return this.parseError(t,e);this.pop()}else if(this.state===M)if(t===p)this.key=e,this.state=l;else{if(t!==a)return this.parseError(t,e);this.pop()}else if(this.state===l){if(t!==l)return this.parseError(t,e);this.state=k}else{if(this.state!==c)return this.parseError(t,e);if(t===c)this.mode===V?(this.key++,this.state=k):this.mode===U&&(this.state=M);else{if(!(t===u&&this.mode===V||t===a&&this.mode===U))return this.parseError(t,e);this.pop()}}},W.C=i,t.exports=W},5272:function(t,e,n){"use strict";n.r(e),n.d(e,{BlankNode:function(){return a.DP},DataFactory:function(){return a.ZP},DefaultGraph:function(){return a.Xy},Lexer:function(){return r.Z},Literal:function(){return a.t$},NamedNode:function(){return a.jJ},Parser:function(){return i.Z},Quad:function(){return a.lD},Store:function(){return m},StreamParser:function(){return E},StreamWriter:function(){return S},Term:function(){return a.Rh},Triple:function(){return a.PL},Util:function(){return s},Variable:function(){return a._w},Writer:function(){return y},default:function(){return x},termFromId:function(){return a.LQ},termToId:function(){return a.dW}});var r=n(2366),i=n(57),o=(n(1703),n(1010)),a=n(6181),s=n(6626);const u=a.ZP.defaultGraph(),{rdf:l,xsd:c}=o.Z,f=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,h=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,d={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class p extends a.Rh{equals(){return!1}}class y{constructor(t,e){if(this._prefixRegex=/$0^/,t&&"function"!==typeof t.write&&(e=t,t=null),e=e||{},this._lists=e.lists,t)this._outputStream=t,this._endStream=void 0===e.end||!!e.end;else{let t="";this._outputStream={write(e,n,r){t+=e,r&&r()},end:e=>{e&&e(null,t)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(e.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=u,this._prefixIRIs=Object.create(null),e.prefixes&&this.addPrefixes(e.prefixes),e.baseIRI&&(this._baseMatcher=new RegExp(`^${g(e.baseIRI)}${e.baseIRI.endsWith("/")?"":"[#?]"}`),this._baseLength=e.baseIRI.length))}get _inDefaultGraph(){return u.equals(this._graph)}_write(t,e){this._outputStream.write(t,"utf8",e)}_writeQuad(t,e,n,r,i){try{r.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(u.equals(r)?"":`${this._encodeIriOrBlank(r)} {\n`)),this._graph=r,this._subject=null),t.equals(this._subject)?e.equals(this._predicate)?this._write(`, ${this._encodeObject(n)}`,i):this._write(`;\n    ${this._encodePredicate(this._predicate=e)} ${this._encodeObject(n)}`,i):this._write(`${(null===this._subject?"":".\n")+this._encodeSubject(this._subject=t)} ${this._encodePredicate(this._predicate=e)} ${this._encodeObject(n)}`,i)}catch(o){i&&i(o)}}_writeQuadLine(t,e,n,r,i){delete this._prefixMatch,this._write(this.quadToString(t,e,n,r),i)}quadToString(t,e,n,r){return`${this._encodeSubject(t)} ${this._encodeIriOrBlank(e)} ${this._encodeObject(n)}${r&&r.value?` ${this._encodeIriOrBlank(r)} .\n`:" .\n"}`}quadsToString(t){return t.map((t=>this.quadToString(t.subject,t.predicate,t.object,t.graph))).join("")}_encodeSubject(t){return"Quad"===t.termType?this._encodeQuad(t):this._encodeIriOrBlank(t)}_encodeIriOrBlank(t){if("NamedNode"!==t.termType)return this._lists&&t.value in this._lists&&(t=this.list(this._lists[t.value])),"id"in t?t.id:`_:${t.value}`;let e=t.value;this._baseMatcher&&this._baseMatcher.test(e)&&(e=e.substr(this._baseLength)),f.test(e)&&(e=e.replace(h,b));const n=this._prefixRegex.exec(e);return n?n[1]?this._prefixIRIs[n[1]]+n[2]:e:`<${e}>`}_encodeLiteral(t){let e=t.value;if(f.test(e)&&(e=e.replace(h,b)),t.language)return`"${e}"@${t.language}`;if(this._lineMode){if(t.datatype.value===c.string)return`"${e}"`}else switch(t.datatype.value){case c.string:return`"${e}"`;case c.boolean:if("true"===e||"false"===e)return e;break;case c.integer:if(/^[+-]?\d+$/.test(e))return e;break;case c.decimal:if(/^[+-]?\d*\.\d+$/.test(e))return e;break;case c.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(e))return e;break}return`"${e}"^^${this._encodeIriOrBlank(t.datatype)}`}_encodePredicate(t){return t.value===l.type?"a":this._encodeIriOrBlank(t)}_encodeObject(t){switch(t.termType){case"Quad":return this._encodeQuad(t);case"Literal":return this._encodeLiteral(t);default:return this._encodeIriOrBlank(t)}}_encodeQuad({subject:t,predicate:e,object:n,graph:r}){return`<<${this._encodeSubject(t)} ${this._encodePredicate(e)} ${this._encodeObject(n)}${(0,s.isDefaultGraph)(r)?"":` ${this._encodeIriOrBlank(r)}`}>>`}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(t,e,n,r,i){void 0===n?this._writeQuad(t.subject,t.predicate,t.object,t.graph,e):"function"===typeof r?this._writeQuad(t,e,n,u,r):this._writeQuad(t,e,n,r||u,i)}addQuads(t){for(let e=0;e<t.length;e++)this.addQuad(t[e])}addPrefix(t,e,n){const r={};r[t]=e,this.addPrefixes(r,n)}addPrefixes(t,e){if(!this._prefixIRIs)return e&&e();let n=!1;for(let r in t){let e=t[r];"string"!==typeof e&&(e=e.value),n=!0,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),this._prefixIRIs[e]=r+=":",this._write(`@prefix ${r} <${e}>.\n`)}if(n){let t="",e="";for(const n in this._prefixIRIs)t+=t?`|${n}`:n,e+=(e?"|":"")+this._prefixIRIs[n];t=g(t,/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp(`^(?:${e})[^/]*$|^(${t})([a-zA-Z][\\-_a-zA-Z0-9]*)$`)}this._write(n?"\n":"",e)}blank(t,e){let n,r,i=t;switch(void 0===t?i=[]:t.termType?i=[{predicate:t,object:e}]:"length"in t||(i=[t]),r=i.length){case 0:return new p("[]");case 1:if(n=i[0],!(n.object instanceof p))return new p(`[ ${this._encodePredicate(n.predicate)} ${this._encodeObject(n.object)} ]`);default:let e="[";for(let o=0;o<r;o++)n=i[o],n.predicate.equals(t)?e+=`, ${this._encodeObject(n.object)}`:(e+=`${(o?";\n  ":"\n  ")+this._encodePredicate(n.predicate)} ${this._encodeObject(n.object)}`,t=n.predicate);return new p(`${e}\n]`)}}list(t){const e=t&&t.length||0,n=new Array(e);for(let r=0;r<e;r++)n[r]=this._encodeObject(t[r]);return new p(`(${n.join(" ")})`)}end(t){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;let e=t&&((n,r)=>{e=null,t(n,r)});if(this._endStream)try{return this._outputStream.end(e)}catch(n){}e&&e()}}function b(t){let e=d[t];return void 0===e&&(1===t.length?(e=t.charCodeAt(0).toString(16),e="\\u0000".substr(0,6-e.length)+e):(e=(1024*(t.charCodeAt(0)-55296)+t.charCodeAt(1)+9216).toString(16),e="\\U00000000".substr(0,10-e.length)+e)),e}function g(t){return t.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&")}var v=n(5701);class m{constructor(t,e){this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,e||!t||t[0]||(e=t,t=null),e=e||{},this._factory=e.factory||a.ZP,t&&this.addQuads(t)}get size(){let t=this._size;if(null!==t)return t;t=0;const e=this._graphs;let n,r;for(const i in e)for(const o in n=e[i].subjects)for(const e in r=n[o])t+=Object.keys(r[e]).length;return this._size=t}_addToIndex(t,e,n,r){const i=t[e]||(t[e]={}),o=i[n]||(i[n]={}),a=r in o;return a||(o[r]=null),!a}_removeFromIndex(t,e,n,r){const i=t[e],o=i[n];delete o[r];for(const a in o)return;delete i[n];for(const a in i)return;delete t[e]}*_findInIndex(t,e,n,r,i,o,s,u){let l,c,f;const h=this._entities,d=(0,a.LQ)(u,this._factory),p={subject:null,predicate:null,object:null};e&&((l=t,t={})[e]=l[e]);for(const y in t)if(c=t[y]){p[i]=(0,a.LQ)(h[y],this._factory),n&&((l=c,c={})[n]=l[n]);for(const t in c)if(f=c[t]){p[o]=(0,a.LQ)(h[t],this._factory);const e=r?r in f?[r]:[]:Object.keys(f);for(let t=0;t<e.length;t++)p[s]=(0,a.LQ)(h[e[t]],this._factory),yield this._factory.quad(p.subject,p.predicate,p.object,d)}}}_loop(t,e){for(const n in t)e(n)}_loopByKey0(t,e,n){let r,i;if(r=t[e])for(i in r)n(i)}_loopByKey1(t,e,n){let r,i;for(r in t)i=t[r],i[e]&&n(r)}_loopBy2Keys(t,e,n,r){let i,o,a;if((i=t[e])&&(o=i[n]))for(a in o)r(a)}_countInIndex(t,e,n,r){let i,o,a,s=0;e&&((i=t,t={})[e]=i[e]);for(const u in t)if(o=t[u]){n&&((i=o,o={})[n]=i[n]);for(const t in o)(a=o[t])&&(r?r in a&&s++:s+=Object.keys(a).length)}return s}_getGraphs(t){if(!w(t))return this._graphs;const e={};return e[t]=this._graphs[t],e}_uniqueEntities(t){const e=Object.create(null);return n=>{n in e||(e[n]=!0,t((0,a.LQ)(this._entities[n],this._factory)))}}add(t){return this.addQuad(t),this}addQuad(t,e,n,r){e||(r=t.graph,n=t.object,e=t.predicate,t=t.subject),t=(0,a.dW)(t),e=(0,a.dW)(e),n=(0,a.dW)(n),r=(0,a.dW)(r);let i=this._graphs[r];i||(i=this._graphs[r]={subjects:{},predicates:{},objects:{}},Object.freeze(i));const o=this._ids,s=this._entities;t=o[t]||(o[s[++this._id]=t]=this._id),e=o[e]||(o[s[++this._id]=e]=this._id),n=o[n]||(o[s[++this._id]=n]=this._id);const u=this._addToIndex(i.subjects,t,e,n);return this._addToIndex(i.predicates,e,n,t),this._addToIndex(i.objects,n,t,e),this._size=null,u}addQuads(t){for(let e=0;e<t.length;e++)this.addQuad(t[e])}delete(t){return this.removeQuad(t),this}has(t,e,n,r){return t&&t.subject&&({subject:t,predicate:e,object:n,graph:r}=t),!this.readQuads(t,e,n,r).next().done}import(t){return t.on("data",(t=>{this.addQuad(t)})),t}removeQuad(t,e,n,r){e||(r=t.graph,n=t.object,e=t.predicate,t=t.subject),t=(0,a.dW)(t),e=(0,a.dW)(e),n=(0,a.dW)(n),r=(0,a.dW)(r);const i=this._ids,o=this._graphs;let s,u,l;if(!(t=i[t])||!(e=i[e])||!(n=i[n])||!(s=o[r])||!(u=s.subjects[t])||!(l=u[e])||!(n in l))return!1;for(t in this._removeFromIndex(s.subjects,t,e,n),this._removeFromIndex(s.predicates,e,n,t),this._removeFromIndex(s.objects,n,t,e),null!==this._size&&this._size--,s.subjects)return!0;return delete o[r],!0}removeQuads(t){for(let e=0;e<t.length;e++)this.removeQuad(t[e])}remove(t){return t.on("data",(t=>{this.removeQuad(t)})),t}removeMatches(t,e,n,r){const i=new v.Readable({objectMode:!0});return i._read=()=>{for(const o of this.readQuads(t,e,n,r))i.push(o);i.push(null)},this.remove(i)}deleteGraph(t){return this.removeMatches(null,null,null,t)}getQuads(t,e,n,r){return[...this.readQuads(t,e,n,r)]}*readQuads(t,e,n,r){t=t&&(0,a.dW)(t),e=e&&(0,a.dW)(e),n=n&&(0,a.dW)(n),r=r&&(0,a.dW)(r);const i=this._getGraphs(r),o=this._ids;let s,u,l,c;if(!(w(t)&&!(u=o[t])||w(e)&&!(l=o[e])||w(n)&&!(c=o[n])))for(const a in i)(s=i[a])&&(u?c?yield*this._findInIndex(s.objects,c,u,l,"object","subject","predicate",a):yield*this._findInIndex(s.subjects,u,l,null,"subject","predicate","object",a):l?yield*this._findInIndex(s.predicates,l,c,null,"predicate","object","subject",a):c?yield*this._findInIndex(s.objects,c,null,null,"object","subject","predicate",a):yield*this._findInIndex(s.subjects,null,null,null,"subject","predicate","object",a))}match(t,e,n,r){return new _(this,t,e,n,r)}countQuads(t,e,n,r){t=t&&(0,a.dW)(t),e=e&&(0,a.dW)(e),n=n&&(0,a.dW)(n),r=r&&(0,a.dW)(r);const i=this._getGraphs(r),o=this._ids;let s,u,l,c,f=0;if(w(t)&&!(u=o[t])||w(e)&&!(l=o[e])||w(n)&&!(c=o[n]))return 0;for(const a in i)(s=i[a])&&(f+=t?n?this._countInIndex(s.objects,c,u,l):this._countInIndex(s.subjects,u,l,c):e?this._countInIndex(s.predicates,l,c,u):this._countInIndex(s.objects,c,u,l));return f}forEach(t,e,n,r,i){this.some((e=>(t(e),!1)),e,n,r,i)}every(t,e,n,r,i){let o=!1;const a=!this.some((e=>(o=!0,!t(e))),e,n,r,i);return o&&a}some(t,e,n,r,i){for(const o of this.readQuads(e,n,r,i))if(t(o))return!0;return!1}getSubjects(t,e,n){const r=[];return this.forSubjects((t=>{r.push(t)}),t,e,n),r}forSubjects(t,e,n,r){e=e&&(0,a.dW)(e),n=n&&(0,a.dW)(n),r=r&&(0,a.dW)(r);const i=this._ids,o=this._getGraphs(r);let s,u,l;if(t=this._uniqueEntities(t),!(w(e)&&!(u=i[e])||w(n)&&!(l=i[n])))for(r in o)(s=o[r])&&(u?l?this._loopBy2Keys(s.predicates,u,l,t):this._loopByKey1(s.subjects,u,t):l?this._loopByKey0(s.objects,l,t):this._loop(s.subjects,t))}getPredicates(t,e,n){const r=[];return this.forPredicates((t=>{r.push(t)}),t,e,n),r}forPredicates(t,e,n,r){e=e&&(0,a.dW)(e),n=n&&(0,a.dW)(n),r=r&&(0,a.dW)(r);const i=this._ids,o=this._getGraphs(r);let s,u,l;if(t=this._uniqueEntities(t),!(w(e)&&!(u=i[e])||w(n)&&!(l=i[n])))for(r in o)(s=o[r])&&(u?l?this._loopBy2Keys(s.objects,l,u,t):this._loopByKey0(s.subjects,u,t):l?this._loopByKey1(s.predicates,l,t):this._loop(s.predicates,t))}getObjects(t,e,n){const r=[];return this.forObjects((t=>{r.push(t)}),t,e,n),r}forObjects(t,e,n,r){e=e&&(0,a.dW)(e),n=n&&(0,a.dW)(n),r=r&&(0,a.dW)(r);const i=this._ids,o=this._getGraphs(r);let s,u,l;if(t=this._uniqueEntities(t),!(w(e)&&!(u=i[e])||w(n)&&!(l=i[n])))for(r in o)(s=o[r])&&(u?l?this._loopBy2Keys(s.subjects,u,l,t):this._loopByKey1(s.objects,u,t):l?this._loopByKey0(s.predicates,l,t):this._loop(s.objects,t))}getGraphs(t,e,n){const r=[];return this.forGraphs((t=>{r.push(t)}),t,e,n),r}forGraphs(t,e,n,r){for(const i in this._graphs)this.some((e=>(t(e.graph),!0)),e,n,r,i)}createBlankNode(t){let e,n;if(t){e=t=`_:${t}`,n=1;while(this._ids[e])e=t+n++}else do{e="_:b"+this._blankNodeIndex++}while(this._ids[e]);return this._ids[e]=++this._id,this._entities[this._id]=e,this._factory.blankNode(e.substr(2))}extractLists({remove:t=!1,ignoreErrors:e=!1}={}){const n={},r=e?()=>!0:(t,e)=>{throw new Error(`${t.value} ${e}`)},i=this.getQuads(null,o.Z.rdf.rest,o.Z.rdf.nil,null),a=t?[...i]:[];return i.forEach((e=>{const i=[];let s,u,l=!1;const c=e.graph;let f=e.subject;while(f&&!l){const t=this.getQuads(null,null,f,null),e=this.getQuads(f,null,null,null);let n,h=null,d=null,p=null;for(let i=0;i<e.length&&!l;i++)n=e[i],n.graph.equals(c)?s?l=r(f,"has non-list arcs out"):n.predicate.value===o.Z.rdf.first?h?l=r(f,"has multiple rdf:first arcs"):a.push(h=n):n.predicate.value===o.Z.rdf.rest?d?l=r(f,"has multiple rdf:rest arcs"):a.push(d=n):t.length?l=r(f,"can't be subject and object"):(s=n,u="subject"):l=r(f,"not confined to single graph");for(let i=0;i<t.length&&!l;++i)n=t[i],s?l=r(f,"can't have coreferences"):n.predicate.value===o.Z.rdf.rest?p?l=r(f,"has incoming rdf:rest arcs"):p=n:(s=n,u="object");h?i.unshift(h.object):l=r(f,"has no list head"),f=p&&p.subject}l?t=!1:s&&(n[s[u].value]=i)})),t&&this.removeQuads(a),n}*[Symbol.iterator](){yield*this.readQuads()}}function w(t){return"string"===typeof t||t instanceof String}class _ extends v.Readable{constructor(t,e,n,r,i){super({objectMode:!0}),Object.assign(this,{n3Store:t,subject:e,predicate:n,object:r,graph:i})}get filtered(){if(!this._filtered){const{n3Store:t,graph:e,object:n,predicate:r,subject:i}=this,o=this._filtered=new m({factory:t._factory});for(const a of t.readQuads(i,r,n,e))o.addQuad(a)}return this._filtered}get size(){return this.filtered.size}_read(){for(const t of this)this.push(t);this.push(null)}add(t){return this.filtered.add(t)}delete(t){return this.filtered.delete(t)}has(t){return this.filtered.has(t)}match(t,e,n,r){return new _(this.filtered,t,e,n,r)}*[Symbol.iterator](){yield*this._filtered||this.n3Store.readQuads(this.subject,this.predicate,this.object,this.graph)}}class E extends v.Transform{constructor(t){super({decodeStrings:!0}),this._readableState.objectMode=!0;const e=new i.Z(t);let n,r;e.parse({on:(t,e)=>{switch(t){case"data":n=e;break;case"end":r=e;break}}},((t,e)=>{t&&this.emit("error",t)||e&&this.push(e)}),((t,e)=>{this.emit("prefix",t,e)})),this._transform=(t,e,r)=>{n(t),r()},this._flush=t=>{r(),t()}}import(t){return t.on("data",(t=>{this.write(t)})),t.on("end",(()=>{this.end()})),t.on("error",(t=>{this.emit("error",t)})),this}}class S extends v.Transform{constructor(t){super({encoding:"utf8",writableObjectMode:!0});const e=this._writer=new y({write:(t,e,n)=>{this.push(t),n&&n()},end:t=>{this.push(null),t&&t()}},t);this._transform=(t,n,r)=>{e.addQuad(t,r)},this._flush=t=>{e.end(t)}}import(t){return t.on("data",(t=>{this.write(t)})),t.on("end",(()=>{this.end()})),t.on("error",(t=>{this.emit("error",t)})),t.on("prefix",((t,e)=>{this._writer.addPrefix(t,e)})),this}}var x={Lexer:r.Z,Parser:i.Z,Writer:y,Store:m,StreamParser:E,StreamWriter:S,Util:s,DataFactory:a.ZP,Term:a.Rh,NamedNode:a.jJ,Literal:a.t$,BlankNode:a.DP,Variable:a._w,DefaultGraph:a.Xy,Quad:a.lD,Triple:a.PL,termFromId:a.LQ,termToId:a.dW}},5561:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),i(n(4124),e),i(n(9083),e),i(n(5739),e),i(n(2794),e),i(n(4898),e),i(n(7457),e),i(n(432),e)},4124:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BlankNode=void 0;class n{constructor(t){this.termType="BlankNode",this.value=t}equals(t){return!!t&&"BlankNode"===t.termType&&t.value===this.value}}e.BlankNode=n},9083:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DataFactory=void 0;const r=n(4124),i=n(5739),o=n(2794),a=n(4898),s=n(7457),u=n(432);let l=0;class c{constructor(t){this.blankNodeCounter=0,t=t||{},this.blankNodePrefix=t.blankNodePrefix||`df_${l++}_`}namedNode(t){return new a.NamedNode(t)}blankNode(t){return new r.BlankNode(t||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(t,e){return new o.Literal(t,e)}variable(t){return new u.Variable(t)}defaultGraph(){return i.DefaultGraph.INSTANCE}quad(t,e,n,r){return new s.Quad(t,e,n,r||this.defaultGraph())}fromTerm(t){switch(t.termType){case"NamedNode":return this.namedNode(t.value);case"BlankNode":return this.blankNode(t.value);case"Literal":return t.language?this.literal(t.value,t.language):t.datatype.equals(o.Literal.XSD_STRING)?this.literal(t.value):this.literal(t.value,this.fromTerm(t.datatype));case"Variable":return this.variable(t.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(t.subject),this.fromTerm(t.predicate),this.fromTerm(t.object),this.fromTerm(t.graph))}}fromQuad(t){return this.fromTerm(t)}resetBlankNodeCounter(){this.blankNodeCounter=0}}e.DataFactory=c},5739:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultGraph=void 0;class n{constructor(){this.termType="DefaultGraph",this.value=""}equals(t){return!!t&&"DefaultGraph"===t.termType}}e.DefaultGraph=n,n.INSTANCE=new n},2794:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Literal=void 0;const r=n(4898);class i{constructor(t,e){this.termType="Literal",this.value=t,"string"===typeof e?(this.language=e,this.datatype=i.RDF_LANGUAGE_STRING):e?(this.language="",this.datatype=e):(this.language="",this.datatype=i.XSD_STRING)}equals(t){return!!t&&"Literal"===t.termType&&t.value===this.value&&t.language===this.language&&t.datatype.equals(this.datatype)}}e.Literal=i,i.RDF_LANGUAGE_STRING=new r.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),i.XSD_STRING=new r.NamedNode("http://www.w3.org/2001/XMLSchema#string")},4898:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NamedNode=void 0;class n{constructor(t){this.termType="NamedNode",this.value=t}equals(t){return!!t&&"NamedNode"===t.termType&&t.value===this.value}}e.NamedNode=n},7457:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Quad=void 0;class n{constructor(t,e,n,r){this.termType="Quad",this.value="",this.subject=t,this.predicate=e,this.object=n,this.graph=r}equals(t){return!!t&&("Quad"===t.termType||!t.termType)&&this.subject.equals(t.subject)&&this.predicate.equals(t.predicate)&&this.object.equals(t.object)&&this.graph.equals(t.graph)}}e.Quad=n},432:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Variable=void 0;class n{constructor(t){this.termType="Variable",this.value=t}equals(t){return!!t&&"Variable"===t.termType&&t.value===this.value}}e.Variable=n},8230:function(t,e,n){"use strict";function r(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}n(1703);var i={};function o(t,e,n){function o(t,n,r){return"string"===typeof e?e:e(t,n,r)}n||(n=Error);var a=function(t){function e(e,n,r){return t.call(this,o(e,n,r))||this}return r(e,t),e}(n);a.prototype.name=n.name,a.prototype.code=t,i[t]=a}function a(t,e){if(Array.isArray(t)){var n=t.length;return t=t.map((function(t){return String(t)})),n>2?"one of ".concat(e," ").concat(t.slice(0,n-1).join(", "),", or ")+t[n-1]:2===n?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}return"of ".concat(e," ").concat(String(t))}function s(t,e,n){return t.substr(!n||n<0?0:+n,e.length)===e}function u(t,e,n){return(void 0===n||n>t.length)&&(n=t.length),t.substring(n-e.length,n)===e}function l(t,e,n){return"number"!==typeof n&&(n=0),!(n+e.length>t.length)&&-1!==t.indexOf(e,n)}o("ERR_INVALID_OPT_VALUE",(function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'}),TypeError),o("ERR_INVALID_ARG_TYPE",(function(t,e,n){var r,i;if("string"===typeof e&&s(e,"not ")?(r="must not be",e=e.replace(/^not /,"")):r="must be",u(t," argument"))i="The ".concat(t," ").concat(r," ").concat(a(e,"type"));else{var o=l(t,".")?"property":"argument";i='The "'.concat(t,'" ').concat(o," ").concat(r," ").concat(a(e,"type"))}return i+=". Received type ".concat(typeof n),i}),TypeError),o("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),o("ERR_METHOD_NOT_IMPLEMENTED",(function(t){return"The "+t+" method is not implemented"})),o("ERR_STREAM_PREMATURE_CLOSE","Premature close"),o("ERR_STREAM_DESTROYED",(function(t){return"Cannot call "+t+" after a stream was destroyed"})),o("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),o("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),o("ERR_STREAM_WRITE_AFTER_END","write after end"),o("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),o("ERR_UNKNOWN_ENCODING",(function(t){return"Unknown encoding: "+t}),TypeError),o("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.q=i},1606:function(t,e,n){"use strict";var r=n(1921),i=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};t.exports=c;var o=n(2345),a=n(1607);n(6110)(c,o);for(var s=i(a.prototype),u=0;u<s.length;u++){var l=s[u];c.prototype[l]||(c.prototype[l]=a.prototype[l])}function c(t){if(!(this instanceof c))return new c(t);o.call(this,t),a.call(this,t),this.allowHalfOpen=!0,t&&(!1===t.readable&&(this.readable=!1),!1===t.writable&&(this.writable=!1),!1===t.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",f)))}function f(){this._writableState.ended||r.nextTick(h,this)}function h(t){t.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}})},3091:function(t,e,n){"use strict";t.exports=i;var r=n(2784);function i(t){if(!(this instanceof i))return new i(t);r.call(this,t)}n(6110)(i,r),i.prototype._transform=function(t,e,n){n(null,t)}},2345:function(t,e,n){"use strict";var r,i=n(1921);n(8675),n(3462),t.exports=D,D.ReadableState=I;n(7041).EventEmitter;var o=function(t,e){return t.listeners(e).length},a=n(9767),s=n(9914).Buffer,u=n.g.Uint8Array||function(){};function l(t){return s.from(t)}function c(t){return s.isBuffer(t)||t instanceof u}var f,h=n(4616);f=h&&h.debuglog?h.debuglog("stream"):function(){};var d,p,y,b=n(3006),g=n(1437),v=n(8552),m=v.getHighWaterMark,w=n(8230).q,_=w.ERR_INVALID_ARG_TYPE,E=w.ERR_STREAM_PUSH_AFTER_EOF,S=w.ERR_METHOD_NOT_IMPLEMENTED,x=w.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;n(6110)(D,a);var O=g.errorOrDestroy,C=["error","close","destroy","pause","resume"];function R(t,e,n){if("function"===typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?Array.isArray(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}function I(t,e,i){r=r||n(1606),t=t||{},"boolean"!==typeof i&&(i=e instanceof r),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=m(this,t,"readableHighWaterMark",i),this.buffer=new b,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(d||(d=n(2225).s),this.decoder=new d(t.encoding),this.encoding=t.encoding)}function D(t){if(r=r||n(1606),!(this instanceof D))return new D(t);var e=this instanceof r;this._readableState=new I(t,this,e),this.readable=!0,t&&("function"===typeof t.read&&(this._read=t.read),"function"===typeof t.destroy&&(this._destroy=t.destroy)),a.call(this)}function T(t,e,n,r,i){f("readableAddChunk",e);var o,a=t._readableState;if(null===e)a.reading=!1,k(t,a);else if(i||(o=N(a,e)),o)O(t,o);else if(a.objectMode||e&&e.length>0)if("string"===typeof e||a.objectMode||Object.getPrototypeOf(e)===s.prototype||(e=l(e)),r)a.endEmitted?O(t,new x):A(t,a,e,!0);else if(a.ended)O(t,new E);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!n?(e=a.decoder.write(e),a.objectMode||0!==e.length?A(t,a,e,!1):V(t,a)):A(t,a,e,!1)}else r||(a.reading=!1,V(t,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function A(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(e.awaitDrain=0,t.emit("data",n)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&M(t)),V(t,e)}function N(t,e){var n;return c(e)||"string"===typeof e||void 0===e||t.objectMode||(n=new _("chunk",["string","Buffer","Uint8Array"],e)),n}Object.defineProperty(D.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),D.prototype.destroy=g.destroy,D.prototype._undestroy=g.undestroy,D.prototype._destroy=function(t,e){e(t)},D.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"===typeof t&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=s.from(t,e),e=""),n=!0),T(this,t,e,!1,n)},D.prototype.unshift=function(t){return T(this,t,null,!0,!1)},D.prototype.isPaused=function(){return!1===this._readableState.flowing},D.prototype.setEncoding=function(t){d||(d=n(2225).s);var e=new d(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;var r=this._readableState.buffer.head,i="";while(null!==r)i+=e.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var P=1073741824;function j(t){return t>=P?t=P:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function L(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=j(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function k(t,e){if(f("onEofChunk"),!e.ended){if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,e.sync?M(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,U(t)))}}function M(t){var e=t._readableState;f("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(f("emitReadable",e.flowing),e.emittedReadable=!0,i.nextTick(U,t))}function U(t){var e=t._readableState;f("emitReadable_",e.destroyed,e.length,e.ended),e.destroyed||!e.length&&!e.ended||(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,q(t)}function V(t,e){e.readingMore||(e.readingMore=!0,i.nextTick(F,t,e))}function F(t,e){while(!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&0===e.length)){var n=e.length;if(f("maybeReadMore read 0"),t.read(0),n===e.length)break}e.readingMore=!1}function B(t){return function(){var e=t._readableState;f("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&o(t,"data")&&(e.flowing=!0,q(t))}}function $(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function G(t){f("readable nexttick read 0"),t.read(0)}function J(t,e){e.resumeScheduled||(e.resumeScheduled=!0,i.nextTick(K,t,e))}function K(t,e){f("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),q(t),e.flowing&&!e.reading&&t.read(0)}function q(t){var e=t._readableState;f("flow",e.flowing);while(e.flowing&&null!==t.read());}function H(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.first():e.buffer.concat(e.length),e.buffer.clear()):n=e.buffer.consume(t,e.decoder),n);var n}function W(t){var e=t._readableState;f("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,i.nextTick(z,e,t))}function z(t,e){if(f("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&0===t.length&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var n=e._writableState;(!n||n.autoDestroy&&n.finished)&&e.destroy()}}function Q(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}D.prototype.read=function(t){f("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&((0!==e.highWaterMark?e.length>=e.highWaterMark:e.length>0)||e.ended))return f("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?W(this):M(this),null;if(t=L(t,e),0===t&&e.ended)return 0===e.length&&W(this),null;var r,i=e.needReadable;return f("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&(i=!0,f("length less than watermark",i)),e.ended||e.reading?(i=!1,f("reading or ended",i)):i&&(f("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=L(n,e))),r=t>0?H(t,e):null,null===r?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&W(this)),null!==r&&this.emit("data",r),r},D.prototype._read=function(t){O(this,new S("_read()"))},D.prototype.pipe=function(t,e){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=t;break;case 1:r.pipes=[r.pipes,t];break;default:r.pipes.push(t);break}r.pipesCount+=1,f("pipe count=%d opts=%j",r.pipesCount,e);var a=(!e||!1!==e.end)&&t!==i.stdout&&t!==i.stderr,s=a?l:v;function u(t,e){f("onunpipe"),t===n&&e&&!1===e.hasUnpiped&&(e.hasUnpiped=!0,d())}function l(){f("onend"),t.end()}r.endEmitted?i.nextTick(s):n.once("end",s),t.on("unpipe",u);var c=B(n);t.on("drain",c);var h=!1;function d(){f("cleanup"),t.removeListener("close",b),t.removeListener("finish",g),t.removeListener("drain",c),t.removeListener("error",y),t.removeListener("unpipe",u),n.removeListener("end",l),n.removeListener("end",v),n.removeListener("data",p),h=!0,!r.awaitDrain||t._writableState&&!t._writableState.needDrain||c()}function p(e){f("ondata");var i=t.write(e);f("dest.write",i),!1===i&&((1===r.pipesCount&&r.pipes===t||r.pipesCount>1&&-1!==Q(r.pipes,t))&&!h&&(f("false write response, pause",r.awaitDrain),r.awaitDrain++),n.pause())}function y(e){f("onerror",e),v(),t.removeListener("error",y),0===o(t,"error")&&O(t,e)}function b(){t.removeListener("finish",g),v()}function g(){f("onfinish"),t.removeListener("close",b),v()}function v(){f("unpipe"),n.unpipe(t)}return n.on("data",p),R(t,"error",y),t.once("close",b),t.once("finish",g),t.emit("pipe",n),r.flowing||(f("pipe resume"),n.resume()),t},D.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n)),this;if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var a=Q(e.pipes,t);return-1===a||(e.pipes.splice(a,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n)),this},D.prototype.on=function(t,e){var n=a.prototype.on.call(this,t,e),r=this._readableState;return"data"===t?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===t&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,f("on readable",r.length,r.reading),r.length?M(this):r.reading||i.nextTick(G,this))),n},D.prototype.addListener=D.prototype.on,D.prototype.removeListener=function(t,e){var n=a.prototype.removeListener.call(this,t,e);return"readable"===t&&i.nextTick($,this),n},D.prototype.removeAllListeners=function(t){var e=a.prototype.removeAllListeners.apply(this,arguments);return"readable"!==t&&void 0!==t||i.nextTick($,this),e},D.prototype.resume=function(){var t=this._readableState;return t.flowing||(f("resume"),t.flowing=!t.readableListening,J(this,t)),t.paused=!1,this},D.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},D.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var i in t.on("end",(function(){if(f("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(i){if(f("wrapped data"),n.decoder&&(i=n.decoder.write(i)),(!n.objectMode||null!==i&&void 0!==i)&&(n.objectMode||i&&i.length)){var o=e.push(i);o||(r=!0,t.pause())}})),t)void 0===this[i]&&"function"===typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));for(var o=0;o<C.length;o++)t.on(C[o],this.emit.bind(this,C[o]));return this._read=function(e){f("wrapped _read",e),r&&(r=!1,t.resume())},this},"function"===typeof Symbol&&(D.prototype[Symbol.asyncIterator]=function(){return void 0===p&&(p=n(5660)),p(this)}),Object.defineProperty(D.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(D.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(D.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}}),D._fromList=H,Object.defineProperty(D.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"===typeof Symbol&&(D.from=function(t,e){return void 0===y&&(y=n(6415)),y(D,t,e)})},2784:function(t,e,n){"use strict";t.exports=c;var r=n(8230).q,i=r.ERR_METHOD_NOT_IMPLEMENTED,o=r.ERR_MULTIPLE_CALLBACK,a=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=r.ERR_TRANSFORM_WITH_LENGTH_0,u=n(1606);function l(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new o);n.writechunk=null,n.writecb=null,null!=e&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function c(t){if(!(this instanceof c))return new c(t);u.call(this,t),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"===typeof t.transform&&(this._transform=t.transform),"function"===typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",f)}function f(){var t=this;"function"!==typeof this._flush||this._readableState.destroyed?h(this,null,null):this._flush((function(e,n){h(t,e,n)}))}function h(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new s;if(t._transformState.transforming)throw new a;return t.push(null)}n(6110)(c,u),c.prototype.push=function(t,e){return this._transformState.needTransform=!1,u.prototype.push.call(this,t,e)},c.prototype._transform=function(t,e,n){n(new i("_transform()"))},c.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},c.prototype._read=function(t){var e=this._transformState;null===e.writechunk||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},c.prototype._destroy=function(t,e){u.prototype._destroy.call(this,t,(function(t){e(t)}))}},1607:function(t,e,n){"use strict";var r,i=n(1921);function o(t){var e=this;this.next=null,this.entry=null,this.finish=function(){K(e,t)}}n(8675),n(3462),t.exports=I,I.WritableState=R;var a={deprecate:n(4728)},s=n(9767),u=n(9914).Buffer,l=n.g.Uint8Array||function(){};function c(t){return u.from(t)}function f(t){return u.isBuffer(t)||t instanceof l}var h,d=n(1437),p=n(8552),y=p.getHighWaterMark,b=n(8230).q,g=b.ERR_INVALID_ARG_TYPE,v=b.ERR_METHOD_NOT_IMPLEMENTED,m=b.ERR_MULTIPLE_CALLBACK,w=b.ERR_STREAM_CANNOT_PIPE,_=b.ERR_STREAM_DESTROYED,E=b.ERR_STREAM_NULL_VALUES,S=b.ERR_STREAM_WRITE_AFTER_END,x=b.ERR_UNKNOWN_ENCODING,O=d.errorOrDestroy;function C(){}function R(t,e,i){r=r||n(1606),t=t||{},"boolean"!==typeof i&&(i=e instanceof r),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=y(this,t,"writableHighWaterMark",i),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===t.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){k(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function I(t){r=r||n(1606);var e=this instanceof r;if(!e&&!h.call(I,this))return new I(t);this._writableState=new R(t,this,e),this.writable=!0,t&&("function"===typeof t.write&&(this._write=t.write),"function"===typeof t.writev&&(this._writev=t.writev),"function"===typeof t.destroy&&(this._destroy=t.destroy),"function"===typeof t.final&&(this._final=t.final)),s.call(this)}function D(t,e){var n=new S;O(t,n),i.nextTick(e,n)}function T(t,e,n,r){var o;return null===n?o=new E:"string"===typeof n||e.objectMode||(o=new g("chunk",["string","Buffer"],n)),!o||(O(t,o),i.nextTick(r,o),!1)}function A(t,e,n){return t.objectMode||!1===t.decodeStrings||"string"!==typeof e||(e=u.from(e,n)),e}function N(t,e,n,r,i,o){if(!n){var a=A(e,r,i);r!==a&&(n=!0,i="buffer",r=a)}var s=e.objectMode?1:r.length;e.length+=s;var u=e.length<e.highWaterMark;if(u||(e.needDrain=!0),e.writing||e.corked){var l=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},l?l.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else P(t,e,!1,s,r,i,o);return u}function P(t,e,n,r,i,o,a){e.writelen=r,e.writecb=a,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new _("write")):n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function j(t,e,n,r,o){--e.pendingcb,n?(i.nextTick(o,r),i.nextTick(G,t,e),t._writableState.errorEmitted=!0,O(t,r)):(o(r),t._writableState.errorEmitted=!0,O(t,r),G(t,e))}function L(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function k(t,e){var n=t._writableState,r=n.sync,o=n.writecb;if("function"!==typeof o)throw new m;if(L(n),e)j(t,n,r,e,o);else{var a=F(n)||t.destroyed;a||n.corked||n.bufferProcessing||!n.bufferedRequest||V(t,n),r?i.nextTick(M,t,n,a,o):M(t,n,a,o)}}function M(t,e,n,r){n||U(t,e),e.pendingcb--,r(),G(t,e)}function U(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function V(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,i=new Array(r),a=e.corkedRequestsFree;a.entry=n;var s=0,u=!0;while(n)i[s]=n,n.isBuf||(u=!1),n=n.next,s+=1;i.allBuffers=u,P(t,e,!0,e.length,i,"",a.finish),e.pendingcb++,e.lastBufferedRequest=null,a.next?(e.corkedRequestsFree=a.next,a.next=null):e.corkedRequestsFree=new o(e),e.bufferedRequestCount=0}else{while(n){var l=n.chunk,c=n.encoding,f=n.callback,h=e.objectMode?1:l.length;if(P(t,e,!1,h,l,c,f),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function F(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function B(t,e){t._final((function(n){e.pendingcb--,n&&O(t,n),e.prefinished=!0,t.emit("prefinish"),G(t,e)}))}function $(t,e){e.prefinished||e.finalCalled||("function"!==typeof t._final||e.destroyed?(e.prefinished=!0,t.emit("prefinish")):(e.pendingcb++,e.finalCalled=!0,i.nextTick(B,t,e)))}function G(t,e){var n=F(e);if(n&&($(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var r=t._readableState;(!r||r.autoDestroy&&r.endEmitted)&&t.destroy()}return n}function J(t,e,n){e.ending=!0,G(t,e),n&&(e.finished?i.nextTick(n):t.once("finish",n)),e.ended=!0,t.writable=!1}function K(t,e,n){var r=t.entry;t.entry=null;while(r){var i=r.callback;e.pendingcb--,i(n),r=r.next}e.corkedRequestsFree.next=t}n(6110)(I,s),R.prototype.getBuffer=function(){var t=this.bufferedRequest,e=[];while(t)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(R.prototype,"buffer",{get:a.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"===typeof Symbol&&Symbol.hasInstance&&"function"===typeof Function.prototype[Symbol.hasInstance]?(h=Function.prototype[Symbol.hasInstance],Object.defineProperty(I,Symbol.hasInstance,{value:function(t){return!!h.call(this,t)||this===I&&(t&&t._writableState instanceof R)}})):h=function(t){return t instanceof this},I.prototype.pipe=function(){O(this,new w)},I.prototype.write=function(t,e,n){var r=this._writableState,i=!1,o=!r.objectMode&&f(t);return o&&!u.isBuffer(t)&&(t=c(t)),"function"===typeof e&&(n=e,e=null),o?e="buffer":e||(e=r.defaultEncoding),"function"!==typeof n&&(n=C),r.ending?D(this,n):(o||T(this,r,t,n))&&(r.pendingcb++,i=N(this,r,o,t,e,n)),i},I.prototype.cork=function(){this._writableState.corked++},I.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.bufferProcessing||!t.bufferedRequest||V(this,t))},I.prototype.setDefaultEncoding=function(t){if("string"===typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new x(t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(I.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(I.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),I.prototype._write=function(t,e,n){n(new v("_write()"))},I.prototype._writev=null,I.prototype.end=function(t,e,n){var r=this._writableState;return"function"===typeof t?(n=t,t=null,e=null):"function"===typeof e&&(n=e,e=null),null!==t&&void 0!==t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||J(this,r,n),this},Object.defineProperty(I.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(I.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),I.prototype.destroy=d.destroy,I.prototype._undestroy=d.undestroy,I.prototype._destroy=function(t,e){e(t)}},5660:function(t,e,n){"use strict";var r,i=n(1921);function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var a=n(6855),s=Symbol("lastResolve"),u=Symbol("lastReject"),l=Symbol("error"),c=Symbol("ended"),f=Symbol("lastPromise"),h=Symbol("handlePromise"),d=Symbol("stream");function p(t,e){return{value:t,done:e}}function y(t){var e=t[s];if(null!==e){var n=t[d].read();null!==n&&(t[f]=null,t[s]=null,t[u]=null,e(p(n,!1)))}}function b(t){i.nextTick(y,t)}function g(t,e){return function(n,r){t.then((function(){e[c]?n(p(void 0,!0)):e[h](n,r)}),r)}}var v=Object.getPrototypeOf((function(){})),m=Object.setPrototypeOf((r={get stream(){return this[d]},next:function(){var t=this,e=this[l];if(null!==e)return Promise.reject(e);if(this[c])return Promise.resolve(p(void 0,!0));if(this[d].destroyed)return new Promise((function(e,n){i.nextTick((function(){t[l]?n(t[l]):e(p(void 0,!0))}))}));var n,r=this[f];if(r)n=new Promise(g(r,this));else{var o=this[d].read();if(null!==o)return Promise.resolve(p(o,!1));n=new Promise(this[h])}return this[f]=n,n}},o(r,Symbol.asyncIterator,(function(){return this})),o(r,"return",(function(){var t=this;return new Promise((function(e,n){t[d].destroy(null,(function(t){t?n(t):e(p(void 0,!0))}))}))})),r),v),w=function(t){var e,n=Object.create(m,(e={},o(e,d,{value:t,writable:!0}),o(e,s,{value:null,writable:!0}),o(e,u,{value:null,writable:!0}),o(e,l,{value:null,writable:!0}),o(e,c,{value:t._readableState.endEmitted,writable:!0}),o(e,h,{value:function(t,e){var r=n[d].read();r?(n[f]=null,n[s]=null,n[u]=null,t(p(r,!1))):(n[s]=t,n[u]=e)},writable:!0}),e));return n[f]=null,a(t,(function(t){if(t&&"ERR_STREAM_PREMATURE_CLOSE"!==t.code){var e=n[u];return null!==e&&(n[f]=null,n[s]=null,n[u]=null,e(t)),void(n[l]=t)}var r=n[s];null!==r&&(n[f]=null,n[s]=null,n[u]=null,r(p(void 0,!0))),n[c]=!0})),t.on("readable",b.bind(null,n)),n};t.exports=w},3006:function(t,e,n){"use strict";function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}n(1703);var l=n(9914),c=l.Buffer,f=n(2361),h=f.inspect,d=h&&h.custom||"inspect";function p(t,e,n){c.prototype.copy.call(t,e,n)}t.exports=function(){function t(){a(this,t),this.head=null,this.tail=null,this.length=0}return u(t,[{key:"push",value:function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length}},{key:"unshift",value:function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length}},{key:"shift",value:function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(0===this.length)return"";var e=this.head,n=""+e.data;while(e=e.next)n+=t+e.data;return n}},{key:"concat",value:function(t){if(0===this.length)return c.alloc(0);var e=c.allocUnsafe(t>>>0),n=this.head,r=0;while(n)p(n.data,e,r),r+=n.data.length,n=n.next;return e}},{key:"consume",value:function(t,e){var n;return t<this.head.data.length?(n=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):n=t===this.head.data.length?this.shift():e?this._getString(t):this._getBuffer(t),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var e=this.head,n=1,r=e.data;t-=r.length;while(e=e.next){var i=e.data,o=t>i.length?i.length:t;if(o===i.length?r+=i:r+=i.slice(0,t),t-=o,0===t){o===i.length?(++n,e.next?this.head=e.next:this.head=this.tail=null):(this.head=e,e.data=i.slice(o));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(t){var e=c.allocUnsafe(t),n=this.head,r=1;n.data.copy(e),t-=n.data.length;while(n=n.next){var i=n.data,o=t>i.length?i.length:t;if(i.copy(e,e.length-t,0,o),t-=o,0===t){o===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(o));break}++r}return this.length-=r,e}},{key:d,value:function(t,e){return h(this,i({},e,{depth:0,customInspect:!1}))}}]),t}()},1437:function(t,e,n){"use strict";var r=n(1921);function i(t,e){var n=this,i=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return i||s?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,r.nextTick(u,this,t)):r.nextTick(u,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!e&&t?n._writableState?n._writableState.errorEmitted?r.nextTick(a,n):(n._writableState.errorEmitted=!0,r.nextTick(o,n,t)):r.nextTick(o,n,t):e?(r.nextTick(a,n),e(t)):r.nextTick(a,n)})),this)}function o(t,e){u(t,e),a(t)}function a(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function s(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function u(t,e){t.emit("error",e)}function l(t,e){var n=t._readableState,r=t._writableState;n&&n.autoDestroy||r&&r.autoDestroy?t.destroy(e):t.emit("error",e)}t.exports={destroy:i,undestroy:s,errorOrDestroy:l}},6855:function(t,e,n){"use strict";var r=n(8230).q.ERR_STREAM_PREMATURE_CLOSE;function i(t){var e=!1;return function(){if(!e){e=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];t.apply(this,r)}}}function o(){}function a(t){return t.setHeader&&"function"===typeof t.abort}function s(t,e,n){if("function"===typeof e)return s(t,null,e);e||(e={}),n=i(n||o);var u=e.readable||!1!==e.readable&&t.readable,l=e.writable||!1!==e.writable&&t.writable,c=function(){t.writable||h()},f=t._writableState&&t._writableState.finished,h=function(){l=!1,f=!0,u||n.call(t)},d=t._readableState&&t._readableState.endEmitted,p=function(){u=!1,d=!0,l||n.call(t)},y=function(e){n.call(t,e)},b=function(){var e;return u&&!d?(t._readableState&&t._readableState.ended||(e=new r),n.call(t,e)):l&&!f?(t._writableState&&t._writableState.ended||(e=new r),n.call(t,e)):void 0},g=function(){t.req.on("finish",h)};return a(t)?(t.on("complete",h),t.on("abort",b),t.req?g():t.on("request",g)):l&&!t._writableState&&(t.on("end",c),t.on("close",c)),t.on("end",p),t.on("finish",h),!1!==e.error&&t.on("error",y),t.on("close",b),function(){t.removeListener("complete",h),t.removeListener("abort",b),t.removeListener("request",g),t.req&&t.req.removeListener("finish",h),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",h),t.removeListener("end",p),t.removeListener("error",y),t.removeListener("close",b)}}t.exports=s},6415:function(t,e,n){n(1703),t.exports=function(){throw new Error("Readable.from is not available in the browser")}},3329:function(t,e,n){"use strict";var r;function i(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var o=n(8230).q,a=o.ERR_MISSING_ARGS,s=o.ERR_STREAM_DESTROYED;function u(t){if(t)throw t}function l(t){return t.setHeader&&"function"===typeof t.abort}function c(t,e,o,a){a=i(a);var u=!1;t.on("close",(function(){u=!0})),void 0===r&&(r=n(6855)),r(t,{readable:e,writable:o},(function(t){if(t)return a(t);u=!0,a()}));var c=!1;return function(e){if(!u&&!c)return c=!0,l(t)?t.abort():"function"===typeof t.destroy?t.destroy():void a(e||new s("pipe"))}}function f(t){t()}function h(t,e){return t.pipe(e)}function d(t){return t.length?"function"!==typeof t[t.length-1]?u:t.pop():u}function p(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,i=d(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new a("streams");var o=e.map((function(t,n){var a=n<e.length-1,s=n>0;return c(t,a,s,(function(t){r||(r=t),t&&o.forEach(f),a||(o.forEach(f),i(r))}))}));return e.reduce(h)}t.exports=p},8552:function(t,e,n){"use strict";var r=n(8230).q.ERR_INVALID_OPT_VALUE;function i(t,e,n){return null!=t.highWaterMark?t.highWaterMark:e?t[n]:null}function o(t,e,n,o){var a=i(e,o,n);if(null!=a){if(!isFinite(a)||Math.floor(a)!==a||a<0){var s=o?n:"highWaterMark";throw new r(s,a)}return Math.floor(a)}return t.objectMode?16:16384}t.exports={getHighWaterMark:o}},9767:function(t,e,n){t.exports=n(7041).EventEmitter},5701:function(t,e,n){e=t.exports=n(2345),e.Stream=e,e.Readable=e,e.Writable=n(1607),e.Duplex=n(1606),e.Transform=n(2784),e.PassThrough=n(3091),e.finished=n(6855),e.pipeline=n(3329)},5600:function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(7324))},7324:function(t,e,n){"use strict";function r(t,e){e=e||"";const n=e.indexOf("#");if(n>0&&(e=e.substr(0,n)),!t.length){if(e.indexOf(":")<0)throw new Error(`Found invalid baseIRI '${e}' for value '${t}'`);return e}if(t.startsWith("?")){const n=e.indexOf("?");return n>0&&(e=e.substr(0,n)),e+t}if(t.startsWith("#"))return e+t;if(!e.length){const e=t.indexOf(":");if(e<0)throw new Error(`Found invalid relative IRI '${t}' for a missing baseIRI`);return o(t,e)}const r=t.indexOf(":");if(r>=0)return o(t,r);const a=e.indexOf(":");if(a<0)throw new Error(`Found invalid baseIRI '${e}' for value '${t}'`);const s=e.substr(0,a+1);if(0===t.indexOf("//"))return s+o(t,r);let u;if(e.indexOf("//",a)===a+1){if(u=e.indexOf("/",a+3),u<0)return e.length>a+3?e+"/"+o(t,r):s+o(t,r)}else if(u=e.indexOf("/",a+1),u<0)return s+o(t,r);if(0===t.indexOf("/"))return e.substr(0,u)+i(t);let l=e.substr(u);const c=l.lastIndexOf("/");return c>=0&&c<l.length-1&&(l=l.substr(0,c+1),"."===t[0]&&"."!==t[1]&&"/"!==t[1]&&t[2]&&(t=t.substr(1))),t=l+t,t=i(t),e.substr(0,u)+t}function i(t){const e=[];let n=0;while(n<t.length)switch(t[n]){case"/":if("."===t[n+1])if("."===t[n+2]){if(!a(t[n+3])){e.push([]),n++;break}e.pop(),t[n+3]||e.push([]),n+=3}else{if(!a(t[n+2])){e.push([]),n++;break}t[n+2]||e.push([]),n+=2}else e.push([]),n++;break;case"#":case"?":e.length||e.push([]),e[e.length-1].push(t.substr(n)),n=t.length;break;default:e.length||e.push([]),e[e.length-1].push(t[n]),n++;break}return"/"+e.map((t=>t.join(""))).join("/")}function o(t,e){let n=e+1;e>=0?"/"===t[e+1]&&"/"===t[e+2]&&(n=e+3):"/"===t[0]&&"/"===t[1]&&(n=2);const r=t.indexOf("/",n);if(r<0)return t;const o=t.substr(0,r),a=t.substr(r);return o+i(a)}function a(t){return!t||"#"===t||"?"===t||"/"===t}n(1703),Object.defineProperty(e,"__esModule",{value:!0}),e.resolve=r,e.removeDotSegments=i,e.removeDotSegmentsOfPath=o},3161:function(t,e,n){var r=n(476);n(1703),n(6699),n(2262),n(4506),function(e,r){t.exports=r(n(7696),n(7077),n(4229),n(5272))}(window,(function(t,e,n,i){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}([function(e,n){e.exports=t},function(t,n){t.exports=e},function(t,e){t.exports=n},function(t,e){t.exports=i},function(t,e,n){"use strict";n.r(e),n.d(e,"DocumentFormat",(function(){return kt})),n.d(e,"MalformedDocumentError",(function(){return Jt})),n.d(e,"NetworkError",(function(){return qt})),n.d(e,"SolidContainerModel",(function(){return Oe})),n.d(e,"SolidDocument",(function(){return Vt})),n.d(e,"SolidEngine",(function(){return ce})),n.d(e,"SolidModel",(function(){return Mt}));var i,o=n(0),a=n.n(o),s=n(1),u=n(2),l=n(3),c=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},f=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t},h=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},d=new(function(){function t(){}return t.prototype.resolve=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=t.shift();t.length>0;){var r=t.shift();r.startsWith("/")?n=this.base(n)+r:r.startsWith("http://")||r.startsWith("https://")?n=r:n.endsWith("/")?n+=r:n+="/"+r}return n},t.prototype.resolveDirectory=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.resolve.apply(this,f(t));return n.endsWith("/")?n:n+"/"},t.prototype.base=function(t){var e=t.indexOf("://"),n=t.substr(e+3).indexOf("/");return-1!==n?t.substring(0,e+3+n):t},t.prototype.parentDirectory=function(t){t.endsWith("/")&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return-1!==e?t.substr(0,e+1):t},t.prototype.fileName=function(t){var e=t.lastIndexOf("/");return-1!==e?t.substr(e+1):""},t.prototype.directoryName=function(t){return t.endsWith("/")||(t=this.parentDirectory(t)),this.fileName(t.slice(0,-1))},t.prototype.parse=function(t){var e=t.trim().match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/);if(!e)return null;var n=e[4]||"",r=c(-1===n.indexOf(":")?[n]:n.split(":"),2),i=r[0],o=r[1];return{protocol:e[2]||void 0,domain:i||void 0,port:o||void 0,path:e[5]||void 0,query:e[7]||void 0,fragment:e[9]||void 0}},t.prototype.clean=function(t,e){var n,r,i=this.parse(t);if(!i)return t;try{for(var o=h(Object.entries(i)),a=o.next();!a.done;a=o.next()){var s=c(a.value,2),u=s[0],l=s[1];i[u]=!1!==e[u]&&l||""}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return[i.protocol?i.protocol+"://":"",i.domain||"",i.port?":"+i.port:"",i.path||"",i.query?"?"+i.query:"",i.fragment?"#"+i.fragment:""].join("")},t.prototype.route=function(t){return this.clean(t,{protocol:!0,domain:!0,port:!0,path:!0,query:!1,fragment:!1})},t}()),p=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),y=function(t){this.name=t},b=function(){function t(t,e,n){this.resourceUrl=t,this.name=e,this.value=n}return t.fromStatement=function(t){var e="NamedNode"===t.subject.termType?t.subject.value:null;return t.predicate.value===B("rdf:type")?this.type(e,t.object.value):"NamedNode"===t.object.termType?this.reference(e,t.predicate.value,t.object.value):"BlankNode"===t.object.termType?this.reference(e,t.predicate.value,null):"Variable"===t.object.termType?this.reference(e,t.predicate.value,new y(t.object.value)):this.literal(e,t.predicate.value,t.object.datatype.value===B("xsd:dateTime")?new Date(t.object.value):t.object.value)},t.literal=function(t,e,n){return new g(t,e,n)},t.reference=function(t,e,n){return new v(t,e,n)},t.type=function(t,e){return new m(t,e)},t.toTurtle=function(t,e){return void 0===e&&(e=null),t.map((function(t){return t.toTurtle(e)+" ."})).join("\n")},t.prototype.toTurtle=function(t){return void 0===t&&(t=null),this.getTurtleSubject(t)+" "+this.getTurtlePredicate()+" "+this.getTurtleObject(t)},t.prototype.clone=function(e){switch(e=null!=e?e:this.resourceUrl,this.type){case 2:return t.literal(e,this.name,this.value);case 0:return t.type(e,this.value);case 1:return t.reference(e,this.name,this.value)}},t.prototype.getTurtleReference=function(t,e){var n=null==t?void 0:t.indexOf("#");return t&&t!==e?null!==e&&t.startsWith(e)&&-1!==n?"<#"+t.substr(n+1)+">":"<"+encodeURI(t)+">":"<>"},t.prototype.getTurtleSubject=function(t){return this.getTurtleReference(this.resourceUrl,t)},t.prototype.getTurtlePredicate=function(){return"<"+encodeURI(this.name)+">"},t}(),g=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;return i.type=2,i}return p(e,t),e.prototype.getTurtleObject=function(){if(this.value instanceof Date){var t=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.map((function(t){return t.toString().padStart(2,"0")}))};return'"'+t(this.value.getUTCFullYear(),this.value.getUTCMonth()+1,this.value.getUTCDate()).join("-")+"T"+t(this.value.getUTCHours(),this.value.getUTCMinutes(),this.value.getUTCSeconds()).join(":")+'Z"^^<'+B("xsd:dateTime")+">"}return JSON.stringify(this.value)},e}(b),v=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;return i.type=1,i}return p(e,t),e.prototype.getTurtleObject=function(t){return this.value instanceof y?this.value.name:this.getTurtleReference(this.value,t)},e}(b),m=function(t){function e(e,n){var r=t.call(this,e,B("rdf:type"),n)||this;return r.type=0,r}return p(e,t),e.prototype.getTurtlePredicate=function(){return"a"},e.prototype.getTurtleObject=function(){return"<"+encodeURI(this.value)+">"},e}(b),w=b,_=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},E=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(_(arguments[e]));return t},S=function(){function t(t){this.url=t,this.statements=[],this.types=[],this.properties=[],this.propertiesIndex={}}return Object.defineProperty(t.prototype,"name",{get:function(){return this.getPropertyValue(B("foaf:name"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"label",{get:function(){return this.getPropertyValue(B("rdfs:label"))},enumerable:!0,configurable:!0}),t.prototype.isType=function(t){return-1!==this.types.indexOf(B(t))},t.prototype.getPropertyValue=function(t,e){void 0===e&&(e=null);var n=_(this.propertiesIndex[B(t)]||[],1)[0];return n?n.value:e},t.prototype.getPropertyValues=function(t){return(this.propertiesIndex[B(t)]||[]).map((function(t){return t.value}))},t.prototype.addStatement=function(t){if(t.subject.value===this.url){var e=w.fromStatement(t);0===e.type&&this.types.push(e.value),this.statements.push(t),this.properties.push(e),this.propertiesIndex[e.name]=E(this.propertiesIndex[e.name]||[],[e])}},t}(),x=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},O=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(x(arguments[e]));return t},C=new(function(){function t(){}return t.prototype.create=function(t){return Array.isArray(t)?t:[t]},t.prototype.clean=function(t){return t.filter((function(t){return!!t}))},t.prototype.contains=function(t,e){return-1!==t.indexOf(e)},t.prototype.filter=function(t){return t.filter((function(t){return!!t}))},t.prototype.flatten=function(t){return t.reduce((function(t,e){return O(t,e)}),[])},t.prototype.last=function(t){return t[t.length-1]},t.prototype.make=function(t,e){return void 0===e&&(e=null),new Array(t).fill(e)},t.prototype.range=function(t){for(var e=[],n=0;n<t;n++)e.push(n);return e},t.prototype.removeItem=function(t,e){var n=t.indexOf(e);return-1!==n&&t.splice(n,1),e},t.prototype.unique=function(t,e){void 0===e&&(e=null);var n=t.map((function(t){return e?e(t):t}));return t.filter((function(t,e){return n.indexOf(n[e])===e}))},t.prototype.without=function(t,e){return t.filter((function(t){return-1===e.indexOf(t)}))},t.prototype.zip=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=function(e){n.push(t.map((function(t){return t[e]})))},i=0;i<t[0].length;i++)r(i);return n},t}()),R=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},I=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},D=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},T=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(D(arguments[e]));return t},A=function(){function t(t,e,n){void 0===e&&(e=[]),void 0===n&&(n={}),this.url=t,this.statements=e,this.metadata=n,this.resourcesIndex=this.statements.reduce((function(t,e){var n=e.subject.value;return n in t||(t[n]=new S(n)),t[n].addStatement(e),t}),{}),this.resources=Object.values(this.resourcesIndex),this.properties=this.resources.reduce((function(t,e){return T(t,e.properties)}),[])}return t.prototype.isEmpty=function(){return 0===this.statements.length},t.prototype.hasProperty=function(t,e){return t in this.resourcesIndex&&e in this.resourcesIndex[t].propertiesIndex},t.prototype.toJsonLD=function(){return R(this,void 0,void 0,(function(){return I(this,(function(t){return[2,$.createJsonLD(this.statements)]}))}))},t.prototype.resource=function(t){var e;return null!==(e=this.resourcesIndex[t])&&void 0!==e?e:null},t.prototype.clone=function(e){var n=this;void 0===e&&(e=null);var r=new t(e||this.url),i=C.without(Object.getOwnPropertyNames(this),["url"]);return Object.assign(r,i.reduce((function(t,e){return t[e]=n[e],t}),{})),r},t}(),N=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),P=function(){return(P=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},j=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},L=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},k=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},M=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(k(arguments[e]));return t},U=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},V={foaf:"http://xmlns.com/foaf/0.1/",ldp:"http://www.w3.org/ns/ldp#",pim:"http://www.w3.org/ns/pim/space#",posix:"http://www.w3.org/ns/posix/stat#",purl:"http://purl.org/dc/terms/",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",schema:"https://schema.org/",solid:"http://www.w3.org/ns/solid/terms#",xsd:"http://www.w3.org/2001/XMLSchema#"},F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return N(e,t),e}(o.SoukaiError);function B(t,e){if(void 0===e&&(e={}),/^https?:\/\//.test(t))return t;var n=t.indexOf(":");if(-1===n)return t;e=P(P({},V),e);var r=t.substr(0,n);return r in e?e[r]+t.substr(r.length+1):t}var $=new(function(){function t(){}return t.prototype.parseTurtle=function(t,e){var n=this;return void 0===e&&(e={}),new Promise((function(r,i){var o=[],a=new l.Parser({baseIRI:e.baseUrl||"",format:e.format||"text/turtle"}),s={containsRelativeIRIs:!1,describedBy:n.getDescribedBy(e)},u=a._resolveRelativeIRI;a._resolveRelativeIRI=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return s.containsRelativeIRIs=!0,a._resolveRelativeIRI=u,a._resolveRelativeIRI.apply(a,M(t))},a.parse(t,(function(t,n){t?i(new F(t.message)):n?o.push(n):r(new A(e.baseUrl||"",o,s))}))}))},t.prototype.parseJsonLD=function(t){return j(this,void 0,void 0,(function(){return L(this,(function(e){return[2,new Promise((function(e,n){var r=[],i=new s.JsonLdParser({baseIRI:t["@id"]||""});i.on("data",(function(t){r.push(t)})),i.on("error",n),i.on("end",(function(){return e(new A(t["@id"]||null,r))})),i.write(JSON.stringify(t)),i.end()}))]}))}))},t.prototype.createJsonLD=function(t){return j(this,void 0,void 0,(function(){return L(this,(function(e){return t.sort((function(t,e){return t.subject.value.localeCompare(e.subject.value)})),[2,new Promise((function(e,n){var r,i,o=new u.JsonLdSerializer,a="";o.on("data",(function(t){return a+=t})),o.on("error",n),o.on("end",(function(){return e({"@graph":JSON.parse(a)})}));try{for(var s=U(t),l=s.next();!l.done;l=s.next()){var c=l.value;o.write(c)}}catch(t){r={error:t}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}o.end()}))]}))}))},t.prototype.flattenJsonLD=function(t){return j(this,void 0,void 0,(function(){return L(this,(function(e){switch(e.label){case 0:return[4,this.parseJsonLD(t)];case 1:return[2,e.sent().toJsonLD()]}}))}))},t.prototype.getJsonLDProperty=function(t,e){if((e=B(e))in t)return this.getJsonLDPropertyValue(t[e]);if("@context"in t){var n=t["@context"],r=Object.entries(n).find((function(t){var n=k(t,2),r=(n[0],n[1]);return e.startsWith(r)}));if(r){var i=t[("@vocab"===r[0]?"":r[0]+":")+e.substr(r[1].length)];return this.getJsonLDPropertyValue(i)}}},t.prototype.getJsonLDPropertyValue=function(t){if(void 0!==t)return Array.isArray(t)&&1===t.length?t[0]:t},t.prototype.getDescribedBy=function(t){var e,n;if(null===(e=t.headers)||void 0===e?void 0:e.has("Link")){var r=null===(n=t.headers.get("Link"))||void 0===n?void 0:n.match(/<([^>]+)>; rel="describedBy"/i);if(r)return d.resolve(t.baseUrl||"",r[1])}},t}()),G=new(function(){function t(){}return t.prototype.slug=function(t){return t.replace(/[^\d\w]/g,"-").replace(/-+/g,"-").toLowerCase()},t.prototype.fixUrl=function(t){var e=t.indexOf("://")+3;return t.substr(0,e)+t.substr(e).replace(/\/\//g,"/")},t}()),J=new(function(){function t(){}return t.prototype.generate=function(t){return t?(t^16*Math.random()>>t/4).toString(16):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,this.generate)},t}()),K=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),q=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},H=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},W=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},z=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Q=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(z(arguments[e]));return t},X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return K(e,t),e.prototype.resolve=function(){return q(this,void 0,void 0,(function(){var t,e,n,r,i,o,a,s,u,l=this;return H(this,(function(c){switch(c.label){case 0:this.__modelsInSameDocument&&this.__modelsInOtherDocumentIds||(this.__modelsInSameDocument=[],this.__modelsInOtherDocumentIds=this.parent.getAttribute(this.foreignKeyName)),t={};try{for(e=W(this.__modelsInOtherDocumentIds),n=e.next();!n.done;n=e.next())r=n.value,(i=d.parentDirectory(r))in t||(t[i]=[]),t[i].push(r)}catch(t){s={error:t}}finally{try{n&&!n.done&&(u=e.return)&&u.call(e)}finally{if(s)throw s.error}}return[4,Promise.all(Object.keys(t).map((function(e){return l.relatedClass.from(e).all({$in:t[e]})})))];case 1:return o=c.sent(),a=o.reduce((function(t,e){return t.push.apply(t,Q(e)),t}),[]),this.related=Q(this.__modelsInSameDocument,a),[2,this.related]}}))}))},e.prototype.__loadDocumentModels=function(t,e){return q(this,void 0,void 0,(function(){var n,r,i,a,s,u=this;return H(this,(function(l){switch(l.label){case 0:return n=new o.EngineHelper,r=this.parent.getAttribute(this.foreignKeyName),i=this.relatedClass.prepareEngineFilters(),a=e["@graph"].filter((function(t){return-1!==r.indexOf(t["@id"])})).reduce((function(t,e){return t[e["@id"]]={"@graph":[e]},t}),{}),s=this,[4,Promise.all(Object.entries(n.filterDocuments(a,i)).map((function(e){var n=z(e,2),r=n[0],i=n[1];return u.relatedClass.createFromEngineDocument(t,i,r)})))];case 1:return s.__modelsInSameDocument=l.sent(),this.__modelsInOtherDocumentIds=r.filter((function(t){return!u.__modelsInSameDocument.some((function(e){return e.url===t}))})),this.__modelsInOtherDocumentIds.length>0||(this.related=this.__modelsInSameDocument.slice(0)),[2]}}))}))},e}(o.BelongsToManyRelation),Y=function(){return(Y=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Z=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},tt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},et=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},nt=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(et(arguments[e]));return t},rt=new(function(){function t(){}return t.prototype.tap=function(t,e){return e?(e(t),t):this.proxyTap(t)},t.prototype.proxyTap=function(t){var e=new Proxy(t,{get:function(t,n,r){var i=Reflect.get(t,n,r);return"function"!=typeof i?i:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return i.call.apply(i,nt([t],n)),e}}});return e},t}()),it=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},ot=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},at=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},st=function(){function t(){}return t.prototype.deleteModels=function(t){return it(this,void 0,void 0,(function(){var e,n=this;return ot(this,(function(r){switch(r.label){case 0:return e=this.decantDocumentModelsByContainer(t),[4,Promise.all(Object.entries(e).map((function(t){var e=at(t,2),r=e[0],i=e[1];return n.deleteContainerDocumentsModels(r,i)})))];case 1:return r.sent(),[2]}}))}))},t.prototype.decantDocumentModelsByContainer=function(t){var e=this.decantModelsByDocument(t);return Object.entries(e).reduce((function(t,e){var n=at(e,2),r=n[0],i=n[1],o=d.parentDirectory(r);return o in t||(t[o]=[]),t[o].push({documentUrl:r,models:i}),t}),{})},t.prototype.decantModelsByDocument=function(t){return t.reduce((function(t,e){var n=e.getDocumentUrl();return n in t||(t[n]=[]),t[n].push(e),t}),{})},t.prototype.deleteContainerDocumentsModels=function(t,e){return it(this,void 0,void 0,(function(){var n,r=this;return ot(this,(function(i){switch(i.label){case 0:return[4,a.a.requireEngine().readMany(t,{$in:e.map((function(t){return t.documentUrl}))})];case 1:return n=i.sent(),[4,Promise.all(e.map((function(e){var i=e.documentUrl,o=e.models;return r.deleteDocumentModels(n,t,i,o)})))];case 2:return i.sent(),[2]}}))}))},t.prototype.deleteDocumentModels=function(t,e,n,r){return it(this,void 0,void 0,(function(){var i,o;return ot(this,(function(s){switch(s.label){case 0:return i=a.a.requireEngine(),o=r.map((function(t){return t.url})),t[n]["@graph"].some((function(t){return!o.some((function(e){return e===t["@id"]}))}))?[3,2]:[4,i.delete(e,n)];case 1:return s.sent(),[2];case 2:return[4,i.update(e,n,{"@graph":{$updateItems:{$where:{"@id":{$in:o}},$unset:!0}}})];case 3:return s.sent(),[2]}}))}))},t}(),ut=function(){return(ut=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},lt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},ct=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},ft=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},ht=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},dt=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ft(arguments[e]));return t},pt=function(){},yt=function(){function t(t,e){void 0===e&&(e=!0),this.declarations={},this.vocabs=Object.entries(t).map((function(t){var e=ft(t,2),n=e[0];return{name:n,iriPrefix:e[1],propertyPrefix:n+":",used:!1}})),this.compactIRIs=e,this.vocabs[0].name="@vocab",this.vocabs[0].propertyPrefix="",this.vocabs[0].used=!0}return t.prototype.compactIRI=function(t){var e,n;try{for(var r=ht(this.vocabs),i=r.next();!i.done;i=r.next()){var o=i.value;if(t.startsWith(o.iriPrefix))return o.used=!0,""+o.propertyPrefix+t.substr(o.iriPrefix.length)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return t},t.prototype.addDeclaration=function(t,e){this.declarations[t]=e},t.prototype.toJsonLD=function(){var t=this.vocabs.filter((function(t){return t.used})).reduce((function(t,e){var n;return ut(ut({},t),((n={})[e.name]=e.iriPrefix,n))}),{});return ut(ut({},t),this.declarations)},t}(),bt=function(){function t(){}return t.prototype.serializeToJsonLD=function(t,e){var n,r;void 0===t&&(t=!0),e=e||new yt(this.modelClass.rdfContexts);var i={"@context":{},"@type":null};try{for(var o=ht(Object.entries(this.getAttributes())),a=o.next();!a.done;a=o.next()){var s=ft(a.value,2),u=s[0],l=s[1];this.setJsonLDField(i,u,l,e)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return t&&this.includeRelatedJsonLDInstances(i,e),this.setJsonLDTypes(i,e),this.setJsonLDContexts(i,e),i},t.prototype.convertJsonLDToAttributes=function(t){return lt(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,l,c,f,h,d,p;return ct(this,(function(y){switch(y.label){case 0:return[4,$.parseJsonLD(t)];case 1:e=y.sent(),n=e.resource(t["@id"]),r=this.modelClass.fields,(i={})[this.modelClass.primaryKey]=t["@id"];try{for(o=ht(Object.entries(r)),a=o.next();!a.done;a=o.next())s=ft(a.value,2),u=s[0],l=s[1],u!==this.modelClass.primaryKey&&(c=ft(n.getPropertyValues(l.rdfProperty)),f=c[0],h=c.slice(1),void 0!==f&&(i[u]=h.length>0?dt([f],h):f))}catch(t){d={error:t}}finally{try{a&&!a.done&&(p=o.return)&&p.call(o)}finally{if(d)throw d.error}}return[2,i]}}))}))},t.prototype.convertEngineFiltersToJsonLD=function(t){var e={},n=new yt(this.modelClass.rdfContexts),r=dt(this.modelClass.rdfsClasses),i=r.map((function(t){return n.compactIRI(t)})),o=[];r.length>0&&(o.push({$contains:i}),o.push({$contains:r})),1===r.length&&(o.push({$eq:i[0]}),o.push({$eq:r[0]})),t.$in&&(e.$in=t.$in,delete t.$in);var a=this.convertAttributeValuesToJsonLD(t);return o.length>0&&(a["@type"]={$or:o}),Object.keys(a).length>0&&(e["@graph"]={$contains:a}),e},t.prototype.convertEngineUpdatesToJsonLD=function(t){return this.convertAttributeValuesToJsonLD(t)},t.prototype.setJsonLDField=function(t,e,n,r){if(e!==this.modelClass.primaryKey){var i=this.modelClass.fields[e],o=i?i.rdfProperty:this.getDefaultRdfContext()+e;this.setJsonLDProperty(t,r.compactIRIs?r.compactIRI(o):o,n,i)}else t["@id"]=n.toString()},t.prototype.includeRelatedJsonLDInstances=function(t,e){var n,r,i=this,a=this.modelClass.relations.map((function(t){return[t,i.getRelation(t)]})),s=function(n,r){if(!r.loaded||!(r instanceof o.HasManyRelation||r instanceof o.HasOneRelation))return"continue";var i=B(r.foreignKeyName,r.relatedClass.rdfContexts),a=function(t){var n=t.serializeToJsonLD(!1,e);return delete n["@context"],delete n[i],n};t[n]=r instanceof o.HasManyRelation?r.related.map((function(t){return a(t)})):a(r.related),e.addDeclaration(n,{"@reverse":i})};try{for(var u=ht(a),l=u.next();!l.done;l=u.next()){var c=ft(l.value,2);s(c[0],c[1])}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}},t.prototype.setJsonLDTypes=function(t,e){var n=dt(this.modelClass.rdfsClasses).map((function(t){return e.compactIRI(t)}));1===n.length?t["@type"]=n[0]:n.length>0&&(t["@type"]=n)},t.prototype.setJsonLDContexts=function(t,e){t["@context"]=e.toJsonLD()},t.prototype.setJsonLDProperty=function(t,e,n,r){return void 0===r&&(r=null),("object"!=typeof n||1!==Object.keys(n).length||Object.keys(n)[0].startsWith("$"))&&(n=this.castJsonLDValue(n,r)),!(n instanceof pt)&&(t[e]=n,!0)},t.prototype.castJsonLDValue=function(t,e){var n=this;switch(void 0===e&&(e=null),e&&e.type||null){case o.FieldType.Key:return{"@id":t.toString()};case o.FieldType.Date:return{"@type":"http://www.w3.org/2001/XMLSchema#dateTime","@value":new Date(t).toISOString()};case o.FieldType.Array:switch(t.length){case 0:return new pt;case 1:return this.castJsonLDValue(t[0],e.items);default:return t.map((function(t){return n.castJsonLDValue(t,e.items)}))}default:return JSON.parse(JSON.stringify(t))}},t.prototype.convertAttributeValuesToJsonLD=function(t){var e,n,r=new yt(this.modelClass.rdfContexts,!1),i={};try{for(var o=ht(Object.entries(t)),a=o.next();!a.done;a=o.next()){var s=ft(a.value,2),u=s[0],l=s[1];this.setJsonLDField(i,u,l,r)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return i},t}(),gt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},mt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},wt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},_t=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(wt(arguments[e]));return t},Et=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},St=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.__newModels=[],e.useSameDocument=!1,e}return gt(e,t),e.prototype.resolve=function(){return vt(this,void 0,void 0,(function(){var t;return mt(this,(function(e){switch(e.label){case 0:return this.__modelsInSameDocument&&this.__modelsInOtherDocumentIds?[4,this.relatedClass.all({$in:this.__modelsInOtherDocumentIds})]:[2,[]];case 1:return t=e.sent(),this.related=_t(this.__modelsInSameDocument,t),[2,this.related]}}))}))},e.prototype.create=function(t){return void 0===t&&(t={}),vt(this,void 0,void 0,(function(){var e;return mt(this,(function(n){switch(n.label){case 0:return this.assertLoaded("create"),e=this.relatedClass.newInstance(t),[4,this.save(e)];case 1:return n.sent(),[2,e]}}))}))},e.prototype.save=function(t){return vt(this,void 0,void 0,(function(){return mt(this,(function(e){switch(e.label){case 0:return this.assertLoaded("save"),this.add(t),this.useSameDocument?[3,2]:[4,t.save()];case 1:return e.sent(),[3,4];case 2:return this.parent.exists()?[4,this.parent.save()]:[3,4];case 3:e.sent(),e.label=4;case 4:return[2]}}))}))},e.prototype.add=function(t){this.assertLoaded("add"),this.related.includes(t)||this.__newModels.includes(t)||(this.parent.exists()&&this.initializeInverseRelations(t),t.exists()||this.__newModels.push(t),this.related.push(t))},e.prototype.usingSameDocument=function(t){return void 0===t&&(t=!0),this.useSameDocument=t,this},e.prototype.__loadDocumentModels=function(t,e){var n;return vt(this,void 0,void 0,(function(){var r,i,a,s,u,l=this;return mt(this,(function(c){switch(c.label){case 0:return r=new o.EngineHelper,i=null===(n=this.relatedClass.fields[this.foreignKeyName])||void 0===n?void 0:n.rdfProperty,a=this.relatedClass.prepareEngineFilters(),s=e["@graph"].filter((function(t){var e=$.getJsonLDProperty(t,i);return"object"==typeof e&&"@id"in e&&e["@id"]===l.parent.url})).reduce((function(t,e){return t[e["@id"]]={"@graph":[e]},t}),{}),u=this,[4,Promise.all(Object.entries(r.filterDocuments(s,a)).map((function(e){var n=wt(e,2),r=n[0],i=n[1];return l.relatedClass.createFromEngineDocument(t,i,r)})))];case 1:return u.__modelsInSameDocument=c.sent(),this.__modelsInOtherDocumentIds=Object.keys(s).filter((function(t){return!l.__modelsInSameDocument.some((function(e){return e.url===t}))})),this.__modelsInOtherDocumentIds.length>0||(this.related=this.__modelsInSameDocument.slice(0)),[2]}}))}))},e.prototype.initializeInverseRelations=function(t){var e,n,r=this.parent.constructor;try{for(var i=Et(this.relatedClass.relations),a=i.next();!a.done;a=i.next()){var s=a.value,u=t.getRelation(s);u.relatedClass===r&&(u instanceof o.BelongsToManyRelation?(t.setAttribute(u.foreignKeyName,[this.parent.url]),u.related=[this.parent]):u instanceof o.BelongsToOneRelation&&(t.setAttribute(u.foreignKeyName,this.parent.url),u.related=this.parent))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},e.prototype.assertLoaded=function(t){if(!this.loaded){if(this.parent.exists())throw new o.SoukaiError('The "'+t+'" method cannot be called before loading the relationship');this.related=[]}},e}(o.HasManyRelation),xt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ot=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Ct=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Rt=function(t){function e(e,n){return t.call(this,e,n,"url")||this}return xt(e,t),e.prototype.resolve=function(){return Ot(this,void 0,void 0,(function(){var t,e,n;return Ct(this,(function(r){switch(r.label){case 0:return t=this.relatedClass.collection,e=d.parentDirectory(this.parent.url),n=this,[4,this.relatedClass.from(d.parentDirectory(e)).find(e)];case 1:return n.related=r.sent(),this.relatedClass.collection=t,[2,this.related]}}))}))},e}(o.SingleModelRelation),It=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Dt=function(){return(Dt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Tt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},At=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Nt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Pt=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Nt(arguments[e]));return t},jt=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Lt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._sourceDocumentUrl=null,e}return It(e,t),e.from=function(t){return this.collection=t,this},e.at=function(t){return this.from(t)},e.boot=function(e){var n=this;t.boot.call(this,e),this.rdfContexts=Dt(Dt({},this.rdfContexts),{solid:"http://www.w3.org/ns/solid/terms#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",ldp:"http://www.w3.org/ns/ldp#",purl:"http://purl.org/dc/terms/"});var r=this.instance.getDefaultRdfContext();for(var i in this.instance.hasAutomaticTimestamp("createdAt")&&void 0===this.fields.createdAt.rdfProperty&&(this.fields.createdAt.rdfProperty=B("purl:created")),this.instance.hasAutomaticTimestamp("updatedAt")&&void 0===this.fields.updatedAt.rdfProperty&&(this.fields.updatedAt.rdfProperty=B("purl:modified")),this.rdfsClasses=new Set(Pt(this.rdfsClasses).map((function(t){return-1===t.indexOf(":")?r+t:B(t,n.rdfContexts)}))),this.fields)this.fields[i].rdfProperty=B(this.fields[i].rdfProperty||""+r+i,this.rdfContexts);this.fields[this.primaryKey].rdfProperty=null},e.createFromEngineDocument=function(t,e,n){return this.instance.createFromEngineDocument(t,e,n)},e.find=function(t){return Tt(this,void 0,void 0,(function(){var e,n,r,i;return At(this,(function(o){switch(o.label){case 0:e=this.instance.serializeKey(t),n=d.route(e),r=d.parentDirectory(n),this.ensureBooted(),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,a.a.requireEngine().readOne(r,n)];case 2:return i=o.sent(),[2,this.instance.createFromEngineDocument(n,i,e)];case 3:return o.sent(),[2,null];case 4:return[2]}}))}))},e.all=function(e){var n=this;return void 0===e&&(e={}),e=this.prepareEngineFilters(e),this.withCollection((function(){return t.all.call(n,e)}))},e.prepareEngineFilters=function(t){return void 0===t&&(t={}),this.instance.convertEngineFiltersToJsonLD(t)},e.newInstance=function(t,e){return void 0===e&&(e=!1),new this(t,e)},e.newFromJsonLD=function(t,e){return Tt(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,l,c,f;return At(this,(function(h){switch(h.label){case 0:return[4,$.flattenJsonLD(t)];case 1:return n=h.sent(),r=e||d.route(t["@id"]),[4,this.instance.parseEngineDocumentAttributes(r,n,t["@id"])];case 2:return i=h.sent(),[4,(o=new this(i)).loadDocumentModels(r,n)];case 3:h.sent(),o.resetEngineData(),a=function(t){var e=o._relations[t],n=e.getLoadedModels();n.forEach((function(t){return t.resetEngineData()})),e instanceof St&&(n.forEach((function(t){delete t[e.foreignKeyName],e.__newModels.push(t)})),e.__modelsInSameDocument=[])};try{for(s=jt(this.relations),u=s.next();!u.done;u=s.next())l=u.value,a(l)}catch(t){c={error:t}}finally{try{u&&!u.done&&(f=s.return)&&f.call(s)}finally{if(c)throw c.error}}return[2,o]}}))}))},e.withCollection=function(t,e){return void 0===t&&(t=""),Tt(this,void 0,void 0,(function(){var n,r;return At(this,(function(i){switch(i.label){case 0:if(n=this.collection,"string"!=typeof t&&(e=t,t=""),!e)throw new o.SoukaiError("Invalid method given to withCollection (SolidModel internals)");return this.collection=t||n,[4,e()];case 1:return r=i.sent(),this.collection=n,[2,r]}}))}))},e.prototype.save=function(e){var n=this;return this.modelClass.withCollection(e||this.guessCollection(),(function(){return Tt(n,void 0,void 0,(function(){var e;return At(this,(function(n){switch(n.label){case 0:!this.url&&this.modelClass.mintsUrls&&this.mintUrl(),n.label=1;case 1:return n.trys.push([1,3,,5]),[4,t.prototype.save.call(this)];case 2:return n.sent(),[3,5];case 3:if(!((e=n.sent())instanceof o.DocumentAlreadyExists))throw e;return this.url=this.newUniqueUrl(this.url),[4,t.prototype.save.call(this)];case 4:return n.sent(),[3,5];case 5:return[2,this]}}))}))}))},e.prototype.delete=function(){var e=this;return this.modelClass.withCollection(this.guessCollection()||"",(function(){return t.prototype.delete.call(e)}))},e.prototype.mintUrl=function(t,e,n){this.setAttribute(this.modelClass.primaryKey,this.newUrl(t,n)),t&&(this._documentExists=null==e||e)},e.prototype.toJsonLD=function(){return this.serializeToJsonLD()},e.prototype.getIdAttribute=function(){return this.getAttribute("url")},e.prototype.setExists=function(e){this._documentExists=e&&this._documentExists,t.prototype.setExists.call(this,e)},e.prototype.documentExists=function(){return this._documentExists},e.prototype.setDocumentExists=function(t){this._documentExists=t},e.prototype.isDirty=function(e){return e?t.prototype.isDirty.call(this,e):!!t.prototype.isDirty.call(this)||this.getDirtyDocumentModels().length>0},e.prototype.getDocumentUrl=function(){return this.url?d.route(this.url):null},e.prototype.getSourceDocumentUrl=function(){return this._sourceDocumentUrl},e.prototype.getContainerUrl=function(){var t=this.getDocumentUrl();return t?d.parentDirectory(t):null},e.prototype.getSourceContainerUrl=function(){var t=this.getSourceDocumentUrl();return t?d.parentDirectory(t):null},e.prototype.initialize=function(e,n){t.prototype.initialize.call(this,e,n),this._documentExists=n},e.prototype.createFromEngineDocument=function(t,e,n){return Tt(this,void 0,void 0,(function(){var r,i=this;return At(this,(function(o){switch(o.label){case 0:return[4,function(){return Tt(i,void 0,void 0,(function(){var r;return At(this,(function(i){switch(i.label){case 0:return[4,this.parseEngineDocumentAttributes(t,e,n)];case 1:return(r=i.sent())[this.modelClass.primaryKey]=n||t,[2,new this.modelClass(r,!0)]}}))}))}()];case 1:return[4,(r=o.sent()).loadDocumentModels(t,e)];case 2:return o.sent(),[2,rt.tap(r,(function(e){return e._sourceDocumentUrl=t}))]}}))}))},e.prototype.createManyFromEngineDocuments=function(t){return Tt(this,void 0,void 0,(function(){var e,n,r,i=this;return At(this,(function(o){switch(o.label){case 0:return e=Pt(this.modelClass.rdfsClasses),n=function(t){return!e.some((function(e){return!t.isType(e)}))},[4,Promise.all(Object.entries(t).map((function(t){var e=Nt(t,2),r=e[0],o=e[1];return Tt(i,void 0,void 0,(function(){var t,e=this;return At(this,(function(i){switch(i.label){case 0:return[4,$.parseJsonLD(o)];case 1:return t=i.sent(),[2,Promise.all(t.resources.filter(n).map((function(t){return Tt(e,void 0,void 0,(function(){return At(this,(function(e){return[2,this.createFromEngineDocument(r,o,t.url)]}))}))})))]}}))}))})))];case 1:return r=o.sent(),[2,C.flatten(r)]}}))}))},e.prototype.loadDocumentModels=function(t,e){return Tt(this,void 0,void 0,(function(){var n;return At(this,(function(r){switch(r.label){case 0:return n=Object.values(this._relations).filter((function(t){return t instanceof St||t instanceof X})),[4,Promise.all(n.map((function(n){return n.__loadDocumentModels(t,e)})))];case 1:return r.sent(),[2]}}))}))},e.prototype.syncDirty=function(){return Tt(this,void 0,void 0,(function(){var t,e,n,r,i,o,s=this;return At(this,(function(u){switch(u.label){case 0:return t=a.a.requireEngine(),e=this.getSerializedPrimaryKey(),n=this.getDocumentUrl(),r=function(){return t.create(s.modelClass.collection,s.toEngineDocument(),n||void 0)},i=function(){return t.update(s.modelClass.collection,n,{"@graph":{$push:s.serializeToJsonLD(!1)}})},o=function(){return t.update(s.modelClass.collection,n,s.getDirtyEngineDocumentUpdates())},[4,function(){return s._documentExists?s._exists?o():i():r()}()];case 1:return u.sent(),[2,e]}}))}))},e.prototype.cleanDirty=function(){var e,n,r;t.prototype.cleanDirty.call(this),this.getDirtyDocumentModels().map((function(t){return t.cleanDirty()})),this._documentExists=!0;var i=Object.values(this._relations).filter((function(t){return t instanceof St&&t.useSameDocument}));try{for(var o=jt(i),a=o.next();!a.done;a=o.next()){var s=a.value;s.__modelsInSameDocument=s.__modelsInSameDocument||[],(r=s.__modelsInSameDocument).push.apply(r,Pt(s.__newModels)),s.__newModels=[]}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}},e.prototype.deleteModelsFromEngine=function(t){return Tt(this,void 0,void 0,(function(){return At(this,(function(e){switch(e.label){case 0:return[4,this.deleteModels(t)];case 1:return e.sent(),[2]}}))}))},e.prototype.hasMany=function(t,e,n){return new St(this,t,e,n)},e.prototype.belongsToMany=function(t,e,n){return new X(this,t,e,n)},e.prototype.isContainedBy=function(t){return new Rt(this,t)},e.prototype.getDefaultRdfContext=function(){return Object.values(this.modelClass.rdfContexts).shift()||""},e.prototype.toEngineDocument=function(){return{"@graph":Pt([this.serializeToJsonLD(!1)],this.prepareDirtyDocumentModels().map((function(t){return t.serializeToJsonLD(!1)})))}},e.prototype.getDirtyEngineDocumentUpdates=function(){var e=[];if(e.push.apply(e,Pt(this.prepareDirtyDocumentModels().map((function(t){return{$push:t.serializeToJsonLD(!1)}})))),t.prototype.isDirty.call(this)){var n=t.prototype.getDirtyEngineDocumentUpdates.call(this);e.push({$updateItems:{$where:{"@id":this.url},$update:this.convertEngineUpdatesToJsonLD(n)}})}return 1===e.length?{"@graph":e[0]}:{"@graph":{$apply:e}}},e.prototype.parseEngineDocumentAttributes=function(t,e,n){return void 0===n&&(n=null),Tt(this,void 0,void 0,(function(){var r;return At(this,(function(i){return n=n||t,r=e["@graph"].find((function(t){return t["@id"]===n})),[2,this.convertJsonLDToAttributes(r)]}))}))},e.prototype.castAttribute=function(e,n){return n&&n.type===o.FieldType.Array&&!Array.isArray(e)?[e]:t.prototype.castAttribute.call(this,e,n)},e.prototype.newUrl=function(t,e){return(t=null!=t?t:d.resolve(this.modelClass.collection,J.generate()))+"#"+(null!=e?e:this.modelClass.defaultResourceHash)},e.prototype.newUniqueUrl=function(t){return(t=null!=t?t:this.newUrl())+"-"+J.generate()},e.prototype.guessCollection=function(){if(this.url)return d.parentDirectory(this.url)},e.prototype.getDirtyDocumentModels=function(){var t=this,e=this.getDocumentUrl();return C.flatten(Object.values(this._relations).filter((function(t){return t.loaded&&t instanceof St&&t.useSameDocument})).map((function(n){var r,i,o=Pt(n.__newModels),a=function(t){if(!t.isDirty()||t.getDocumentUrl()!==e||o.some((function(e){return e===t})))return"continue";o.push(t)};try{for(var s=jt(n.getLoadedModels()),u=s.next();!u.done;u=s.next())a(u.value)}catch(t){r={error:t}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o.forEach((function(e){return e.setAttribute(n.foreignKeyName,t.url)})),o})))},e.prototype.prepareDirtyDocumentModels=function(){var t=this,e=this.getDirtyDocumentModels();if(0===e.length)return[];this.url||this.mintUrl();var n=this.getDocumentUrl();return e.forEach((function(e){return!e.url&&e.mintUrl(n,t._documentExists,J.generate())})),e},e.primaryKey="url",e.rdfContexts={},e.rdfsClasses=[],e.defaultResourceHash="it",e.mintsUrls=!0,e}(o.Model);!function(t,e){var n,r,i=e.reduce((function(t,e){return Y(Y({},t),Object.getOwnPropertyDescriptors(e.prototype))}),{});try{for(var o=Z(Object.entries(i)),a=o.next();!a.done;a=o.next()){var s=tt(a.value,2),u=s[0],l=s[1];Object.defineProperty(t.prototype,u,l)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}(Lt,[st,bt]);var kt,Mt=Lt,Ut=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Vt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ut(e,t),e.timestamps=["updatedAt"],e}(Mt),Ft=function(t,e){this.resourceUrl=t,this.newResourceUrl=e,this.type=2},Bt=function(t,e,n){this.resourceUrl=t,this.property=e,this.value=n,this.type=1},$t=function(t){this.property=t,this.type=0},Gt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(t){t.RDF="RDF"}(kt||(kt={}));var Jt=function(t){function e(e,n,r){var i=t.call(this,"Malformed "+n+" document found at "+e+" - "+r)||this;return i.documentUrl=e,i.documentFormat=n,i.malformationDetails=r,i}return Gt(e,t),e}(o.SoukaiError),Kt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),qt=function(t){function e(e,n){var r=t.call(this,e+" ("+n.message+")")||this;return r.original=n,r}return Kt(e,t),e}(o.SoukaiError),Ht=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Wt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},zt=new(function(){function t(){}return t.prototype.createMap=function(t,e){var n,r,i={};try{for(var o=Ht(t),a=o.next();!a.done;a=o.next()){var s=a.value;i[s[e]]=s}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i},t.prototype.deepEquals=function(t,e){if(t===e)return!0;var n=typeof t;if(n!==typeof e)return!1;if("object"!==n||null===t||null===e)return!1;if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var r in t)if(!this.deepEquals(t[r],e[r]))return!1;return!0},t.prototype.withoutEmpty=function(t){var e,n,r={};try{for(var i=Ht(Object.entries(t)),o=i.next();!o.done;o=i.next()){var a=Wt(o.value,2),s=a[0],u=a[1];null!=u&&(r[s]=u)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},t}()),Qt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Xt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Yt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Zt=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Yt(arguments[e]));return t},te=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ee=[B("ldp:contains"),B("posix:mtime"),B("posix:size"),B("purl:modified")],ne=[B("ldp:Container"),B("ldp:BasicContainer")],re=function(){function t(t){var e=this;this.fetch=function(n,r){return Qt(e,void 0,void 0,(function(){var e,i;return Xt(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,t(n,r)];case 1:return[2,o.sent()];case 2:throw e=o.sent(),i="object"==typeof n?n.url:n,new qt("Error fetching "+i,e);case 3:return[2]}}))}))}}return t.prototype.createDocument=function(t,e,n){return void 0===e&&(e=null),void 0===n&&(n=[]),Qt(this,void 0,void 0,(function(){var r;return Xt(this,(function(i){return r=B("ldp:Container"),[2,n.some((function(t){return t.resourceUrl===e&&0===t.type&&t.value===r}))?this.createContainerDocument(t,e,n):this.createNonContainerDocument(t,e,n)]}))}))},t.prototype.getDocument=function(t){return Qt(this,void 0,void 0,(function(){var e,n,r;return Xt(this,(function(i){switch(i.label){case 0:return[4,this.fetch(t,{headers:{Accept:"text/turtle"}})];case 1:return 200!==(e=i.sent()).status?[2,null]:[4,e.text()];case 2:n=i.sent(),i.label=3;case 3:return i.trys.push([3,5,,6]),[4,$.parseTurtle(n,{headers:e.headers,baseUrl:t})];case 4:return[2,i.sent()];case 5:throw r=i.sent(),new Jt(t,kt.RDF,r.message);case 6:return[2]}}))}))},t.prototype.getDocuments=function(t,e){return void 0===e&&(e=!1),Qt(this,void 0,void 0,(function(){var n,i;return Xt(this,(function(o){switch(o.label){case 0:return o.trys.push([0,5,,6]),e?[4,this.getContainerDocuments(t)]:[3,2];case 1:return n=o.sent(),[3,4];case 2:return[4,this.getNonContainerDocumentsUsingGlobbing(t)];case 3:n=o.sent(),o.label=4;case 4:return[2,n];case 5:if((i=o.sent())instanceof F)throw new Jt(t,kt.RDF,i.message);return r.error(i),[2,[]];case 6:return[2]}}))}))},t.prototype.updateDocument=function(t,e){var n;return Qt(this,void 0,void 0,(function(){var r;return Xt(this,(function(i){switch(i.label){case 0:return 0===e.length?[2]:[4,this.getDocument(t)];case 1:if(null===(r=i.sent()))throw new o.DocumentNotFound(t);return this.processChangeUrlOperations(r,e),this.processUpdatePropertyOperations(r,e),(null===(n=r.resource(t))||void 0===n?void 0:n.isType(B("ldp:Container")))?[4,this.updateContainerDocument(r,e)]:[3,3];case 2:return i.sent(),[3,5];case 3:return[4,this.updateNonContainerDocument(r,e)];case 4:i.sent(),i.label=5;case 5:return[2]}}))}))},t.prototype.deleteDocument=function(t){var e;return Qt(this,void 0,void 0,(function(){var n,r,i,o=this;return Xt(this,(function(a){switch(a.label){case 0:return[4,this.getDocument(t)];case 1:return null===(n=a.sent())?[2]:(null===(e=n.resource(t))||void 0===e?void 0:e.isType(B("ldp:Container")))?[4,Promise.all([this.getDocuments(t,!0),this.getDocuments(t)])]:[3,4];case 2:return r=a.sent(),[4,Promise.all(C.flatten(r).map((function(t){return o.deleteDocument(t.url)})))];case 3:a.sent(),a.label=4;case 4:return[4,this.fetch(t,{method:"DELETE"})];case 5:return i=a.sent(),this.assertSuccessfulResponse(i,"Error deleting document at "+t),[2]}}))}))},t.prototype.documentExists=function(t){return Qt(this,void 0,void 0,(function(){var e;return Xt(this,(function(n){switch(n.label){case 0:return[4,this.fetch(t,{headers:{Accept:"text/turtle"}})];case 1:return 200!==(e=n.sent()).status?[3,3]:[4,e.text()];case 2:return[2,n.sent().length>0];case 3:if(404===e.status)return[2,!1];throw new o.SoukaiError("Couldn't determine if document at "+t+" exists, got "+e.status+" response");case 4:return[2]}}))}))},t.prototype.createContainerDocument=function(t,e,n){return Qt(this,void 0,void 0,(function(){var r,i;return Xt(this,(function(a){switch(a.label){case 0:if(e&&!e.startsWith(t))throw new o.SoukaiError("Explicit document url should start with the parent url");if(e&&!e.endsWith("/"))throw new o.SoukaiError("Container urls must end with a trailing slash, given "+e);return r=e?"at "+e:"under "+t,[4,this.fetch(t,{method:"POST",headers:zt.withoutEmpty({"Content-Type":"text/turtle",Link:'<http://www.w3.org/ns/ldp#BasicContainer>; rel="type"',Slug:e?d.directoryName(e):null}),body:w.toTurtle(this.withoutReservedContainerProperties(e,n),e)})];case 1:return i=a.sent(),this.assertSuccessfulResponse(i,"Error creating container "+r),[2,e||d.resolve(t,i.headers.get("Location")||"")]}}))}))},t.prototype.createNonContainerDocument=function(t,e,n){return Qt(this,void 0,void 0,(function(){var r,i;return Xt(this,(function(a){switch(a.label){case 0:return e?[3,2]:[4,this.fetch(t,{headers:{"Content-Type":"text/turtle"},method:"POST",body:w.toTurtle(n,e)})];case 1:return r=a.sent(),this.assertSuccessfulResponse(r,"Error creating document under "+t),[2,d.resolve(t,r.headers.get("Location")||"")];case 2:if(!e.startsWith(t))throw new o.SoukaiError("A minted document url should start with the parent url");return[4,this.fetch(e,{method:"PATCH",headers:{"Content-Type":"application/sparql-update","If-None-Match":"*"},body:"INSERT DATA { "+w.toTurtle(n,e)+" }"})];case 3:return i=a.sent(),this.assertSuccessfulResponse(i,"Error creating document at "+e),[2,e]}}))}))},t.prototype.getContainerDocuments=function(t){var e;return Qt(this,void 0,void 0,(function(){var n,r,i,o=this;return Xt(this,(function(a){switch(a.label){case 0:return[4,this.fetch(t,{headers:{Accept:"text/turtle"}})];case 1:return n=a.sent(),this.assertSuccessfulResponse(n,"Error getting container documents from "+t),[4,n.text()];case 2:return r=a.sent(),[4,$.parseTurtle(r,{baseUrl:t})];case 3:return i=a.sent(),[4,Promise.all((null===(e=i.resource(t))||void 0===e?void 0:e.getPropertyValues("ldp:contains").map((function(t){return i.resource(t)})).filter((function(t){return null!==t&&t.isType("ldp:Container")})).map((function(t){return o.getDocument(t.url)})))||[])];case 4:return[2,a.sent()]}}))}))},t.prototype.getNonContainerDocumentsUsingGlobbing=function(t){return Qt(this,void 0,void 0,(function(){var e,n,r,i;return Xt(this,(function(o){switch(o.label){case 0:return[4,this.fetch(t+"*",{headers:{Accept:"text/turtle"}})];case 1:return e=o.sent(),this.assertSuccessfulResponse(e,"Error getting container documents using globbing from "+t),[4,e.text()];case 2:return n=o.sent(),[4,$.parseTurtle(n,{baseUrl:t})];case 3:return r=o.sent(),i=r.statements.reduce((function(t,e){var n=d.clean(e.subject.value,{fragment:!1});return n in t||(t[n]=[]),t[n].push(e),t}),{}),[2,Object.entries(i).map((function(t){var e=Yt(t,2),n=e[0],r=e[1];return new A(n,r)}))]}}))}))},t.prototype.updateContainerDocument=function(t,e){return Qt(this,void 0,void 0,(function(){var n,r;return Xt(this,(function(i){switch(i.label){case 0:return n=function(e){return new Bt(t.url,e)},r=function(e){return new Bt(t.url,B("rdf:type"),e)},e.push.apply(e,Zt(ee.map(n))),e.push.apply(e,Zt(ne.map(r))),[4,this.updateNonContainerDocument(t.clone(t.metadata.describedBy||t.url+".meta"),e)];case 1:return i.sent(),[2]}}))}))},t.prototype.updateNonContainerDocument=function(t,e){return Qt(this,void 0,void 0,(function(){var n,r,i,o,a,s;return Xt(this,(function(u){switch(u.label){case 0:return n=Yt(function(t){return t.reduce((function(t,e){switch(e.type){case 0:t[0].push(e.property);break;case 1:t[1].push(C.filter([e.resourceUrl,e.property,e.value]))}return t}),[[],[]])}(e),2),r=n[0],i=n[1],o=w.toTurtle(r,t.url),a=w.toTurtle(t.properties.filter((function(t){return i.some((function(e){var n=Yt(e,3),r=n[0],i=n[1],o=n[2];return!(r!==t.resourceUrl||i&&i!==t.name||o&&o!==t.value)}))})),t.url),[4,this.fetch(t.url,{method:"PATCH",headers:{"Content-Type":"application/sparql-update"},body:C.filter([a.length>0&&"DELETE DATA { "+a+" }",o.length>0&&"INSERT DATA { "+o+" }"]).join(" ; ")})];case 1:return s=u.sent(),this.assertSuccessfulResponse(s,"Error updating document at "+t.url),[2]}}))}))},t.prototype.withoutReservedContainerProperties=function(t,e){return e.filter((function(e){return e.resourceUrl!==t||!function(t){return C.contains(ee,t.name)}(e)&&!function(t){return 0===t.type&&C.contains(ne,t.value)}(e)}))},t.prototype.processChangeUrlOperations=function(t,e){var n,r,i=function(t){var e;return t.reduce((function(t,e){return t[e.type].push(e),t}),((e={})[0]=[],e[1]=[],e[2]=[],e))}(e),o=function(n){var r=t.resource(n.resourceUrl);if(!r)return"continue";var o=i[0].filter((function(t){return t.property.resourceUrl===n.resourceUrl})),a=i[1].filter((function(t){return t.resourceUrl===n.resourceUrl}));o.forEach((function(t){return t.property=t.property.clone(n.newResourceUrl)})),a.forEach((function(t){return t.resourceUrl=n.newResourceUrl})),e.push(new Bt(n.resourceUrl)),e.push.apply(e,Zt(r.properties.filter((function(t){return!o.some((function(e){return e.property.name===t.name}))&&!a.some((function(e){return!e.property||e.property===t.name}))})).map((function(t){return new $t(t.clone(n.newResourceUrl))})))),C.removeItem(e,n)};try{for(var a=te(i[2]),s=a.next();!s.done;s=a.next())o(s.value)}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}},t.prototype.processUpdatePropertyOperations=function(t,e){var n,r,i=e.filter((function(e){return 0===e.type&&0!==e.property.type&&t.hasProperty(e.property.resourceUrl,e.property.name)}));try{for(var o=te(i),a=o.next();!a.done;a=o.next()){var s=a.value.property;e.push(new Bt(s.resourceUrl,s.name))}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.assertSuccessfulResponse=function(t,e){if(2!==Math.floor(t.status/100))throw new o.SoukaiError(e+", returned "+t.status+" status code")},t}(),ie=function(){return(ie=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},oe=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},ae=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},se=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},ue=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(se(arguments[e]));return t},le=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ce=function(){function t(t,e){void 0===e&&(e={}),this.listeners=[],this.helper=new o.EngineHelper,this.client=new re(t),this.config=ie({globbingBatchSize:5},e)}return t.prototype.create=function(t,e,n){return oe(this,void 0,void 0,(function(){var r,i;return ae(this,(function(a){switch(a.label){case 0:return this.validateJsonLDGraph(e),(r=n)?[4,this.client.documentExists(n)]:[3,2];case 1:r=a.sent(),a.label=2;case 2:if(r)throw new o.DocumentAlreadyExists(n);return[4,this.getJsonLDGraphProperties(e)];case 3:return i=a.sent(),[4,this.client.createDocument(t,n,i)];case 4:return[2,a.sent()]}}))}))},t.prototype.readOne=function(t,e){return oe(this,void 0,void 0,(function(){var t,n;return ae(this,(function(r){switch(r.label){case 0:return[4,this.client.getDocument(e)];case 1:if(null===(t=r.sent()))throw new o.DocumentNotFound(e);return n=this.convertToEngineDocument(t),this.emit("onRDFDocumentLoaded",t.url,t.metadata),[2,n]}}))}))},t.prototype.readMany=function(t,e){return void 0===e&&(e={}),oe(this,void 0,void 0,(function(){var n,r,i=this;return ae(this,(function(o){switch(o.label){case 0:return[4,this.getDocumentsForFilters(t,e)];case 1:return n=o.sent(),r=n.reduce((function(t,e){return t[e.url]=i.convertToEngineDocument(e),i.emit("onRDFDocumentLoaded",e.url,e.metadata),t}),{}),[2,this.helper.filterDocuments(r,e)]}}))}))},t.prototype.update=function(t,e,n){return oe(this,void 0,void 0,(function(){var t;return ae(this,(function(r){switch(r.label){case 0:return[4,this.extractJsonLDGraphUpdate(n)];case 1:return t=r.sent(),[4,this.client.updateDocument(e,t)];case 2:return r.sent(),[2]}}))}))},t.prototype.delete=function(t,e){return oe(this,void 0,void 0,(function(){return ae(this,(function(t){switch(t.label){case 0:return[4,this.client.deleteDocument(e)];case 1:return t.sent(),[2]}}))}))},t.prototype.addListener=function(t){this.listeners.push(t)},t.prototype.removeListener=function(t){var e=this.listeners.indexOf(t);-1!==e&&this.listeners.splice(e,1)},t.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.listeners.forEach((function(n){var r;return null===(r=n[t])||void 0===r?void 0:r.call.apply(r,ue([n],e))}))},t.prototype.getDocumentsForFilters=function(t,e){return oe(this,void 0,void 0,(function(){var n,r;return ae(this,(function(i){switch(i.label){case 0:return n=this.extractJsonLDGraphTypes(e),e.$in?[4,this.getDocumentsFromUrls(e.$in,n)]:[3,2];case 1:return r=i.sent(),[3,4];case 2:return[4,this.getContainerDocuments(t,n)];case 3:r=i.sent(),i.label=4;case 4:return[2,r]}}))}))},t.prototype.getDocumentsFromUrls=function(t,e){return oe(this,void 0,void 0,(function(){var n,r,i,o=this;return ae(this,(function(a){switch(a.label){case 0:return n=t.reduce((function(t,e){var n,r=d.parentDirectory(e);return ie(ie({},t),((n={})[r]=ue(t[r]||[],[e]),n))}),{}),r=Object.entries(n).map((function(t){var n=se(t,2),r=n[0],i=n[1];return oe(o,void 0,void 0,(function(){var t,n=this;return ae(this,(function(o){switch(o.label){case 0:return null!==this.config.globbingBatchSize&&i.length>=this.config.globbingBatchSize?[2,this.getContainerDocuments(r,e)]:(t=i.map((function(t){return n.client.getDocument(t)})),[4,Promise.all(t)]);case 1:return[2,o.sent().filter((function(t){return null!=t}))]}}))}))})),[4,Promise.all(r)];case 1:return i=a.sent(),[2,C.flatten(i)]}}))}))},t.prototype.getContainerDocuments=function(t,e){return oe(this,void 0,void 0,(function(){return ae(this,(function(n){switch(n.label){case 0:return[4,this.client.getDocuments(t,-1!==e.indexOf(B("ldp:Container")))];case 1:return[2,n.sent()]}}))}))},t.prototype.convertToEngineDocument=function(t){return{"@graph":t.resources.map((function(t){var e,n,r={},i=function(t,e){var n=se(e),i=n[0],o=n.slice(1),a=t,s=function(t){return t};switch(i.type){case 0:a="@type";break;case 1:s=function(t){return{"@id":t}};break;case 2:s=function(t){return t instanceof Date?{"@type":"http://www.w3.org/2001/XMLSchema#dateTime","@value":t.toISOString()}:t}}r[a]=0===o.length?s(i.value):ue([i],o).map((function(t){return s(t.value)}))};try{for(var o=le(Object.entries(t.propertiesIndex)),a=o.next();!a.done;a=o.next()){var s=se(a.value,2);i(s[0],s[1])}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r["@id"]=t.url,r}))}},t.prototype.validateJsonLDGraph=function(t){if(!Array.isArray(t["@graph"]))throw new o.SoukaiError("Invalid JSON-LD graph provided for SolidEngine. Are you using a model that isn't a SolidModel?")},t.prototype.extractJsonLDGraphUpdate=function(t){return oe(this,void 0,void 0,(function(){var e,n,r=this;return ae(this,(function(i){switch(i.label){case 0:if(!this.isJsonLDGraphUpdate(t))throw new o.SoukaiError("Invalid JSON-LD graph updates provided for SolidEngine. Are you using a model that isn't a SolidModel?");return e=[],t["@graph"].$updateItems&&e.push.apply(e,ue(C.flatten(C.create(t["@graph"].$updateItems).map((function(t){return r.extractJsonLDGraphItemsUpdate(t)}))))),t["@graph"].$push?[4,this.extractJsonLDGraphItemPush(t["@graph"].$push)]:[3,2];case 1:n=i.sent(),e.push.apply(e,ue(n)),i.label=2;case 2:return[2,e]}}))}))},t.prototype.extractJsonLDGraphItemsUpdate=function(t){var e,n,r=t.$where,i=t.$update,a=t.$unset;if(!r||!("@id"in r))throw new o.SoukaiError("Invalid JSON-LD graph updates provided for SolidEngine. Are you using a model that isn't a SolidModel?");if(a)return r["@id"].$in.map((function(t){return new Bt(t)}));var s=r["@id"],u=i,l=[];try{for(var c=le(Object.entries(u)),f=c.next();!f.done;f=c.next()){var h=se(f.value,2),d=h[0],p=h[1];if(null===p)throw new o.SoukaiError("SolidEngine doesn't support setting properties to null, delete");"object"==typeof p&&"$unset"in p?l.push(new Bt(s,d)):"object"==typeof p&&"@id"in p?l.push(new $t(w.reference(s,d,p["@id"]))):"object"==typeof p&&"@type"in p&&"http://www.w3.org/2001/XMLSchema#dateTime"===p["@type"]?l.push(new $t(w.literal(s,d,new Date(p["@value"])))):"@id"!==d?"@type"!==d?l.push(new $t(w.literal(s,d,p))):l.push(new $t(w.type(s,p))):l.push(new Ft(s,p))}}catch(t){e={error:t}}finally{try{f&&!f.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}return l},t.prototype.extractJsonLDGraphItemPush=function(t){return oe(this,void 0,void 0,(function(){return ae(this,(function(e){switch(e.label){case 0:return[4,this.getJsonLDGraphProperties(t)];case 1:return[2,e.sent().map((function(t){return new $t(t)}))]}}))}))},t.prototype.extractJsonLDGraphTypes=function(t){if(!this.isJsonLDGraphTypesFilter(t))return[];var e=t["@graph"].$contains["@type"].$or.reduce((function(t,e){return"$contains"in e&&t.push.apply(t,ue(e.$contains)),"$eq"in e&&t.push(e.$eq),t}),[]);return C.unique(e.filter((function(t){return t.startsWith("http")})))},t.prototype.getJsonLDGraphProperties=function(t){return oe(this,void 0,void 0,(function(){return ae(this,(function(e){switch(e.label){case 0:return[4,$.parseJsonLD(t)];case 1:return[2,e.sent().properties]}}))}))},t.prototype.isJsonLDGraphUpdate=function(t){return"object"==typeof t["@graph"]&&("object"==typeof t["@graph"].$updateItems||"object"==typeof t["@graph"].$push)},t.prototype.isJsonLDGraphTypesFilter=function(t){return"object"==typeof t["@graph"]&&"object"==typeof t["@graph"].$contains&&"object"==typeof t["@graph"].$contains["@type"]&&Array.isArray(t["@graph"].$contains["@type"].$or)},t}(),fe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),he=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},de=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},pe=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},ye=function(t){function e(e){return t.call(this,e,Vt,"resourceUrls")||this}return fe(e,t),Object.defineProperty(e.prototype,"container",{get:function(){return this.parent},enumerable:!0,configurable:!0}),e.prototype.resolve=function(){return he(this,void 0,void 0,(function(){var e,n=this;return de(this,(function(r){switch(r.label){case 0:return a.a.engine instanceof ce?[2,t.prototype.resolve.call(this)]:[4,a.a.engine.readMany(this.container.getDocumentUrl())];case 1:return e=r.sent(),this.related=Object.entries(e).map((function(t){var e=pe(t,2),r=e[0],i=e[1];return new Vt({url:r,updatedAt:n.getLatestUpdateDate(i["@graph"])})})),[2,this.related]}}))}))},e.prototype.getLatestUpdateDate=function(t){var e=t.reduce((function(t,e){var n,r,i,o,a=(null!==(o=null!==(i=null!==(r=null!==(n=e["purl:modified"])&&void 0!==n?n:e["http://purl.org/dc/terms/modified"])&&void 0!==r?r:e["purl:created"])&&void 0!==i?i:e["http://purl.org/dc/terms/created"])&&void 0!==o?o:{"@value":0})["@value"],s=new Date(a).getTime();return Math.max(t,s)}),0);return new Date(e)},e}(X),be=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ge=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},ve=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},me=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},we=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(me(arguments[e]));return t},_e=function(t){function e(e,n){return t.call(this,e,n,"resourceUrls","url")||this}return be(e,t),e.prototype.resolve=function(){return ge(this,void 0,void 0,(function(){var t;return ve(this,(function(e){switch(e.label){case 0:return t=this,[4,this.relatedClass.from(this.parent.url).all({$in:this.parent.resourceUrls})];case 1:return t.related=e.sent(),[2,this.related]}}))}))},e.prototype.create=function(t){return void 0===t&&(t={}),ge(this,void 0,void 0,(function(){var e;return ve(this,(function(n){switch(n.label){case 0:return e=this.relatedClass.newInstance(t),[4,this.save(e)];case 1:return n.sent(),[2,e]}}))}))},e.prototype.save=function(t){return ge(this,void 0,void 0,(function(){return ve(this,(function(e){switch(e.label){case 0:if(!this.parent.exists())throw new o.SoukaiError("Cannot save a model because the container doesn't exist");return[4,t.save(this.parent.url)];case 1:return e.sent(),a.a.engine instanceof ce?[3,3]:[4,this.parent.update({resourceUrls:we(this.parent.resourceUrls,[t.getDocumentUrl()])})];case 2:e.sent(),e.label=3;case 3:return this.loaded&&this.related.push(t),[2]}}))}))},e}(o.BelongsToManyRelation),Ee=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Se=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},xe=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Oe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ee(e,t),e.boot=function(e){t.boot.call(this,e),this.rdfsClasses.add(B("ldp:Container")),this.fields.resourceUrls={type:o.FieldType.Array,required:!1,rdfProperty:"http://www.w3.org/ns/ldp#contains",items:{type:o.FieldType.Key}},Vt.boot("SolidDocument")},e.prototype.documentsRelationship=function(){return new ye(this)},e.prototype.save=function(e){return Se(this,void 0,void 0,(function(){return xe(this,(function(n){switch(n.label){case 0:return[4,t.prototype.save.call(this,e)];case 1:return n.sent(),this.wasRecentlyCreated()&&!this.isRelationLoaded("documents")&&this.setRelationModels("documents",[]),[2,this]}}))}))},e.prototype.contains=function(t){return new _e(this,t)},e.prototype.newUrl=function(){var t=this.hasAttribute("name")?G.slug(this.getAttribute("name")):J.generate();return d.resolveDirectory(this.modelClass.collection,t)},e.prototype.newUniqueUrl=function(t){t=null!=t?t:this.newUrl();var e=J.generate(),n=d.directoryName(t);return d.resolveDirectory(d.parentDirectory(t),n+"-"+e)},e}(Mt),Ce=new(function(){function t(){}return t.prototype.loadSolidModels=function(){a.a.loadModels({SolidDocument:Vt})},t}());e.default=Ce}])}))},7696:function(t,e,n){var r=n(476);n(1703),n(6699),n(2801),function(e,n){t.exports=n()}(window,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var i,o=(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=this.constructor,r=t.call(this,e)||this;return r.name=n.name,Object.setPrototypeOf(r,n.prototype),r}return o(e,t),e}(Error),s=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},u=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},l=new(function(){function t(){this._bootedModels={}}return t.prototype.useEngine=function(t){this._engine=t},t.prototype.model=function(t){return this._bootedModels[t]},t.prototype.loadModel=function(t,e){t in e||(e.boot(t),this._bootedModels[t]=e)},t.prototype.loadModels=function(t){for(var e in t)t.hasOwnProperty(e)&&this.loadModel(e,t[e])},t.prototype.requireEngine=function(){if(!this._engine)throw new a("Engine must be initialized before performing any operations. Learn more at https://soukai.js.org/guide/engines.html");return this._engine},t.prototype.closeConnections=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return this._engine&&"closeConnections"in this._engine?[4,this._engine.closeConnections()]:[2];case 1:return t.sent(),[2]}}))}))},Object.defineProperty(t.prototype,"engine",{get:function(){return this._engine},enumerable:!0,configurable:!0}),t}()),c=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f=function(t){function e(e,n){var r=t.call(this,"Model "+e+": "+n+". Learn more at https://soukai.js.org/guide/defining-models.html")||this;return r.modelName=e,r}return c(e,t),e}(a),h=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};function d(t){for(var e in t=h({},t))t.hasOwnProperty(e)&&null!==t[e]&&"object"==typeof t[e]&&t[e].constructor===Object&&(t[e]=d(t[e]));return t}function p(t,e){if(t===e)return!0;var n=typeof t;if(n!==typeof e)return!1;if("object"!==n||null===t||null===e)return!1;if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var r in t)if(!p(t[r],e[r]))return!1;return!0}function y(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}var b={deepClone:d,deepEquals:p,isObject:y},g=new(function(){function t(){}return t.prototype.contains=function(t,e){return-1!==t.indexOf(e)},t.prototype.flatten=function(t){return"flat"in t?t.flat():[].concat.apply([],t)},t.prototype.unique=function(t){var e=new Set(t),n=[];return e.forEach((function(t){return n.push(t)})),n},t.prototype.withoutIndexes=function(t,e){var n=this;return t.map((function(t,e){return[t,e]})).filter((function(t){t[0];var r=t[1];return!n.contains(e,r)})).map((function(t){return t[0]}))},t}());function v(t){return t.split(/_|\s/).map((function(t){return t.length>0?t.substr(0,1).toUpperCase()+t.substr(1):t})).join("")}function m(t){return t.split(/_|\s|(?=[A-Z])/).map((function(t,e){return 0===t.length?t:0===e?t.toLowerCase():t.substr(0,1).toUpperCase()+t.substr(1).toLowerCase()})).join("")}var w,_=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},E=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},S=function(){function t(t,e,n,r){this.related=null,this.deleteStrategy=null,this.parent=t,this.relatedClass=e,this.foreignKeyName=n,this.localKeyName=r||e.primaryKey}return Object.defineProperty(t.prototype,"loaded",{get:function(){return null!==this.related},enumerable:!0,configurable:!0}),t.prototype.getModels=function(){return _(this,void 0,void 0,(function(){return E(this,(function(t){switch(t.label){case 0:return this.loaded?[3,2]:[4,this.resolve()];case 1:t.sent(),t.label=2;case 2:return[2,this.getLoadedModels()]}}))}))},t.prototype.getLoadedModels=function(){return Array.isArray(this.related)?this.related:this.related?[this.related]:[]},t.prototype.unload=function(){this.related=null},t.prototype.onDelete=function(t){return this.deleteStrategy=t,this},t}(),x=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),O=function(t){function e(e,n,r,i){return t.call(this,e,n,r||m(n.name+"_"+n.primaryKey+"s"),i)||this}return x(e,t),e}(S),C=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),R=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},I=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},D=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return C(e,t),e.prototype.resolve=function(){return R(this,void 0,void 0,(function(){var t,e,n,r;return I(this,(function(i){switch(i.label){case 0:return t=this.parent.getAttribute(this.foreignKeyName),e=this,this.localKeyName!==this.relatedClass.primaryKey?[3,2]:[4,this.relatedClass.all({$in:t})];case 1:return n=i.sent(),[3,4];case 2:return[4,this.relatedClass.all((r={},r[this.localKeyName]={$or:t.map((function(t){return{$eq:t}})).concat(t.map((function(t){return{$contains:t}})))},r))];case 3:n=i.sent(),i.label=4;case 4:return e.related=n,[2,this.related]}}))}))},e}(O),T=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),A=function(t){function e(e,n,r,i){return t.call(this,e,n,r||m(n.name+"_"+n.primaryKey),i)||this}return T(e,t),e}(S),N=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),P=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},j=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},L=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return N(e,t),e.prototype.resolve=function(){return P(this,void 0,void 0,(function(){var t,e,n,r;return j(this,(function(i){switch(i.label){case 0:return t=this.parent.getAttribute(this.foreignKeyName),e=this,this.localKeyName!==this.relatedClass.primaryKey?[3,2]:[4,this.relatedClass.find(t)];case 1:return n=i.sent(),[3,4];case 2:return[4,this.relatedClass.first((r={},r[this.localKeyName]=t,r))];case 3:n=i.sent(),i.label=4;case 4:return e.related=n,[2,this.related]}}))}))},e}(A),k=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),M=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},U=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},V=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return k(e,t),e.prototype.resolve=function(){return M(this,void 0,void 0,(function(){var t,e,n;return U(this,(function(r){switch(r.label){case 0:return t=this.parent.getAttribute(this.localKeyName),e=this,[4,this.relatedClass.all((n={},n[this.foreignKeyName]={$or:[{$eq:t},{$contains:t}]},n))];case 1:return e.related=r.sent(),[2,this.related]}}))}))},e}(O),F=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),B=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},$=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.resolve=function(){return B(this,void 0,void 0,(function(){var t,e,n;return $(this,(function(r){switch(r.label){case 0:return t=this.parent.getAttribute(this.localKeyName),e=this,[4,this.relatedClass.first((n={},n[this.foreignKeyName]={$or:[{$eq:t},{$contains:t}]},n))];case 1:return e.related=r.sent(),[2,this.related]}}))}))},e}(A),J=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},K=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},q=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};!function(t){t.Number="number",t.String="string",t.Boolean="boolean",t.Array="array",t.Object="object",t.Date="date",t.Key="key"}(w||(w={}));var H=Object.values(w),W=["createdAt","updatedAt"],z=function(){function t(t,e){if(void 0===t&&(t={}),void 0===e&&(e=!1),!("__pureInstance"in t))return this.modelClass.ensureBooted(),this.initialize(t,e),this._proxy}return Object.defineProperty(t,"instance",{get:function(){return new this},enumerable:!0,configurable:!0}),Object.defineProperty(t,"pureInstance",{get:function(){return new this({__pureInstance:!0})},enumerable:!0,configurable:!0}),t.boot=function(e){var n=this,r={};if(void 0===n.collection)n.collection=e.toLowerCase()+"s";else if("string"!=typeof n.collection)throw new f(e,"Collection name not defined or invalid format");if("boolean"==typeof n.timestamps||void 0===n.timestamps)if(void 0===n.timestamps||n.timestamps){for(var i=0,o=W;i<o.length;i++)r[u=o[i]]={type:w.Date,required:!1};n.timestamps=W}else n.timestamps=[];else{if(!Array.isArray(n.timestamps))throw new f(e,"Invalid timestamps definition");for(var a=0,s=n.timestamps;a<s.length;a++){var u=s[a];if(-1===W.indexOf(u))throw new f(e,"Invalid timestamp field defined ("+u+")");r[u]={type:w.Date,required:!1}}}if(void 0!==n.fields)for(var u in n.fields)if(n.fields.hasOwnProperty(u)&&(r[u]=Q(e,u,n.fields[u]),-1!==n.timestamps.indexOf(u)&&(r[u].type!==w.Date||r[u].required)))throw new f(e,"Field "+u+" definition must be type date and not required because it is used an automatic timestamp. Learn more at https://soukai.js.org/guide/defining-models.html#automatic-timestamps");n.primaryKey in r||(r[n.primaryKey]={type:w.Key,required:!1});for(var l=Object.getOwnPropertyNames(n.pureInstance),c=[],h=Object.getPrototypeOf(n.pureInstance);h!==t.prototype;){l.push.apply(l,h.constructor.classFields);for(var d=0,p=Object.getOwnPropertyNames(h);d<p.length;d++){var y=p[d];y.endsWith("Relationship")&&"function"==typeof n.pureInstance[y]&&c.push(y.substring(0,y.length-12))}h=Object.getPrototypeOf(h)}n.classFields=g.unique(l),n.relations=g.unique(c),n.fields=r,n.modelName=e},t.create=function(t){return void 0===t&&(t={}),new this(t).save()},t.createFromEngineDocument=function(t,e){return this.instance.createFromEngineDocument(t,e)},t.createManyFromEngineDocuments=function(t){return this.instance.createManyFromEngineDocuments(t)},t.find=function(t){var e=this;return this.ensureBooted(),l.requireEngine().readOne(this.collection,this.instance.serializeKey(t)).then((function(n){return e.createFromEngineDocument(t,n)})).catch((function(){return null}))},t.all=function(t){return K(this,void 0,void 0,(function(){var e;return q(this,(function(n){switch(n.label){case 0:return this.ensureBooted(),[4,l.requireEngine().readMany(this.collection,t)];case 1:return e=n.sent(),[4,this.createManyFromEngineDocuments(e)];case 2:return[2,n.sent()]}}))}))},t.first=function(t){return K(this,void 0,void 0,(function(){return q(this,(function(e){switch(e.label){case 0:return[4,this.all(t)];case 1:return[2,e.sent()[0]||null]}}))}))},t.ensureBooted=function(){if(void 0===this.modelName)throw new a("Model has not been booted (did you forget to call Soukai.loadModel?) Learn more at https://soukai.js.org/guide/defining-models.html")},Object.defineProperty(t.prototype,"modelClass",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),t.prototype.update=function(t){for(var e in void 0===t&&(t={}),t=this.castAttributes(t,this.modelClass.fields))this.setAttribute(e,t[e]);return this.hasAutomaticTimestamp("updatedAt")&&this.touch(),this.save()},t.prototype.hasRelation=function(t){return-1!==this.modelClass.relations.indexOf(t)},t.prototype.getRelation=function(t){return this._relations[t]||null},t.prototype.loadRelation=function(t){return this.requireRelation(t).resolve()},t.prototype.loadRelationIfUnloaded=function(t){return K(this,void 0,void 0,(function(){return q(this,(function(e){return[2,this.isRelationLoaded(t)?this.getRelationModels(t):this.loadRelation(t)]}))}))},t.prototype.unloadRelation=function(t){this.requireRelation(t).unload()},t.prototype.getRelationModels=function(t){return this.requireRelation(t).related},t.prototype.setRelationModels=function(t,e){this.requireRelation(t).related=e},t.prototype.isRelationLoaded=function(t){return this.requireRelation(t).loaded},t.prototype.hasAttribute=function(t){for(var e=t.split("."),n=tt(this._attributes,this.modelClass.fields);e.length>0;)if(void 0===(n=n[e.shift()]))return!1;return!0},t.prototype.setAttribute=function(t,e){e=this.castAttribute(e,this.modelClass.fields[t]),this._attributes[t]=e,delete this._dirtyAttributes[t],b.deepEquals(this._originalAttributes[t],e)||(this._dirtyAttributes[t]=e),this.hasAutomaticTimestamp("updatedAt")&&"updatedAt"!==t&&this.touch()},t.prototype.setAttributes=function(t){for(var e=0,n=Object.entries(t);e<n.length;e++){var r=n[e],i=r[0],o=r[1];this.setAttribute(i,o)}},t.prototype.getAttribute=function(t,e){void 0===e&&(e=!1);for(var n=t.split("."),r=this.getAttributes(e);n.length>0;)if(void 0===(r=r[n.shift()]))return r;return r},t.prototype.getAttributes=function(t){return void 0===t&&(t=!1),t?d(this._attributes):tt(this._attributes,this.modelClass.fields)},t.prototype.unsetAttribute=function(t){this._attributes.hasOwnProperty(t)&&(t in this.modelClass.fields?this._attributes[t]=void 0:delete this._attributes[t],void 0!==this._originalAttributes[t]&&(this._dirtyAttributes[t]=void 0),this.hasAutomaticTimestamp("updatedAt")&&this.touch())},t.prototype.isDirty=function(t){return t?t in this._dirtyAttributes:Object.values(this._dirtyAttributes).length>0},t.prototype.getPrimaryKey=function(){return this._attributes[this.modelClass.primaryKey]},t.prototype.getSerializedPrimaryKey=function(){var t=this.getPrimaryKey();return t?this.serializeKey(t):null},t.prototype.delete=function(){return K(this,void 0,void 0,(function(){var t;return q(this,(function(e){switch(e.label){case 0:return this._exists?[4,this.getCascadeModels()]:[2,this];case 1:return t=e.sent(),[4,this.deleteModelsFromEngine(t)];case 2:return e.sent(),t.forEach((function(t){return t.resetEngineData()})),[2,this]}}))}))},t.prototype.save=function(){return K(this,void 0,void 0,(function(){var t,e;return q(this,(function(n){switch(n.label){case 0:return Y(this._attributes,this.modelClass.fields),this.isDirty()?(t=this._exists,[4,this.syncDirty()]):[2,this];case 1:return e=n.sent(),this._wasRecentlyCreated=this._wasRecentlyCreated||!t,this._attributes[this.modelClass.primaryKey]=this.parseKey(e),this.cleanDirty(),[2,this]}}))}))},t.prototype.touch=function(){this.setAttribute("updatedAt",new Date)},t.prototype.setExists=function(t){this._exists=t},t.prototype.exists=function(){return this._exists},t.prototype.wasRecentlyCreated=function(){return this._wasRecentlyCreated},t.prototype.initialize=function(t,e){this._exists=e,this._wasRecentlyCreated=!1,this.initializeProxy(),this.initializeAttributes(t,e),this.initializeRelations()},t.prototype.initializeProxy=function(){this._proxy=new Proxy(this,{get:function(t,e,n){if("string"!=typeof e||e in t||-1!==t.modelClass.classFields.indexOf(e))return Reflect.get(t,e,n);var r="get"+v(e)+"Attribute";if("function"==typeof t[r])return t[r]();if(t.hasRelation(e))return t.isRelationLoaded(e)?t.getRelationModels(e):void 0;if(e.startsWith("related")){var i=m(e.substr(7));if(t.hasRelation(i))return t._relations[i]}return t.getAttribute(e)},set:function(t,e,n,r){return"string"!=typeof e||e in t||-1!==t.modelClass.classFields.indexOf(e)?Reflect.set(t,e,n,r):t.hasRelation(e)?(t.setRelationModels(e,n),!0):(t.setAttribute(e,n),!0)},deleteProperty:function(t,e){return"string"!=typeof e||e in t?Reflect.deleteProperty(t,e):t.hasRelation(e)?(t.unloadRelation(e),!0):e in t._attributes&&-1===t.modelClass.classFields.indexOf(e)?(t.unsetAttribute(e),!0):Reflect.deleteProperty(t,e)}})},t.prototype.initializeAttributes=function(t,e){this._attributes=b.deepClone(t),this._originalAttributes=e?b.deepClone(t):{},this._dirtyAttributes=e?{}:b.deepClone(t),e||(this.hasAutomaticTimestamp("createdAt")&&!("createdAt"in t)&&(this._attributes.createdAt=new Date,this._dirtyAttributes.createdAt=this._attributes.createdAt),this.hasAutomaticTimestamp("updatedAt")&&!("updatedAt"in t)&&(this._attributes.updatedAt=new Date,this._dirtyAttributes.updatedAt=this._attributes.updatedAt)),this._attributes=this.castAttributes(X(this._attributes,this.modelClass.fields),this.modelClass.fields)},t.prototype.initializeRelations=function(){var t=this;this._relations=this.modelClass.relations.reduce((function(e,n){var r=t._proxy[m(n)+"Relationship"]();return r.name=n,e[n]=r,e}),{})},t.prototype.createFromEngineDocument=function(t,e){return K(this,void 0,void 0,(function(){var n;return q(this,(function(r){switch(r.label){case 0:return[4,this.parseEngineDocumentAttributes(t,e)];case 1:return(n=r.sent())[this.modelClass.primaryKey]=t,[2,new this.modelClass(n,!0)]}}))}))},t.prototype.createManyFromEngineDocuments=function(t){return K(this,void 0,void 0,(function(){var e=this;return q(this,(function(n){return[2,Promise.all(Object.entries(t).map((function(t){var n=t[0],r=t[1];return e.createFromEngineDocument(e.parseKey(n),r)})))]}))}))},t.prototype.syncDirty=function(){return K(this,void 0,void 0,(function(){var t,e,n;return q(this,(function(r){switch(r.label){case 0:return t=l.requireEngine(),this._exists?(e=this.getDirtyEngineDocumentUpdates(),n=this.getSerializedPrimaryKey(),[4,t.update(this.modelClass.collection,n,e)]):[2,t.create(this.modelClass.collection,this.toEngineDocument(),this.getSerializedPrimaryKey()||void 0)];case 1:return r.sent(),[2,n]}}))}))},t.prototype.cleanDirty=function(){this._originalAttributes=b.deepClone(this._attributes),this._dirtyAttributes={},this._exists=!0},t.prototype.getCascadeModels=function(){return K(this,void 0,void 0,(function(){var t,e,n,r=this;return q(this,(function(i){switch(i.label){case 0:return t=this.modelClass.relations.map((function(t){return r._relations[t]})).filter((function(t){return"cascade"===t.deleteStrategy})).map((function(t){return K(r,void 0,void 0,(function(){return q(this,(function(e){switch(e.label){case 0:return[4,t.getModels()];case 1:return[2,e.sent().map((function(t){return t.getCascadeModels()}))]}}))}))})),[4,Promise.all(t)];case 1:return e=i.sent(),[4,Promise.all(g.flatten(e))];case 2:return n=i.sent(),[2,g.flatten(n).concat([this]).filter((function(t){return t.exists()}))]}}))}))},t.prototype.deleteModelsFromEngine=function(t){return K(this,void 0,void 0,(function(){var e,n;return q(this,(function(r){switch(r.label){case 0:return e=l.requireEngine(),n=t.map((function(t){return[t.modelClass.collection,t.getSerializedPrimaryKey()]})),[4,Promise.all(n.map((function(t){var n=t[0],r=t[1];return e.delete(n,r)})))];case 1:return r.sent(),[2]}}))}))},t.prototype.resetEngineData=function(){delete this._attributes[this.modelClass.primaryKey],this._exists=!1,this._dirtyAttributes=b.deepClone(this._attributes)},t.prototype.hasOne=function(t,e,n){return new G(this,t,e,n)},t.prototype.belongsToOne=function(t,e,n){return new L(this,t,e,n)},t.prototype.hasMany=function(t,e,n){return new V(this,t,e,n)},t.prototype.belongsToMany=function(t,e,n){return new D(this,t,e,n)},t.prototype.castAttributes=function(t,e){var n={};for(var r in t)n[r]=this.castAttribute(t[r],e[r]);return n},t.prototype.castAttribute=function(t,e){var n=this;if(Z(t))return t;if(void 0===e)switch(typeof t){case"object":return t.toString();case"symbol":case"function":case"undefined":return;default:return t}switch(e.type){case w.Date:return new Date(t);case w.Object:return this.castAttributes(t,e.fields);case w.Array:return t.map((function(t){return n.castAttribute(t,e.items)}));case w.Boolean:return!!t;case w.Number:return parseFloat(t);case w.String:return t.toString();default:return t}},t.prototype.hasAutomaticTimestamp=function(t){return-1!==this.modelClass.timestamps.indexOf(t)},t.prototype.toEngineDocument=function(){return tt(this._attributes,this.modelClass.fields)},t.prototype.getDirtyEngineDocumentUpdates=function(){var t=b.deepClone(this._dirtyAttributes);for(var e in t)void 0===t[e]&&(t[e]={$unset:!0});return t},t.prototype.parseEngineDocumentAttributes=function(t,e){return K(this,void 0,void 0,(function(){return q(this,(function(t){return[2,J({},e)]}))}))},t.prototype.serializeKey=function(t){return t.toString()},t.prototype.parseKey=function(t){return t},t.prototype.requireRelation=function(t){if(!(t in this._relations))throw new a("Attempting to use undefined "+t+" relation.");return this._relations[t]},t.primaryKey="id",t.classFields=[],t.relations=[],t}();function Q(t,e,n,r){void 0===r&&(r=!0);var i={};if(-1!==H.indexOf(n))i.type=n;else{if("object"!=typeof n)throw new f(t,"Invalid field definition "+e);i=n}if(void 0===i.type)i={fields:i,type:w.Object};else if(-1===H.indexOf(i.type))throw new f(t,"Invalid field definition "+e);switch(r&&(i.required=!!i.required),i.type){case w.Object:if(void 0===i.fields)throw new f(t,"Field definition of type object requires fields attribute "+e);for(var o in i.fields)i.fields.hasOwnProperty(o)&&(i.fields[o]=Q(t,o,i.fields[o]));break;case w.Array:if(void 0===i.items)throw new f(t,"Field definition of type array requires items attribute. Field: '"+e+"'");i.items=Q(t,"items",i.items,!1)}return i}function X(t,e){for(var n in e){var r=e[n];if(!(n in t))switch(r.type){case w.Object:t[n]={};break;case w.Array:t[n]=[];break;default:t[n]=void 0}r.type===w.Object&&(t[n]=X(t[n],r.fields))}return t}function Y(t,e){for(var n in e){var r=e[n];if(r.required&&(!(n in t)||Z(t[n])))throw new a("The "+n+" attribute is required.");n in t&&!Z(t[n])&&r.type===w.Object&&Y(t[n],r.fields)}}function Z(t){return null==t}function tt(t,e,n){for(var r in void 0===n&&(n=!1),t=d(t))if(void 0===t[r])delete t[r];else if(r in e&&e[r].type===w.Object){var i=tt(t[r],e[r].fields,!0);void 0===i?delete t[r]:t[r]=i}return n&&0===Object.keys(t).length?void 0:t}var et=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),nt=function(t){function e(e){var n=t.call(this,"Could not create document with id "+e+" because it is already in use.")||this;return n.id=e,n}return et(e,t),e}(a),rt=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),it=function(t){function e(e){var n=t.call(this,"Couldn't find document with id "+e+".")||this;return n.id=e,n}return rt(e,t),e}(a),ot={generate:function t(e){return e?(e^16*Math.random()>>e/4).toString(16):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,t)}},at=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},st=function(){function t(){var t=this;this.documentsIn=function(t,e,n){return g.contains(n,t)},this.attributeEq=function(t,e,n){return p(t[e],n)},this.attributeContains=function(e,n,r){Array.isArray(r)||(r=[r]);var i=e&&e[n];return!!Array.isArray(i)&&!r.find((function(e){return!i.find((function(n){return t.filterValue(n,e)}))}))},this.attributeOr=function(e,n,r){return!!r.find((function(r){return!!t.filterValue(e,(i={},i[n]=r,i));var i}))},this.attributeIn=function(t,e,n){return g.contains(n,t[e])},this.attributeUpdate=function(e,n,r){y(r)?t.isOperation(r,t.attributeUpdates)?t.runOperation(r,t.attributeUpdates,e,n):y(e[n])?t.updateAttributes(e[n],r):e[n]=r:e[n]=r},this.attributeUpdateItems=function(e,n,r){Array.isArray(r)||(r=[r]);for(var i=function(r,i,o){r&&r.$in&&(r.$in=r.$in.map((function(t){return t.toString()})));var a=t.requireArrayProperty("$updateItems",e,n),s=t.filterDocuments(a.reduce((function(t,e,n){return at({},t,((r={})[n]=y(e)?e:{},r));var r}),{}),r||{});i&&Object.keys(s).forEach((function(e){var n;t.updateAttributes(s,((n={})[e]=i,n)),a[e]=s[e]})),o&&(e[n]=g.withoutIndexes(a,Object.keys(s).map(parseInt)))},o=0,a=r;o<a.length;o++){var s=a[o];i(s.$where,s.$update,s.$unset)}},this.attributePush=function(e,n,r){t.requireArrayProperty("$push",e,n).push(r)},this.attributeUnset=function(t,e,n){if(!0!==n)for(var r=0,i=n=Array.isArray(n)?n:[n];r<i.length;r++){var o=i[r];delete t[e][o]}else delete t[e]},this.attributeApply=function(e,n,r){for(var i=0,o=r;i<o.length;i++){var a=o[i];t.runOperation(a,t.attributeUpdates,e,n)}},this.rootFilters={$in:this.documentsIn},this.attributeFilters={$eq:this.attributeEq,$contains:this.attributeContains,$or:this.attributeOr,$in:this.attributeIn},this.attributeUpdates={$update:this.attributeUpdate,$updateItems:this.attributeUpdateItems,$push:this.attributePush,$unset:this.attributeUnset,$apply:this.attributeApply}}return t.prototype.filterDocuments=function(t,e){var n=this;return void 0===e&&(e={}),Object.entries(t).reduce((function(t,r){var i=r[0],o=r[1];return n.filterDocument(i,o,e)&&(t[i]=o),t}),{})},t.prototype.updateAttributes=function(t,e){if(this.isOperation(e,{$unset:this.attributeUnset}))for(var n=e.$unset,r=0,i=Array.isArray(n)?n:[n];r<i.length;r++){var o=i[r];this.attributeUnset(t,o,!0)}else for(var a=0,s=Object.entries(e);a<s.length;a++){var u=s[a],l=u[0],c=u[1];this.attributeUpdate(t,l,c)}},t.prototype.obtainDocumentId=function(t){return t||ot.generate()},t.prototype.filterDocument=function(t,e,n){var r=this;void 0===n&&(n={}),n=at({},n);for(var i=0,o=Object.keys(n).filter((function(t){return t in r.rootFilters}));i<o.length;i++){var a=o[i];if(!this.rootFilters[a](t,e,n[a]))return!1;delete n[a]}return this.filterValue(e,n)},t.prototype.filterValue=function(t,e){var n=this;return void 0===e&&(e={}),y(e)?this.isOperation(e,this.attributeFilters)?this.runOperation(e,this.attributeFilters,{value:t},"value"):!!y(t)&&!Object.entries(e).find((function(e){var r=e[0],i=e[1];return!(n.isOperation(i,n.attributeFilters)?n.runOperation(i,n.attributeFilters,t,r):n.attributeEq(t,r,i))})):this.attributeEq({value:t},"value",e)},t.prototype.isOperation=function(t,e){if(!y(t))return!1;var n=Object.keys(t),r=n[0],i=n.slice(1);return!(!r||0!==i.length||!(r in e))},t.prototype.runOperation=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=Object.entries(t)[0],o=i[0],a=i[1];return e[o].apply(e,n.concat([a]))},t.prototype.requireArrayProperty=function(t,e,n){if(!e||!Array.isArray(e[n]))throw new Error(t+" operator can only be applied to array attributes");return e[n]},t}();let ut,lt;const ct=new WeakMap,ft=new WeakMap,ht=new WeakMap,dt=new WeakMap,pt=new WeakMap;let yt={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return ft.get(t);if("objectStoreNames"===e)return t.objectStoreNames||ht.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return vt(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function bt(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(lt||(lt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(mt(this),e),vt(ct.get(this))}:function(...e){return vt(t.apply(mt(this),e))}:function(e,...n){const r=t.call(mt(this),e,...n);return ht.set(r,e.sort?e.sort():[e]),vt(r)}}function gt(t){return"function"==typeof t?bt(t):(t instanceof IDBTransaction&&function(t){if(ft.has(t))return;const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{e(),r()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)}));ft.set(t,e)}(t),e=t,(ut||(ut=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((t=>e instanceof t))?new Proxy(t,yt):t);var e}function vt(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{e(vt(t.result)),r()},o=()=>{n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)}));return e.then((e=>{e instanceof IDBCursor&&ct.set(e,t)})).catch((()=>{})),pt.set(e,t),e}(t);if(dt.has(t))return dt.get(t);const e=gt(t);return e!==t&&(dt.set(t,e),pt.set(e,t)),e}const mt=t=>pt.get(t);function wt(t,e,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const a=indexedDB.open(t,e),s=vt(a);return r&&a.addEventListener("upgradeneeded",(t=>{r(vt(a.result),t.oldVersion,t.newVersion,vt(a.transaction))})),n&&a.addEventListener("blocked",(()=>n())),s.then((t=>{o&&t.addEventListener("close",(()=>o())),i&&t.addEventListener("versionchange",(()=>i()))})).catch((()=>{})),s}function _t(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",(()=>e())),vt(n).then((()=>{}))}const Et=["get","getKey","getAll","getAllKeys","count"],St=["put","add","delete","clear"],xt=new Map;function Ot(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(xt.get(e))return xt.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=St.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Et.includes(n))return;const o=async function(t,...e){const o=this.transaction(t,i?"readwrite":"readonly");let a=o.store;r&&(a=a.index(e.shift()));const s=a[n](...e);return i&&await o.done,s};return xt.set(e,o),o}yt=(t=>({...t,get:(e,n,r)=>Ot(e,n)||t.get(e,n,r),has:(e,n)=>!!Ot(e,n)||t.has(e,n)}))(yt);var Ct=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Rt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},It=function(){function t(t){void 0===t&&(t=null),this.database=t?"soukai-"+t:"soukai",this.helper=new st}return t.prototype.purgeDatabase=function(){return Ct(this,void 0,void 0,(function(){var t=this;return Rt(this,(function(e){switch(e.label){case 0:return this.closeConnections(),[4,Promise.all([_t(this.database+"-meta",{blocked:function(){return t.throwDatabaseBlockedError()}}),_t(this.database,{blocked:function(){return t.throwDatabaseBlockedError()}})])];case 1:return e.sent(),[2]}}))}))},t.prototype.closeConnections=function(){return Ct(this,void 0,void 0,(function(){return Rt(this,(function(t){return this._metadataConnection&&this._metadataConnection.close(),this._documentsConnection&&this._documentsConnection.close(),delete this._metadataConnection,delete this._documentsConnection,[2]}))}))},t.prototype.create=function(t,e,n){return Ct(this,void 0,void 0,(function(){return Rt(this,(function(r){switch(r.label){case 0:return n=this.helper.obtainDocumentId(n),[4,this.documentExists(t,n)];case 1:if(r.sent())throw new nt(n);return[4,this.createDocument(t,n,e)];case 2:return r.sent(),[2,n]}}))}))},t.prototype.readOne=function(t,e){return Ct(this,void 0,void 0,(function(){var n;return Rt(this,(function(r){switch(r.label){case 0:return[4,this.collectionExists(t)];case 1:if(!r.sent())throw new it(e);return[4,this.getDocument(t,e)];case 2:if(!(n=r.sent()))throw new it(e);return[2,n]}}))}))},t.prototype.readMany=function(t,e){return Ct(this,void 0,void 0,(function(){var n,r;return Rt(this,(function(i){switch(i.label){case 0:return n={},[4,this.getCollections()];case 1:return-1===(r=i.sent()).indexOf(t)?[2,n]:[4,this.withDocumentsTransaction(r,t,"readonly",(function(t){var e=function(t){if(t)return n[t.key]=t.value,t.continue().then(e)};return t.store.openCursor().then(e)}))];case 2:return i.sent(),[2,this.helper.filterDocuments(n,e)]}}))}))},t.prototype.update=function(t,e,n){return Ct(this,void 0,void 0,(function(){var r;return Rt(this,(function(i){switch(i.label){case 0:return[4,this.getDocument(t,e)];case 1:if(!(r=i.sent()))throw new it(e);return this.helper.updateAttributes(r,n),[4,this.updateDocument(t,e,r)];case 2:return i.sent(),[2]}}))}))},t.prototype.delete=function(t,e){return Ct(this,void 0,void 0,(function(){return Rt(this,(function(n){switch(n.label){case 0:return[4,this.documentExists(t,e)];case 1:if(!n.sent())throw new it(e);return[4,this.deleteDocument(t,e)];case 2:return n.sent(),[2]}}))}))},t.prototype.collectionExists=function(t){return Ct(this,void 0,void 0,(function(){return Rt(this,(function(e){switch(e.label){case 0:return[4,this.getCollections()];case 1:return[2,-1!==e.sent().indexOf(t)]}}))}))},t.prototype.documentExists=function(t,e){return Ct(this,void 0,void 0,(function(){return Rt(this,(function(n){switch(n.label){case 0:return[4,this.getDocument(t,e)];case 1:return[2,!!n.sent()]}}))}))},t.prototype.getDocument=function(t,e){return Ct(this,void 0,void 0,(function(){var n;return Rt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,this.getCollections()];case 1:return-1===(n=r.sent()).indexOf(t)?[2,null]:[4,this.withDocumentsTransaction(n,t,"readonly",(function(t){return t.store.get(e)}))];case 2:return[2,r.sent()||null];case 3:return r.sent(),[2,null];case 4:return[2]}}))}))},t.prototype.createDocument=function(t,e,n){return Ct(this,void 0,void 0,(function(){var r;return Rt(this,(function(i){switch(i.label){case 0:return[4,this.getCollections()];case 1:return-1!==(r=i.sent()).indexOf(t)?[3,3]:[4,this.createCollection(t)];case 2:i.sent(),r.push(t),i.label=3;case 3:return[2,this.withDocumentsTransaction(r,t,"readwrite",(function(t){return t.store.add(n,e),t.done}))]}}))}))},t.prototype.updateDocument=function(t,e,n){return Ct(this,void 0,void 0,(function(){var r;return Rt(this,(function(i){switch(i.label){case 0:return[4,this.getCollections()];case 1:return r=i.sent(),[2,this.withDocumentsTransaction(r,t,"readwrite",(function(t){return t.store.put(n,e),t.done}))]}}))}))},t.prototype.deleteDocument=function(t,e){return Ct(this,void 0,void 0,(function(){var n;return Rt(this,(function(r){switch(r.label){case 0:return[4,this.getCollections()];case 1:return n=r.sent(),[2,this.withDocumentsTransaction(n,t,"readwrite",(function(t){return t.store.delete(e),t.done}))]}}))}))},t.prototype.withMetadataTransaction=function(t,e){return Ct(this,void 0,void 0,(function(){var n,r,i=this;return Rt(this,(function(o){switch(o.label){case 0:return n=this,(r=this._metadataConnection)?[3,2]:[4,wt(this.database+"-meta",1,{upgrade:function(t){t.objectStoreNames.contains("collections")||t.createObjectStore("collections",{keyPath:"name"})},blocked:function(){return i.throwDatabaseBlockedError()}})];case 1:r=o.sent(),o.label=2;case 2:return n._metadataConnection=r,[2,this.retryingOnTransactionInactive((function(){var n=i._metadataConnection.transaction("collections",t);return e(n)}))]}}))}))},t.prototype.withDocumentsTransaction=function(t,e,n,r){return Ct(this,void 0,void 0,(function(){var i,o,a=this;return Rt(this,(function(s){switch(s.label){case 0:return i=this,(o=this._documentsConnection)?[3,2]:[4,wt(this.database,t.length,{upgrade:function(e){for(var n=0,r=t;n<r.length;n++){var i=r[n];e.objectStoreNames.contains(i)||e.createObjectStore(i)}},blocked:function(){return a.throwDatabaseBlockedError()}})];case 1:o=s.sent(),s.label=2;case 2:return i._documentsConnection=o,[2,this.retryingOnTransactionInactive((function(){var t=a._documentsConnection.transaction(e,n);return r(t)}))]}}))}))},t.prototype.retryingOnTransactionInactive=function(t){try{return t()}catch(e){if(!(e instanceof Error)||!e.name.toLowerCase().includes("inactive")&&!e.message.toLowerCase().includes("inactive"))throw e;return t()}},t.prototype.getCollections=function(){return Ct(this,void 0,void 0,(function(){return Rt(this,(function(t){return[2,this.withMetadataTransaction("readonly",(function(t){return t.store.getAllKeys()}))]}))}))},t.prototype.createCollection=function(t){return Ct(this,void 0,void 0,(function(){return Rt(this,(function(e){switch(e.label){case 0:return[4,this.withMetadataTransaction("readwrite",(function(e){return e.store.add({name:t}),e.done}))];case 1:return e.sent(),this._documentsConnection&&(this._documentsConnection.close(),delete this._documentsConnection),[2]}}))}))},t.prototype.throwDatabaseBlockedError=function(){throw new a("An attempt to open an IndexedDB connection has been blocked, remember to call IndexedDBEngine.closeConnections when necessary. Learn more at https://developer.mozilla.org/en-US/docs/Web/API/IDBOpenDBRequest/blocked_event")},t}(),Dt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Tt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},At=function(){function t(){this.db={},this.helper=new st}return Object.defineProperty(t.prototype,"database",{get:function(){return this.db},enumerable:!0,configurable:!0}),t.prototype.create=function(t,e,n){var r=this.collection(t);if((n=this.helper.obtainDocumentId(n))in r)throw new nt(n);return r[n]=e,Promise.resolve(n)},t.prototype.readOne=function(t,e){var n=this.collection(t);return e in n?Promise.resolve(n[e]):Promise.reject(new it(e))},t.prototype.readMany=function(t,e){return Dt(this,void 0,void 0,(function(){var n;return Tt(this,(function(r){return this.hasCollection(t)?(n=this.collection(t),[2,this.helper.filterDocuments(n,e)]):[2,{}]}))}))},t.prototype.update=function(t,e,n){var r=this.collection(t);if(e in r){var i=r[e];return this.helper.updateAttributes(i,n),Promise.resolve()}return Promise.reject(new it(e))},t.prototype.delete=function(t,e){var n=this.collection(t);return e in n?(delete n[e],Promise.resolve()):Promise.reject(new it(e))},t.prototype.hasCollection=function(t){return t in this.db},t.prototype.collection=function(t){return this.hasCollection(t)||(this.db[t]={}),this.db[t]},t}(),Nt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Pt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},jt=function(){function t(t){void 0===t&&(t=""),this.prefix=t,this.helper=new st}return t.prototype.clear=function(){for(var t=0,e=Object.keys(localStorage);t<e.length;t++){var n=e[t];n.startsWith(this.prefix)&&localStorage.removeItem(n)}},t.prototype.create=function(t,e,n){return Nt(this,void 0,void 0,(function(){var r;return Pt(this,(function(i){if(r=this.readItem(t,{}),(n=this.helper.obtainDocumentId(n))in r)throw new nt(n);return r[n]=this.serializeAttributes(e),this.writeItem(t,r),[2,n]}))}))},t.prototype.readOne=function(t,e){return Nt(this,void 0,void 0,(function(){var n;return Pt(this,(function(r){if(n=this.readItem(t,{}),!(e in n))throw new it(e);return[2,this.deserializeAttributes(n[e])]}))}))},t.prototype.readMany=function(t,e){return Nt(this,void 0,void 0,(function(){var n,r;return Pt(this,(function(i){for(r in n=this.readItem(t,{}))n[r]=this.deserializeAttributes(n[r]);return[2,this.helper.filterDocuments(n,e)]}))}))},t.prototype.update=function(t,e,n){return Nt(this,void 0,void 0,(function(){var r,i;return Pt(this,(function(o){if(r=this.readItem(t,{}),!(e in r))throw new it(e);return i=this.deserializeAttributes(r[e]),this.helper.updateAttributes(i,n),r[e]=this.serializeAttributes(i),this.writeItem(t,r),[2]}))}))},t.prototype.delete=function(t,e){return Nt(this,void 0,void 0,(function(){var n;return Pt(this,(function(r){if(n=this.readItem(t,{}),!(e in n))throw new it(e);return delete n[e],this.writeItem(t,n),[2]}))}))},t.prototype.readItem=function(t,e){void 0===e&&(e=null);var n=localStorage.getItem(this.prefix+t);return null!==n?JSON.parse(n):e},t.prototype.writeItem=function(t,e){localStorage.setItem(this.prefix+t,JSON.stringify(e))},t.prototype.serializeAttributes=function(t){for(var e in t){var n=t[e];t[e]=this.serializeAttributeValue(n)}return t},t.prototype.serializeAttributeValue=function(t){var e=this;return Array.isArray(t)?t.map((function(t){return e.serializeAttributeValue(t)})):t instanceof Date?{__dateTime:t.getTime()}:"object"==typeof t?this.serializeAttributes(t):t},t.prototype.deserializeAttributes=function(t){for(var e in t){var n=t[e];t[e]=this.deserializeAttributeValue(n)}return t},t.prototype.deserializeAttributeValue=function(t){var e=this;return Array.isArray(t)?t.map((function(t){return e.deserializeAttributeValue(t)})):"object"==typeof t&&"__dateTime"in t?new Date(t.__dateTime):t},t}(),Lt=function(){function t(t){this.engine=t}return t.prototype.create=function(t,e,n){return r.log("CREATE",t,e,n),this.engine.create(t,e,n).then((function(t){return r.log("CREATED",t),t})).catch((function(t){throw r.error(t),t}))},t.prototype.readOne=function(t,e){return r.log("READ ONE",t,e),this.engine.readOne(t,e).then((function(t){return r.log("FOUND",t),t})).catch((function(t){throw r.error(t),t}))},t.prototype.readMany=function(t,e){return r.log("READ ALL",t,e),this.engine.readMany(t,e).then((function(t){return r.log("FOUND",t),t})).catch((function(t){throw r.error(t),t}))},t.prototype.update=function(t,e,n){return r.log("UPDATE",t,e,n),this.engine.update(t,e,n).then((function(){return r.log("UPDATED")})).catch((function(t){throw r.error(t),t}))},t.prototype.delete=function(t,e){return r.log("DELETE",t,e),this.engine.delete(t,e).then((function(){return r.log("DELETED")})).catch((function(t){throw r.error(t),t}))},t}();function kt(t){for(var e={},n=0,r=t.keys();n<r.length;n++){var i=r[n],o=(i.match(/^(?:\.\/)?(.+)\.(j|t)s$/)||[])[1];void 0!==o&&(e[o]=t(i).default)}return e}n.d(e,"definitionsFromContext",(function(){return kt})),n.d(e,"Model",(function(){return z})),n.d(e,"Soukai",(function(){return l})),n.d(e,"EngineHelper",(function(){return st})),n.d(e,"LogEngine",(function(){return Lt})),n.d(e,"InMemoryEngine",(function(){return At})),n.d(e,"LocalStorageEngine",(function(){return jt})),n.d(e,"IndexedDBEngine",(function(){return It})),n.d(e,"SoukaiError",(function(){return a})),n.d(e,"DocumentNotFound",(function(){return it})),n.d(e,"DocumentAlreadyExists",(function(){return nt})),n.d(e,"InvalidModelDefinition",(function(){return f})),n.d(e,"BelongsToManyRelation",(function(){return D})),n.d(e,"BelongsToOneRelation",(function(){return L})),n.d(e,"HasManyRelation",(function(){return V})),n.d(e,"HasOneRelation",(function(){return G})),n.d(e,"MultiModelRelation",(function(){return O})),n.d(e,"Relation",(function(){return S})),n.d(e,"SingleModelRelation",(function(){return A})),n.d(e,"FieldType",(function(){return w})),e.default=l}])}))},6639:function(t,e,n){t.exports=o;var r=n(7041).EventEmitter,i=n(6110);function o(){r.call(this)}i(o,r),o.Readable=n(2345),o.Writable=n(1607),o.Duplex=n(1606),o.Transform=n(2784),o.PassThrough=n(3091),o.finished=n(6855),o.pipeline=n(3329),o.Stream=o,o.prototype.pipe=function(t,e){var n=this;function i(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),t.on("drain",o),t._isStdio||e&&!1===e.end||(n.on("end",s),n.on("close",u));var a=!1;function s(){a||(a=!0,t.end())}function u(){a||(a=!0,"function"===typeof t.destroy&&t.destroy())}function l(t){if(c(),0===r.listenerCount(this,"error"))throw t}function c(){n.removeListener("data",i),t.removeListener("drain",o),n.removeListener("end",s),n.removeListener("close",u),n.removeListener("error",l),t.removeListener("error",l),n.removeListener("end",c),n.removeListener("close",c),t.removeListener("close",c)}return n.on("error",l),t.on("error",l),n.on("end",c),n.on("close",c),t.on("close",c),t.emit("pipe",n),t}},2225:function(t,e,n){"use strict";n(1703);var r=n(837).Buffer,i=r.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){if(!t)return"utf8";var e;while(1)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function a(t){var e=o(t);if("string"!==typeof e&&(r.isEncoding===i||!i(t)))throw new Error("Unknown encoding: "+t);return e||t}function s(t){var e;switch(this.encoding=a(t),this.encoding){case"utf16le":this.text=p,this.end=y,e=4;break;case"utf8":this.fillLast=f,e=4;break;case"base64":this.text=b,this.end=g,e=3;break;default:return this.write=v,void(this.end=m)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function u(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function l(t,e,n){var r=e.length-1;if(r<n)return 0;var i=u(e[r]);return i>=0?(i>0&&(t.lastNeed=i-1),i):--r<n||-2===i?0:(i=u(e[r]),i>=0?(i>0&&(t.lastNeed=i-2),i):--r<n||-2===i?0:(i=u(e[r]),i>=0?(i>0&&(2===i?i=0:t.lastNeed=i-3),i):0))}function c(t,e,n){if(128!==(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!==(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!==(192&e[2]))return t.lastNeed=2,"�"}}function f(t){var e=this.lastTotal-this.lastNeed,n=c(this,t,e);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function h(t,e){var n=l(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)}function d(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e}function p(t,e){if((t.length-e)%2===0){var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function y(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function b(t,e){var n=(t.length-e)%3;return 0===n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function g(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function v(t){return t.toString(this.encoding)}function m(t){return t&&t.length?this.write(t):""}e.s=s,s.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(e=this.fillLast(t),void 0===e)return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},s.prototype.end=d,s.prototype.text=h,s.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},837:function(t,e,n){n(1703);
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var r=n(9914),i=r.Buffer;function o(t,e){for(var n in t)e[n]=t[n]}function a(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(o(r,e),e.Buffer=a),a.prototype=Object.create(i.prototype),o(i,a),a.from=function(t,e,n){if("number"===typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},a.alloc=function(t,e,n){if("number"!==typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"===typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},a.allocUnsafe=function(t){if("number"!==typeof t)throw new TypeError("Argument must be a number");return i(t)},a.allocUnsafeSlow=function(t){if("number"!==typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},4728:function(t,e,n){var r=n(476);function i(t,e){if(o("noDeprecation"))return t;var n=!1;function i(){if(!n){if(o("throwDeprecation"))throw new Error(e);o("traceDeprecation")?r.trace(e):r.warn(e),n=!0}return t.apply(this,arguments)}return i}function o(t){try{if(!n.g.localStorage)return!1}catch(r){return!1}var e=n.g.localStorage[t];return null!=e&&"true"===String(e).toLowerCase()}n(1703),t.exports=i},2361:function(){},4616:function(){}}]);
//# sourceMappingURL=444.18425049.js.map